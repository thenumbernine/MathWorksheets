<!doctype html>
<html>
	<head>
        <meta charset='utf-8'>
		<title>magnetic field generated from boosting charge</title>
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
		<script type='text/javascript' src='PeriodicTable.js'></script>
<script>

var templateContext = {};
var templateSpans = [];

function refreshTemplate(dontUpdateInputs) {
	for (var i = 0; i < templateSpans.length; ++i) {
		var span = templateSpans[i];
console.log('evaluating '+span.expr);		
		var result;
		with (templateContext) {
			result = eval(span.expr);
		}
		if (typeof(result) == 'number') {
			result = result.toExponential();
		}
		span.span.innerText = result;
	}

	if (!dontUpdateInputs) {
		var inputs = document.getElementsByTagName('input');
		for (var i = 0; i < inputs.length; ++i) {
			var input = inputs[i];
			input.value = templateContext[input.name];
		}
	}
}

function setMaterial(element) {
	templateContext.atomic_mass_in_g = element.atomic_mass;
	templateContext.material_nominal_valency = 1;
	templateContext.material_density_in_g_per_cm3 = element.density;
	templateContext.material_electrical_resistivity_in_ohm_m = element.resistivity;
	refreshTemplate();
}

function init() {

	var r = /{{(.*?)}}/g;
	var html = document.body.innerHTML;
	var templateIndex = 0;
	var match;
	while ((match = r.exec(html)) != null) {
		var templateID = 'template_' + templateIndex;
		html = html.substr(0, match.index) 
			+ '<span id="' + templateID + '">' + templateID + '</span>'
			+ html.substr(match.index + match[0].length);
		++templateIndex;
		templateSpans.push({
			id : templateID,
			expr : match[1],
		});
	}
	document.body.innerHTML = html;

	//is the DOM built yet?
	for (var i = 0; i < templateSpans.length; ++i) {
		var templateSpan = templateSpans[i];
		templateSpan.span = document.getElementById(templateSpan.id);
	}

	//now collect all inputs
	var inputs = document.getElementsByTagName('input');
	for (var i = 0; i < inputs.length; ++i) {
		(function(){
			var input = inputs[i];	
			templateContext[input.name] = input.value;
			input.onkeyup = function() {
				templateContext[input.name] = input.value;
				refreshTemplate(true);	//refresh everything related to it
			};
		})();
	}

	//now refresh it all
	refreshTemplate(true);

	var defaultMaterial;
	var defaultIndex = 0;
	var select = document.getElementById('materials');
	for (var i = 0; i < PeriodicTable.length; ++i) {
		var element = PeriodicTable[i];
		if (element.resistivity === undefined) continue;
		
		var option = document.createElement('option');
		option.appendChild(document.createTextNode(element.name));
		option.element = element;
		if (element.name == 'Copper') {
			defaultMaterial = element;
			defaultIndex = select.options.length;
		}
		select.appendChild(option);
	}
	select.selectedIndex = defaultIndex;
	
	//setMaterial(defaultMaterial);

	tryToFindMathJax();

	//templating init
	//- run regex on document.body.innerHTML with 'with' of the context object
	//- any inputs, implicitly create variables within the context object
}
function selchange() {
	var select = document.getElementById('materials');
	var option = select.options[select.selectedIndex];
	if (option) setMaterial(option.element);
}
</script>
	</head>
    <body onload='init();'>

constants:<br>
$c = $<input name='speed_of_light_in_m_per_s' value='299792458'/> $\cdot \frac{m}{s} =$ the speed of light.<br>
$k_e = $<input name='Coulomb_constant' value='8.9875517873682e+9'/> $\cdot \frac{N \cdot m^2}{C^2}$ = Coulomb's constant (typically $\frac{1}{4 \pi \epsilon_0}$).<br>
$N_A = $<input name='Avogadro_constant' value='6.02214085774e+23'/> $\cdot \frac{1}{mol}$ = Avogadro's constant.<br>
$e =$ <input name='electron_charge' value='1.602176620898e-19'/> $\cdot C$ = electron charge<br>
<br>

material variables: <select onchange='selchange()' id='materials'><option name=''></option></select><br>
<input name='atomic_mass_in_g' value='63.54'/> $g =$ atomic mass.<br>
nominal valency: 1 atom = <input name='material_nominal_valency' value='1'/> electrons<br>
$\rho =$ <input name='material_density_in_g_per_cm3' value='8.95'/> $\frac{g}{cm^3}$ = density<br> 
$\rho_{res} = $ <input name='material_electrical_resistivity_in_ohm_m' value='1.6e-8'/> $\Omega \cdot m$ = electrical resistivity<br>
<br>

wire properties:<br>
$l =$ <input name='wire_length_in_m' value='1000'/> $m$ = wire distance<br>
$R =$ <input name='wire_radius_in_mm' value='1.3'/> $mm$ = wire radius<br>
<br>

power source:<br>
$V =$ <input name='voltage_in_V' value='6'/> V = voltage<br>
<br>

reading of magnetic field:<br>
$r =$ <input name='field_measure_distance_in_m' value='.01'/> m = distance of measurement<br>
<br>

(atomic mass) {{atomic_mass_in_kg = 1e-3 * atomic_mass_in_g}} kg = (Avogadro's constant) {{Avogadro_constant}} atoms = (Avogadro's constant * nominal valency) {{Avogadro_constant * material_nominal_valency}} electrons.<br>
Free electrons per kg = Avogadro's constant * nominal valency / atomic weight = {{free_electrons_per_kg = Avogadro_constant * material_nominal_valency / atomic_mass_in_kg}} $\frac{e}{kg}$<br>
$\rho =$ {{material_density_in_g_per_cm3}} $\frac{g}{cm^3}$ = {{material_density_in_kg_per_m3 = material_density_in_g_per_cm3 * 1e+3}} $\frac{kg}{m^3} = $ = matter density.<br>
$\rho_{charge} =$ free electrons per kg * matter density = {{electron_density_in_e_per_m3 = free_electrons_per_kg * material_density_in_kg_per_m3}} $\frac{e}{m^3}$ = electron density.<br> 
$q = \rho_{charge} \cdot e =$ {{charge_density_in_C_per_m3 = electron_density_in_e_per_m3 * electron_charge}} $\frac{C}{m^3} = $ charge density.<br>
<br>

more wire properties:<br>
$R =$ {{wire_radius_in_m = wire_radius_in_mm * 1e-3}} m = wire radius<br>
$A = \pi R^2 =$ {{wire_cross_section_area_in_m2 = Math.PI * wire_radius_in_m * wire_radius_in_m}} $m^2 =$ wire cross-section area<br>
$R_{res} = \frac{\rho_{res} \cdot l}{A} =$ {{wire_resistivity_in_ohms = material_electrical_resistivity_in_ohm_m * wire_length_in_m / wire_cross_section_area_in_m2}} $\Omega$<br>
$I = \frac{V}{R_{res}} = \frac{V \cdot \pi \cdot R^2}{\rho_{res} \cdot l} =$ {{current_in_A = voltage_in_V / wire_resistivity_in_ohms}} A = current.<br>
<br>

Electric field: $E(x) = \int \frac{q(x')}{|x' - x|^2} \cdot \frac{(x' - x)}{|x' - x|} dx'$<br>
Electric field around our wire:<br>
$\lambda = A q = \pi R^2 \rho_{charge} e =$ {{charge_per_unit_length_in_C_per_m = charge_density_in_C_per_m3 * wire_cross_section_area_in_m2}} $\frac{C}{m}$ = charge density per unit meter along wire<br>
$E(r) = \frac{1}{2} \lambda k_e \frac{1}{r} = \frac{1}{2} \pi R^2 \rho_{charge} e k_e \frac{1}{r} =$ {{electric_field_in_N_m_per_C_r = charge_per_unit_length_in_C_per_m * .5 * Coulomb_constant}} $\cdot \frac{1}{r} \cdot \frac{N \cdot m}{C}$<br>
<br>

Mean velocity of moving electrons within wire:<br>
$v = \frac{I}{\lambda} = \frac{V}{\rho_{charge} e \cdot \rho_{res} \cdot l} =$ {{mean_electron_velocity_in_m_per_s = current_in_A / (wire_cross_section_area_in_m2 * charge_density_in_C_per_m3)}} $\frac{m}{s}$<br>
<br>

Faraday tensor:<br>
$F_{ab} = \downarrow a \overset{\rightarrow b}{\left[ \begin{matrix}
	0 & -\frac{1}{c} E_x & -\frac{1}{c} E_y & -\frac{1}{c} E_z \\
	\frac{1}{c} E_x & 0 & B_z & -B_y \\
	\frac{1}{c} E_y & -B_z & 0 & B_x \\
	\frac{1}{c} E_z & B_y & B_x & 0
\end{matrix}\right]}$<br>
<br>
$E_i$ has units $\frac{N}{C} = \frac{kg \cdot m}{C \cdot s^2}$.<br>
$B_i$ has units $\frac{N \cdot s}{C \cdot m} = \frac{kg}{C \cdot s}$<br>
$F_{ab}$ has units of $\frac{kg}{C \cdot s}$<br>
<br>

Lorentz boost in the x direction:<br>
${\Lambda^a}_b = 
\downarrow a \overset{\rightarrow b}{\left[ \begin{matrix}
	\gamma & -\beta \gamma & 0 & 0 \\
	-\beta \gamma & \gamma & 0 & 0 \\
	0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 1 \\
\end{matrix}\right]}
$<br>
<br>

For electron flow through our material:<br>
$\beta = \frac{v}{c} =$ {{Lorentz_beta = mean_electron_velocity_in_m_per_s / speed_of_light_in_m_per_s}}<br>
$\gamma = 1 / \sqrt{1 - \beta^2} \approx$ {{Lorentz_gamma = 1 / (1 - Math.pow(Lorentz_beta, .5))}}<br>
<br>


For a boosted electromagnetic field:<br>
$F'_{ab} = {\Lambda^c}_a F_{cd} {\Lambda^d}_b$<br>

$= \downarrow a \overset{\rightarrow c}{\left[ \begin{matrix}
	\gamma & -\beta \gamma & 0 & 0 \\
	-\beta \gamma & \gamma & 0 & 0 \\
	0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 1 \\
\end{matrix}\right]}
\cdot
\downarrow c \overset{\rightarrow d}{\left[ \begin{matrix}
	0 & -\frac{1}{c} E_x & -\frac{1}{c} E_y & -\frac{1}{c} E_z \\
	\frac{1}{c} E_x & 0 & B_z & -B_y \\
	\frac{1}{c} E_y & -B_z & 0 & B_x \\
	\frac{1}{c} E_z & B_y & B_x & 0
\end{matrix}\right]}
\downarrow d \overset{\rightarrow b}{\left[ \begin{matrix}
	\gamma & -\beta \gamma & 0 & 0 \\
	-\beta \gamma & \gamma & 0 & 0 \\
	0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 1 \\
\end{matrix}\right]}$<br>

$= \downarrow a \overset{\rightarrow c}{\left[ \begin{matrix}
	\gamma & -\beta \gamma & 0 & 0 \\
	-\beta \gamma & \gamma & 0 & 0 \\
	0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 1 \\
\end{matrix}\right]}
\cdot
\downarrow c \overset{\rightarrow b}{\left[ \begin{matrix}
	\beta \gamma \frac{1}{c} E_x & -\gamma \frac{1}{c} E_x & -\frac{1}{c} E_y & -\frac{1}{c} E_z \\
	\gamma \frac{1}{c} E_x & -\beta \gamma \frac{1}{c} E_x & B_z & -B_y \\
	\gamma \frac{1}{c} E_y + \beta \gamma B_z & -\beta \gamma \frac{1}{c} E_y - \gamma B_z & 0 & B_x \\
	\gamma \frac{1}{c} E_z - \beta \gamma B_y & -\beta \gamma \frac{1}{c} E_z + \gamma B_y & B_x & 0
\end{matrix}\right]}$<br>
<br>

$= \downarrow a \overset{\rightarrow b}{\left[ \begin{matrix}
	0 &
	-\frac{1}{c} E_x &
	\gamma (-\frac{1}{c} E_y - \beta B_z) &
	\gamma (-\frac{1}{c} E_z + \beta B_y) \\
	
	\frac{1}{c} E_x &
	0 &
	\gamma (\beta \frac{1}{c} E_y + B_z) &
	\gamma (\beta \frac{1}{c} E_z - B_y) \\

	\gamma (\frac{1}{c} E_y + \beta B_z) & \gamma (-\beta \frac{1}{c} E_y - B_z) & 0 & B_x \\
	
	\gamma (\frac{1}{c} E_z - \beta B_y) & \gamma (-\beta \frac{1}{c} E_z + B_y) & B_x & 0
\end{matrix}\right]}$<br>
<br>

For a resting electromagnetic field of magnitude $E$.<br>
$F_{ab} = \downarrow a \overset{\rightarrow b}{\left[ \begin{matrix}
	0 & -\frac{1}{c} E \frac{x}{r} & -\frac{1}{c} E \frac{y}{r} & -\frac{1}{c} E \frac{z}{r} \\
	\frac{1}{c} E \frac{x}{r} & 0 & 0 & 0 \\
	\frac{1}{c} E \frac{y}{r} & 0 & 0 & 0 \\
	\frac{1}{c} E \frac{z}{r} & 0 & 0 & 0
\end{matrix}\right]}$<br>
<br>

$F'_{ab} = \downarrow a \overset{\rightarrow b}{\left[ \begin{matrix}
	0 &
	-\frac{1}{c} E \frac{x}{r} &
	-\gamma \frac{1}{c} E \frac{y}{r} &
	-\gamma \frac{1}{c} E \frac{z}{r} \\
	
	\frac{1}{c} E \frac{x}{r} &
	0 &
	\beta \gamma \frac{1}{c} E \frac{y}{r} &
	\beta \gamma \frac{1}{c} E \frac{z}{r} \\

	\gamma \frac{1}{c} E \frac{y}{r} & -\beta \gamma \frac{1}{c} E \frac{y}{r} & 0 & 0 \\
	                          
	\gamma \frac{1}{c} E \frac{z}{r} & -\beta \gamma \frac{1}{c} E \frac{z}{r} & 0 & 0
\end{matrix}\right]}$<br>
<br>
<br>
So the electric field in the direction perpendicular to the boost is scaled down by $\gamma$.<br>
And a magnetic field is created equal to:<br>
$\vec{B} = 
	\beta \gamma \frac{1}{c} E \cdot
\left[\begin{matrix}
	0 \\
	-\frac{z}{r} \\
	\frac{y}{r}
\end{matrix}\right]$<br>
$B = \frac{1}{c} \beta \gamma E = \frac{\gamma \cdot V \cdot \pi \cdot R^2 \cdot k_e}{2 \cdot c^2 \cdot \rho_{res} \cdot l \cdot r}$ = electric field magnitude<br>
<br>

$B = \frac{1}{c \cdot r} \cdot $ {{Lorentz_beta * Lorentz_gamma * electric_field_in_N_m_per_C_r}} $\cdot \frac{N}{C \cdot m}$
$= \frac{1}{r} \cdot $ {{magnetic_field_in_N_s_per_C_r = Lorentz_beta * Lorentz_gamma * (electric_field_in_N_m_per_C_r / speed_of_light_in_m_per_s)}} $\cdot \frac{N \cdot s}{C}$<br>
<br>

At {{field_measure_distance_in_m}} $ m$ this gives us a magnetic field of:<br>
$B =$ {{magnetic_field_in_N_s_per_C_r / field_measure_distance_in_m}}
$\frac{N \cdot s}{C \cdot m} =$
{{magnetic_field_in_N_s_per_C_r / field_measure_distance_in_m}} T<br>
<br>

	</body>
</html>
