<!doctype html>
<html>
	<head>
        <meta charset='utf-8'>
		<title>Shallow Water in Hyperbolic Form</title>
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
	</head>
    <body>

Conservation Law:<br>

$U = \left[ \begin{matrix}
	h \\
	h v^i
\end{matrix} \right]$<br>
<br>

$W = \left[ \begin{matrix}
	h \\
	v^i
\end{matrix} \right]$<br>
<br>

$\frac{\partial U^I}{\partial W^J} = \downarrow I \overset{\rightarrow J}{
	\left[ \begin{matrix}
		1 & 0 \\
		v^i & h \delta^i_j
	\end{matrix} \right]
}$<br>
<br>

$\frac{\partial W^I}{\partial U^J} = \downarrow I \overset{\rightarrow J}{
	\left[ \begin{matrix}
		1 & 0 \\
		-\frac{1}{h} v^i & \frac{1}{h} \delta^i_j
	\end{matrix} \right]
}$<br>
<br>

Let $h > 0$ to maintain that $\frac{\partial W^I}{\partial U^J}$ is non-singular.<br>
<br>

$F^I(n) = \left[ \begin{matrix}
	h v^k n_k \\
	h v^i v^k n_k + \frac{1}{2} g h^2 n^i
\end{matrix} \right]$<br>
<br>

$\frac{\partial F^I}{\partial W^J} = \downarrow I \overset{\rightarrow J}{
	\left[ \begin{matrix}
		v_n & 
		h n_j \\
		
		v^i v_n + g h n^i &
		h (\delta^i_j v_n + v^i n_j)
	\end{matrix} \right]
}$<br>
<br>
...for $v_n = v^k n_k$<br>
<br>

$\frac{\partial F}{\partial U} = \frac{\partial F}{\partial W} \frac{\partial W}{\partial U}$<br>
<br>

$= \left[ \begin{matrix}
	v_n & 
	h n_x &
	h n_y \\
	
	v^x v_n + g h n^x &
	h (v_n + v^x n_x) &
	h v^x n_y \\

	v^y v_n + g h n^y &
	h v^y n_x &
	h (v_n + v^y n_y) \\
\end{matrix} \right]
\left[ \begin{matrix}
	1 & 0 & 0 \\
	-\frac{1}{h} v^x & \frac{1}{h} & 0 \\ 
	-\frac{1}{h} v^y & 0 & \frac{1}{h}
\end{matrix} \right]$<br>
<br>

$= \left[ \begin{matrix}
	0 &
	n_x &
	n_y \\

	g h n^x - v^x v_n &
	v_n + v^x n_x &
	v^x n_y \\

	g h n^y - v^y v_n &
	v^y n_x &
	v_n + v^y n_y
\end{matrix} \right]$<br>
<br>

$= \left[ \begin{matrix}
	0 & n_j \\
	g h n^i - v_n v^i & v^i n_j + v_n \delta^i_j
\end{matrix} \right]$<br>
<br>

Create the acoustic plus wavespeed matrix:<br>
<br>

$\frac{\partial W^I}{\partial U_K} \frac{\partial F^K}{\partial W_J} = \downarrow I \overset{\rightarrow K}{
	\left[ \begin{matrix}
		1 & 0 \\
		-\frac{1}{h} v^i & \frac{1}{h} \delta^i_k
	\end{matrix} \right]
} \cdot \downarrow K \overset{\rightarrow J}{
	\left[ \begin{matrix}
		v_n & 
		h n_j \\
		
		v^k v_n + g h n^k &
		h (\delta^k_j v_n + v^k n_j)
	\end{matrix} \right]
}$<br>
<br>

$\frac{\partial W^I}{\partial U_K} \frac{\partial F^K}{\partial W_J} = \downarrow I \overset{\rightarrow J}{
	\left[ \begin{matrix}
		v_n &
		h n_j \\

		g n^i &
		\delta^i_j v_n
	\end{matrix} \right]
}$<br>
<br>

Separate out the acoustic matrix:<br>
<br>

${A^I}_J = \frac{\partial W^I}{\partial U^K} \frac{\partial F^K}{\partial W^J} - \delta^I_J v_n$<br>
<br>

${A^I}_J = \downarrow I \overset{\rightarrow J}{
	\left[ \begin{matrix}
		0 &
		h n_j \\

		g n^i &
		0
	\end{matrix} \right]
}$<br>
<br>



Solve for the eigenvalues of ${A^I}_J$:<br>
<br>
${A^I}_J (R_A)^J = \lambda (R_A)^J$<br>
<br>
$({A^I}_J - \lambda \delta^I_J) (R_A)^J = 0$<br>
<br>               
$|{A^I}_J - \lambda \delta^I_J| = 0$<br>
<br>

$\left| \begin{matrix}
	-\lambda & 
	h n_j \\
	
	g n^i &
	-\lambda \delta^i_j
\end{matrix} \right| = 0$<br>
<br>

Expand components for 2D:<br>
<br>

$\left| \begin{matrix}
	-\lambda & 
	h n_x &
	h n_y \\
	
	g n^x &
	-\lambda &
	0 \\

	g n^y &
	0 &
	-\lambda
\end{matrix} \right| = 0$<br>
<br>

$-\lambda \left| \begin{matrix}
	-\lambda & h n_x \\
	g n^x & -\lambda
\end{matrix} \right|
+ g n^y \left| \begin{matrix}
	h n_x & h n_y \\
	-\lambda & 0
\end{matrix} \right|
= 0$<br>
<br>

$-\lambda (
	\lambda^2 
	- g h n_x n^x 
)
+ \lambda g h n^y n_y
= 0$<br>
<br>

$-\lambda (\lambda^2 - g h (n_x n^x + n^y n_y)) = 0$<br>
<br>

Let $|n|^2 = n_k n^k = n_x n^x + n_y n^y$<br>
<br>

$-\lambda (\lambda^2 - g h |n|^2) = 0$<br>
<br>

$-\lambda (\lambda - |n| \sqrt{gh}) (\lambda + |n| \sqrt{gh}) = 0$<br>
<br>

This has solutions: $\lambda = \{ 0, \pm |n| \sqrt{gh} \}$<br>
<br>

Let $c = \sqrt{gh}$ be the wavespeed (difference from the center wave $v_n$).<br>
<br>

Then we find: $\lambda = \{ 0, \pm |n| c \}$<br>
<br>

Solve for the right-eigenvectors:<br>
<br>

<br>
Case $\lambda = 0$:<br>
<br>

$\left[ \begin{matrix}
	0 &
	h n_x &
	h n_y \\
	
	g n^x &
	0 &
	0 \\

	g n^y &
	0 &
	0
\end{matrix} \right] 
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

Rescale first row by $\frac{1}{h}$.<br>
Rescale second and third row by $\frac{1}{g}$<br>
<br>

$\left[ \begin{matrix}
	0 &
	n_x &
	n_y \\
	
	n^x &
	0 &
	0 \\

	n^y &
	0 &
	0
\end{matrix} \right] 
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

For $n^x \ne 0$:<br>
<br>

Subtract $\frac{n^y}{n^x}$ by the second row to the first row to cancel it.<br>
Also swap rows to give us a leading diagonal:<br>
<br>

$\left[ \begin{matrix}
	n^x &
	0 &
	0 \\

	0 &
	n_x &
	n_y \\
	
	0 &
	0 &
	0
\end{matrix} \right]
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

$X^h = 0$<br>
<br>

For $n^x \ne 0, n_x \ne 0$:<br>
<br>

Let $u = X^{v^y}$<br>
<br>

$n_x X^{v^x} + u n_y = 0$<br>
<br>

$X^{v^x} = -u \frac{n_y}{n_x}$<br>
<br>
	
Therefore our right-eigenvector is:<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= u \left[ \begin{matrix}
	0 \\
	-\frac{n_y}{n_x} \\
	1
\end{matrix} \right]$<br>
<br>

Rescale by $n_x$:<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= u \left[ \begin{matrix}
	0 \\
	-n_y \\
	n_x
\end{matrix} \right]$<br>
<br>

For $n^x \ne 0, n_x = 0$:<br>
By $|n|^2 = n^x n_x + n^y n_y > 0$ we know that $n_y \ne 0$.<br>
(When does $n^x \ne 0$ but $n_x = \Sigma_k g_{xk} n^k = 0$? Whenever $g_{xx} n^x = -g_{xy} n^y$.)<br>
<br>

$\left[ \begin{matrix}
	n^x &
	0 &
	0 \\

	0 &
	0 &
	n_y \\
	
	0 &
	0 &
	0
\end{matrix} \right]
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

Let $u = -X^{v^x}$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= u \left[ \begin{matrix}
	0 \\
	-1 \\
	0
\end{matrix} \right]$<br>
<br>

For $n^x = 0$:<br>
<br>

$\left[ \begin{matrix}
	0 &
	n_x &
	n_y \\
	
	0 &
	0 &
	0 \\

	n^y &
	0 &
	0
\end{matrix} \right] 
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

Swap rows to get leading diagonal:<br>
<br>

$\left[ \begin{matrix}
	n^y &
	0 &
	0 \\

	0 &
	n_x &
	n_y \\
	
	0 &
	0 &
	0
\end{matrix} \right] 
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

For $n^x = 0, n_x \ne 0$:<br>
<br>

$\left[ \begin{matrix}
	n^y &
	0 &
	0 \\

	0 &
	n_x &
	n_y \\
	
	0 &
	0 &
	0
\end{matrix} \right] 
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

Let $u = X^{v^y}$<br>
<br>

$n_x X^{v^x} + n_y X^{v^y} = 0$<br>
$n_x X^{v^x} + n_y u = 0$<br>
$X^{v^x} = -\frac{n_y}{n_x} u$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= u \left[ \begin{matrix}
	0 \\
	-\frac{n_y}{n_x} \\
	1
\end{matrix} \right]$<br>
<br>

Rescale by $u \rightarrow n_x u$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= u \left[ \begin{matrix}
	0 \\
	-n_y \\
	n_x
\end{matrix} \right]$<br>
<br>

For $n^x = 0, n_x = 0$:<br>
By $|n|^2 > 0$ we know that $n^y n_y \ne 0$<br>
<br>

$\left[ \begin{matrix}
	0 &
	0 &
	n_y \\
	
	0 &
	0 &
	0 \\

	n^y &
	0 &
	0
\end{matrix} \right] 
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

Swap for leading row.<br>
<br>

$\left[ \begin{matrix}
	n^y &
	0 &
	0 \\

	0 &
	0 &
	n_y \\
	
	0 &
	0 &
	0
\end{matrix} \right] 
\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= 0$<br>
<br>

Let $u = -X^{v^x}$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= \left[ \begin{matrix}
	0 \\
	-1 \\
	0
\end{matrix} \right]$<br>
<br>

So for all conditions:<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right]
= \left[ \begin{matrix}
	0 \\
	-n_y \\
	n_x
\end{matrix} \right]$<br>
<br>

<br>
Case $\lambda = |n| c$:<br>
<br>

$\left[ \begin{matrix}
	-|n| \sqrt{gh} & 
	h n_x &
	h n_y \\
	
	g n^x &
	-|n| \sqrt{gh} &
	0 \\

	g n^y &
	0 &
	-|n| \sqrt{gh}
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

Scale first row by $\frac{1}{|n| \sqrt{gh}}$.<br>
Scale second row by $\frac{1}{|n| \sqrt{gh}}$<br>
Scale third row by $\frac{1}{|n| \sqrt{gh}}$<br>
<br>

$\left[ \begin{matrix}
	-1 & 
	\sqrt{\frac{h}{g}} \frac{n_x}{|n|} &
	\sqrt{\frac{h}{g}} \frac{n_y}{|n|} \\
	
	\sqrt{\frac{g}{h}} \frac{n^x}{|n|} &
	-1 &
	0 \\

	\sqrt{\frac{g}{h}} \frac{n^y}{|n|} &
	0 &
	-1
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

Set second row to $\sqrt{\frac{g}{h}} n^x$ times first row plus $|n|$ times second row.<br>
Set third row to $\sqrt{\frac{g}{h}} n^y$ times first row plus $|n|$ times third row.<br>
Scale first row by $|n| \sqrt{\frac{g}{h}}$.<br>
<br>

$\left[ \begin{matrix}
	-|n| \sqrt{\frac{g}{h}} & 
	n_x &
	n_y \\
	
	0 &
	-n_y n^y &
	n_y n^x \\

	0 &
	n_x n^y &
	-n_x n^x
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

For $n_x = 0$ (therefore $n_y \ne 0$):<br>
Scale second row by $\frac{1}{n_y}$<br>
<br>

$\left[ \begin{matrix}
	-|n| \sqrt{\frac{g}{h}} & 
	0 &
	n_y \\
	
	0 &
	-n^y &
	n^x \\

	0 &
	0 &
	0
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

Let $u = X^{v^y}$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = u \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} \frac{n_y}{|n|} \\
	\frac{n^x}{n^y} \\
	1
\end{matrix} \right]$<br>
<br>

Scale by $u \rightarrow n^y u$.<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = u \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} \frac{n_y n^y}{|n|} \\
	n^x \\
	n^y
\end{matrix} \right]$<br>
<br>

Notice that $n_x = 0$ implies $|n|^2 = n_x n^x + n_y n^y = n_y n^y$.<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = u \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} |n| \\
	n^x \\
	n^y
\end{matrix} \right]$<br>
<br>

For $n_y = 0$ (therefore $n_x \ne 0$):<br>
Therefore $|n|^2 = n_x n^x$<br>
<br>

$\left[ \begin{matrix}
	-|n| \sqrt{\frac{g}{h}} & 
	n_x &
	0 \\
	
	0 &
	0 &
	0 \\

	0 &
	n_x n^y &
	-n_x n^x
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

Scale third row by $\frac{1}{n_x}$.<br>
Exchange 2nd and 3rd rows.<br>
<br>

$\left[ \begin{matrix}
	-|n| \sqrt{\frac{g}{h}} & 
	n_x &
	0 \\
	
	0 &
	n^y &
	-n^x \\

	0 &
	0 &
	0
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

Let $u = X^{v^x}$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = u \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} \frac{n_x}{|n|} \\
	1 \\
	\frac{n^y}{n^x}
\end{matrix} \right]$<br>
<br>

Scale by $u \rightarrow u n^x$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = u \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} |n| \\
	n^x \\
	n^y
\end{matrix} \right]$<br>
<br>

For $n_x \ne 0, n_y \ne 0$:<br>
<br>

$\left[ \begin{matrix}
	-|n| \sqrt{\frac{g}{h}} & 
	n_x &
	n_y \\
	
	0 &
	-n_y n^y &
	n_y n^x \\

	0 &
	n_x n^y &
	-n_x n^x
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

For $n_x \ne 0, n_y \ne 0$:<br>
<br>

Scale second row by $\frac{1}{n_y}$.<br>
Scale third row by $\frac{1}{n_x}$ and add second to it.<br>
<br>

$\left[ \begin{matrix}
	-|n| \sqrt{\frac{g}{h}} & 
	n_x &
	n_y \\
	
	0 &
	-n^y &
	n^x \\

	0 &
	0 &
	0
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

Let $u = X^{v^y}$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} \frac{1}{|n|} (\frac{n_x n^x}{n^y} + n_y) \\
	\frac{n^x}{n^y} \\
	1
\end{matrix} \right]$<br>
<br>

Let $u \rightarrow n^y u$<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} |n| \\
	n^x \\
	n^y
\end{matrix} \right]$<br>
<br>

So for all conditions:<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = \left[ \begin{matrix}
	\sqrt{\frac{h}{g}} |n| \\
	n^x \\
	n^y
\end{matrix} \right]$<br>
<br>


<br>
Case $\lambda = -|n| c$:<br>
<br>

$\left[ \begin{matrix}
	|n| \sqrt{gh} & 
	h n_x &
	h n_y \\
	
	g n^x &
	|n| \sqrt{gh} &
	0 \\

	g n^y &
	0 &
	|n| \sqrt{gh}
\end{matrix} \right] \left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = 0$<br>
<br>

Same as above but with the sign flipped:<br>
<br>

$\left[ \begin{matrix}
	X^h \\
	X^{v^x} \\
	X^{v^y}
\end{matrix} \right] = \left[ \begin{matrix}
	-\sqrt{\frac{h}{g}} |n| \\
	n^x \\
	n^y
\end{matrix} \right]$<br>
<br>


<br>
Eigenvalues:<br>
<br>

$\Lambda_A = \left[ \begin{matrix}
	-|n| c & 0 & 0 \\
	0 & 0 & 0 \\
	0 & 0 & |n| c
\end{matrix} \right]$<br>
<br>

<br>
Right eigenvectors:<br>
<br>

$R_A = \left[ \begin{matrix}
	-\sqrt{\frac{h}{g}} |n| &
	0 &
	\sqrt{\frac{h}{g}} |n| \\
	
	n^x &
	-n_y &
	n^x \\
	
	n^y &
	n_x &
	n^y
\end{matrix} \right]$<br>
<br>

Rescale the whole thing by $\frac{1}{|n|}$<br>
<br>

$R_A = \left[ \begin{matrix}
	-\sqrt{\frac{h}{g}} &
	0 &
	\sqrt{\frac{h}{g}} \\
	
	\frac{n^x}{|n|} &
	-\frac{n_y}{|n|} &
	\frac{n^x}{|n|} \\
	
	\frac{n^y}{|n|} &
	\frac{n_x}{|n|} &
	\frac{n^y}{|n|}
\end{matrix} \right]$<br>
<br>

In index form:<br>
For $(n_2)_i$ is orthogonal to $n_i$, such that $(n_2)^i n_j = \delta^i_j$<br>
<br>

${(R_A)^I}_J = \left[ \begin{matrix}
	-\sqrt{\frac{h}{g}} &
	0 &
	\sqrt{\frac{h}{g}} \\
	
	\frac{n^i}{|n|} &
	\frac{(n_2)_i}{|n|} &
	\frac{n^i}{|n|}
\end{matrix} \right]$<br>
<br>


<br>
Left eigenvectors:<br>
<br>

$L_A = (R_A)^{-1}$<br>
<br>

$L_A = \left[ \begin{matrix}
	-\frac{1}{2} \sqrt{\frac{g}{h}} & \frac{n_x}{2 |n|} & \frac{n_y}{2 |n|} \\
	0 & -\frac{n^y}{|n|} & \frac{n^x}{|n|} \\
	\frac{1}{2} \sqrt{\frac{g}{h}} & \frac{n_x}{2 |n|} & \frac{n_y}{2 |n|} 
\end{matrix} \right]$<br>
<br>

In index form:<br>
<br>

$L_A = \left[ \begin{matrix}
	-\frac{1}{2} \sqrt{\frac{g}{h}} & \frac{n_i}{2 |n|} \\
	0 & \frac{(n_2)^i}{|n|} \\
	\frac{1}{2} \sqrt{\frac{g}{h}} & \frac{n_i}{2 |n|} 
\end{matrix} \right]$<br>
<br>


$\frac{\partial F^I}{\partial U^J} = \frac{\partial F}{\partial W} \frac{\partial W}{\partial U} 
	= \frac{\partial U}{\partial W} \frac{\partial W}{\partial U} \frac{\partial F}{\partial W} \frac{\partial W}{\partial U} 
	= \frac{\partial U}{\partial W} (A + v^k n_k I) \frac{\partial W}{\partial U}$<br>
<br>

The eigenvalues of $F$ are $\Lambda_A + v_n I = \left[ \begin{matrix}
	v_n - |n| c & 0 & 0 \\
	0 & v_n & 0 \\
	0 & 0 & v_n + |n| c
\end{matrix} \right]$<br>
<br>

The right eigenvectors of $F$ are $R_F = \frac{\partial U}{\partial W} R_A$<br>
<br>

$R_F = 
\left[ \begin{matrix}
	1 & 0 & 0 \\
	v^x & h & 0 \\ 
	v^y & 0 & h
\end{matrix} \right]
\left[ \begin{matrix}
	-\sqrt{\frac{h}{g}} &
	0 &
	\sqrt{\frac{h}{g}} \\
	
	\frac{n^x}{|n|} &
	\frac{(n_2)_k}{|n|} &
	\frac{n^x}{|n|} \\

	\frac{n^y}{|n|} &
	\frac{(n_2)_k}{|n|} &
	\frac{n^y}{|n|} 
\end{matrix} \right]$<br>
<br>

$R_F = \left[ \begin{matrix}
	-\sqrt{\frac{h}{g}} & 
	0 & 
	\sqrt{\frac{h}{g}} \\

	\frac{n^x}{|n|} h - \sqrt{\frac{h}{g}} v^x &
	-h \frac{n_y}{|n|} &
	\frac{n^x}{|n|} h - \sqrt{\frac{h}{g}} v^x \\

	\frac{n^y}{|n|} h - \sqrt{\frac{h}{g}} v^y &
	h \frac{n_x}{|n|} &
	\frac{n^y}{|n|} h - \sqrt{\frac{h}{g}} v^y
\end{matrix} \right]$<br>
<br>

The left eigenvectors of $F$ are $L_F = L_A \frac{\partial W}{\partial U}$<br>
<br>

$L_F = \left[ \begin{matrix}
	-\frac{1}{2} \sqrt{\frac{g}{h}} & \frac{n_x}{2 |n|} & \frac{n_y}{2 |n|} \\
	0 & \frac{(n_2)^x}{|n|} & \frac{(n_2)^y}{|n|} \\
	\frac{1}{2} \sqrt{\frac{g}{h}} & \frac{n_x}{2 |n|} & \frac{n_y}{2 |n|}
\end{matrix} \right]
\left[ \begin{matrix}
	1 & 0 & 0 \\
	-\frac{1}{h} v^x & \frac{1}{h} & 0 \\ 
	-\frac{1}{h} v^y & 0 & \frac{1}{h}
\end{matrix} \right]
$<br>
<br>

$L_F = \left[ \begin{matrix}
	-\frac{1}{2} \sqrt{\frac{g}{h}} - \frac{v_n}{2 h |n|} &
	\frac{n_x}{2 h |n|} &
	\frac{n_y}{2 h |n|} \\

	-\frac{v_n}{h |n|} &
	-\frac{n^y}{h |n|} &
	\frac{n^x}{h |n|} \\

	\frac{1}{2} \sqrt{\frac{g}{h}} - \frac{v_n}{2 h |n|} &
	\frac{n_x}{2 h |n|} &
	\frac{n_y}{2 h |n|}
\end{matrix} \right]$<br>
<br>

	</body>
</html>
