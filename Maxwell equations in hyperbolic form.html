<!doctype html>
<html>
	<head>
        <meta charset='utf-8'>
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
		<title>Maxwell Equations as Hyperbolic Conservation Laws</title>
	</head>
	<body>

$dx^\mu = (dx^0, dx^1, dx^2, dx^3) = (c dt, dx, dy, dz)$ has units $m$<br>
$\partial_\mu = (\partial_0, \partial_1, \partial_2, \partial_3) = (\frac{1}{c} \partial_t, \partial_x, \partial_y, \partial_z)$ has units $\frac{1}{m}$<br>
<br>

speed of light:	$c = 299792458 \cdot \frac{m}{s}$<br>
<br>

$\epsilon_0 =$ vacuum permittivity, in units $[\frac{C^2 \cdot s^2}{kg \cdot m^3}]$<br>
$\mu_0 =$ vacuum permeability, in units $[\frac{kg \cdot m}{C^2}]$<br>
$\frac{1}{\sqrt{\epsilon_0 \mu_0}} = c$<br>
<br>

$E_i$ = electric field, in units $[\frac{kg \cdot m}{C \cdot s^2}]$<br>
$B_i$ = magnetic field, in units $[\frac{kg}{C \cdot s}]$<br>
$D_i = \epsilon E_i =$ electric displacement field, in units $[\frac{C}{m^2}]$<br>
$B_i = \mu H_i$, for $H_i =$ magnetizing field, in units $[\frac{C}{m \cdot s}]$<br>
<br>

$\epsilon =$ permittivity, in units $[\frac{C^2 \cdot s^2}{kg \cdot m^3}]$<br>
$\mu =$ permeability, in units $[\frac{kg \cdot m}{C^2}]$<br>
$v_p = \frac{1}{\sqrt{\epsilon \mu}} = $ phase velocity<br>
<br>

Wedge product:<br>
$a \wedge b = a \otimes b - b \otimes a$<br>
<br>

Exterior derivative:<br>
$dT = dx^u \wedge \partial_u T$<br>
<br>

Electromagnetic four-potential:<br>
$A = A_u dx^u = A_0 dx^0 + A_i dx^i$<br>
$A_0 = \frac{1}{c} \phi$<br>
$A_i$ is in units of $\frac{kg \cdot m}{C \cdot s}$<br>
$\phi$ is in units of $\frac{kg \cdot m^2}{C \cdot s^2}$<br>
$A = \phi dt + A_i dx^i$<br>
<br>

Faraday tensor:<br>
$F = dA = \partial_u (A_v) dx^u \wedge dx^v$<br>
$F = F_{uv} dx^u \otimes dx^v = \frac{1}{2} F_{uv} dx^u \wedge dx^v$<br>
$F_{uv}$ has units of $\frac{kg}{C \cdot s}$<br>
$F_{uv} = \partial_u A_v - \partial_v A_u = 2 \partial_{[u} A_{v]}$<br>
<br>

$F = E_i \wedge dt + c \star (B_i \wedge dt)$<br>
<br>

Let $\frac{1}{c} E_u = F_{uv} n^v$ for the hypersurface normal $n^a$<br>
Let $B_u = {\epsilon_{uv}}^{ab} F_{ab} n^v$<br>
<br>

$F_{uv} = \downarrow u(i) \overset{\rightarrow v(j)}{ \left[\begin{matrix}
	0 & -\frac{1}{c} E_j \\ 
	\frac{1}{c} E_i & {\bar\epsilon_{ij}}^k B_k
\end{matrix}\right] }$<br>
In 3+1:<br>
$F_{uv} = \left[\begin{matrix}
	0 & -\frac{1}{c} E_1 & -\frac{1}{c} E_2 & -\frac{1}{c} E_3 \\ 
	\frac{1}{c} E_1 & 0 & B_3 & -B_2 \\
	\frac{1}{c} E_2 & -B_3 & 0 & B_1 \\
	\frac{1}{c} E_3 & B_2 & -B_1 & 0
\end{matrix}\right]$<br>
<br>

$\star F = \star (F_{ab} dx^a \wedge dx^b) = F_{ab} \star (dx^a \wedge dx^b) = (\star F)_{ab} dx^a \wedge dx^b$<br>
(Notice that $(\star F)_{ab}$ is a variable denotation, and not an operator, while $\star dx^a$ is an operator.)<br>
TODO don't forget to add in the influence from $g_{ab}$<br>
$(\star F)_{ab} = \frac{1}{2} F_{uv} {\epsilon^{uv}}_{ab}$<br>
$(\star F)_{ab} = \left[\begin{matrix}
	0 & -B_1 & -B_2 & -B_3 \\
	B_1 & 0 & -\frac{1}{c} E_3 & \frac{1}{c} E_2 \\
	B_2 & \frac{1}{c} E_3 & 0 & -\frac{1}{c} E_1 \\
	B_3 & -\frac{1}{c} E_2 & \frac{1}{c} E_1 & 0
\end{matrix}\right]$<br>
<br>

Deriving Maxwell equations:<br>
$dF = d^2 A = 0$<br>
$0 = \partial_a F_{bc} dx^a \wedge dx^b \wedge dx^c$<br>
becomes:<br>
$0 = (F_{23,1} + F_{31,2} + F_{12,3} - F_{32,1} - F_{13,2} - F_{21,3}) dx^1 \wedge dx^2 \wedge dx^3$<br>
$0 = (F_{23,0} + F_{30,2} + F_{02,3} - F_{32,0} - F_{03,2} - F_{20,3}) dx^0 \wedge dx^2 \wedge dx^3$<br>
$0 = (F_{13,0} + F_{30,1} + F_{01,3} - F_{31,0} - F_{03,1} - F_{10,3}) dx^0 \wedge dx^1 \wedge dx^3$<br>
$0 = (F_{12,0} + F_{20,1} + F_{01,2} - F_{21,0} - F_{02,1} - F_{10,2}) dx^0 \wedge dx^1 \wedge dx^2$<br>
becomes:<br>
$B_{1,1} + B_{2,2} + B_{3,3} = 0$<br>
$B_{1,t} + E_{3,2} - E_{2,3} = 0$<br>
$B_{2,t} + E_{1,3} - E_{3,1} = 0$<br>
$B_{3,t} + E_{2,1} - E_{1,2} = 0$<br>
<br>

$D_{uv} = {T_{uv}}^{ab} F_{ab}$<br>
$D_{0i} = c^2 \epsilon F_{0i}$<br>
$D_{i0} = c^2 \epsilon F_{i0}$<br>
$D_{ij} = \frac{1}{\mu} F_{ij}$<br>
Therefore<br>
$c^2 \epsilon = \frac{\epsilon}{\epsilon_0} \frac{1}{\mu_0} = {T_{0i}}^{0i} = {T_{i0}}^{i0} = -{T_{0i}}^{i0} = -{T_{i0}}^{0i}$<br>
$\frac{1}{\mu} = \frac{\mu}{\mu_0} \frac{1}{\mu_0} = {T_{jk}}^{jk} = {T_{kj}}^{kj} = -{T_{jk}}^{kj} = -{T_{kj}}^{jk}$<br>
${T_{aa}}^{bc} = {T_{bc}}^{aa} = 0$<br>
<br>

$D_{uv} = \downarrow u(i) \overset{\rightarrow v(i)}{ \left[\begin{matrix}
	0 & -c D_j \\ 
	c D_i & {\bar\epsilon_{ij}}^k H_k
\end{matrix}\right]}$<br>
<br>
In 3+1:<br>
$D_{uv} = \left[\begin{matrix}
	0 		& -c D_1 	& -c D_2 	& -c D_3 \\ 
	c D_1 	& 0 		& -H_3 		& H_2 \\
	c D_2 	& H_3 		& 0 		& -H_1 \\
	c D_3 	& -H_2 		& H_1 		& 0
\end{matrix}\right]$<br>
<br>

$(\star D)_{ab} = \left[\begin{matrix}
	0 & -H_1 & -H_2 & -H_3 \\
	H_1 & 0 & -c D_3 & c D_2 \\
	H_2 & c D_3 & 0 & -c D_1 \\
	H_3 & -c D_2 & c D_1 & 0
\end{matrix}\right]$<br>
<br>

$J = J_u dx^u = c \rho_{free} dx^0 + J_i dx^i = c^2 \rho_{free} dt + J_i dx^i$<br>
$J_i$ is of units $[\frac{C}{m^2 \cdot s}]$.<br>
$\rho_{charge}$ is of units $[\frac{C}{m^3}]$.<br>
$\rho_{free}$ is of units $[\frac{C}{m^3}]$.<br>
TODO I'm using $\rho_{charge}$ in the expression for the Lorentz force law.  Are these expressions supposed to use the free or bound or total charge?<br>
TODO The displacemet field below uses the free charge only.  That's why I'm assigning $\frac{1}{2} \delta D = J$, but is this true in general, or should the source term of this equation be modified?<br>
TODO Notice, the Wikipedia 'Four-Current' page defines the four-current in contravariant terms, which means it will differ from my definition by the metric lapse and shift.<br> 
<br>

Lorentz force law:<br>
$\ddot{x}^a = \frac{q}{m} {F^a}_b \dot{x}^b$<br>
...where m = mass of particle at x, q = charge of particle at x, and $F_{ab}$ is the Faraday tensor equal to $F = dA$, made up of E and B,<br>
where B is constrained by $\nabla \cdot B = 0$ because of the property $dF = d^2 A = 0$,<br>
and $E = \epsilon^{-1}(D)$ is constrained by $\nabla \cdot D = \rho_{free}$ because of the property $\frac{1}{2} \delta D = J$,<br>
and ${F^a}_b = g^{ac} F_{cb}$ for $g^{ab}$ the inverse of the metric tensor of the manifold that this takes place on.<br>
The metric itself $g_{ab}$ is derived from the mass (of the other particles?), $D^2 \omega $'s contracted trace reversal $= R_{uv} = 8 \pi T_{uv}$<br>
<br>

<h3>Maxwell Equations of charge</h3>

$B_{x,x} + B_{y,y} + B_{z,z} = 0$<br>
$B_{x,t} + E_{z,y} - E_{y,z} = 0$<br>
$B_{y,t} + E_{x,z} - E_{z,x} = 0$<br>
$B_{z,t} + E_{y,x} - E_{x,y} = 0$<br>
$D_{x,x} + D_{y,y} + D_{z,z} = \rho_{free}$<br>
$D_{x,t} - H_{z,y} + H_{y,z} = -J_x$<br>
$D_{y,t} - H_{x,z} + H_{z,x} = -J_y$<br>
$D_{z,t} - H_{y,x} + H_{x,y} = -J_z$<br>
<br>

<h3>in vector notation:</h3>
$\partial_t \left[ \begin{matrix}
	D_x \\
	D_y \\
	D_z \\
	B_x \\
	B_y \\
	B_z
\end{matrix} \right] + \vec\partial \cdot \left[\begin{matrix}
	0 & -H_z & H_y \\
	H_z & 0 & -H_x \\
	-H_y & H_x & 0 \\
	0 & E_z & -E_y \\
	-E_z & 0 & E_x \\
	E_y & -E_x & 0
\end{matrix}\right] = \left[\begin{matrix}
-J_x \\
-J_y \\
-J_z \\
0 \\
0 \\
0
\end{matrix}\right]$<br>

<h3>in index notation:</h3>
$D_{i,i} = \rho_{free}$<br>
$B_{i,i} = 0$<br>
<br>
$D_{i,t} - {\bar\epsilon_i}^{jk} H_{k,j} = -J_i$<br>
$B_{i,t} + {\bar\epsilon_i}^{jk} E_{k,j} = 0$<br>
<br>
$J_i = \sigma E_i = $ current density<br>
$\sigma = $ electric conductivity<br>
<br>

conservation form:<br>
$\int (\partial_t U_I + \nabla_n F_I) dV = S_I$<br>
<br>

conservation variables:<br>
$U_I = \left[\begin{matrix}
	D_i \\
	B_i
\end{matrix}\right]$<br>
<br>

flux:<br>
$F_I(n) = \left[\begin{matrix}
	-{\bar\epsilon_i}^{kj} H_j n_k \\
	 {\bar\epsilon_i}^{kj} E_j n_k
\end{matrix}\right]$<br>
<br>

source:<br>
$S_I = \left[\begin{matrix}
	-J_i \\
	0
\end{matrix}\right]$<br>
<br>

conservation form:<br>
$U_I + \frac{\partial F_I (n^k)}{\partial U_J} \frac{\partial U_J}{\partial x^k} = S_I$<br>
<br>

index/matrix form:<br>
$\left[\matrix{
	D_i \\
	B_i
}\right] + \left[\matrix{
	0 & - \frac{1}{\mu} {\bar\epsilon_i}^{jk} \\
	\frac{1}{\epsilon} {\bar\epsilon_i}^{jk} & 0
}\right] 
\left[\matrix{
	D_k \\
	B_k
}\right]_{,j}
= \left[\matrix{
	-J_i \\
	0
}\right]$<br>
<br>

$\frac{\partial F(n)}{\partial U} = \left[\begin{matrix}
	0 						& 0 						& 0 						& 0 						& \frac{1}{\mu} n^z 		& -\frac{1}{\mu} n^y \\
	0 						& 0 						& 0 						& -\frac{1}{\mu} n^z 		& 0 						& \frac{1}{\mu} n^x \\
	0 						& 0 						& 0 						& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		& 0 \\
	0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& 0 						& 0 						& 0 \\
	\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& 0 						& 0 						& 0 \\
	-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& 0 						& 0 						& 0
\end{matrix}\right]$<br>
<br>

For $a = a_i dx^i = a_x dx + a_y dy + a_z dz$,<br>
Let the one-form $a$ be represented in matrix form as a row vector: $a^\flat = \left[\begin{matrix} a_x & a_y & a_z \end{matrix}\right]$.<br>
<br>
Let $\star a = a_i \star dx^i = a_x dy \wedge dz + a_y dz \wedge dx + a_z dx \wedge dy
= a_x (dy \otimes dz - dz \otimes dy) + a_y (dz \otimes dx - dx \otimes dz) + a_z (dx \otimes dy - dy \otimes dz)$.<br>
$\star a = \left[\begin{matrix}
	0 & a_z & -a_y \\
	-a_z & 0 & a_x \\
	a_y & -a_x & 0
\end{matrix}\right]$,<br>
such that $a \cdot (\star b) = \star (a \wedge b) = a \times b$<br>

Then $\frac{\partial F(n)}{\partial U} = \left[\begin{matrix}
	0 & \star n \frac{1}{\mu} \\
	-\star n \frac{1}{\epsilon} & 0
\end{matrix}\right]$<br>
<br>

Let $\{ n, n_2, n_3 \}$ form an orthonormal basis, such that $g_{ij} (n_a)^i (n_b)^j = \delta_{ab}$ and $\bar\epsilon_{ijk} n^i (n_2)^j (n_3)^k = 1$<br>
<br>

eigen decomposition:<br>
$\frac{\partial F}{\partial U} = R \Lambda L$<br>
<br>

<hr>
<br>

solving for eigenvalues:<br>
$A v = \lambda v$
$(A - \lambda I) v = 0$<br>

$\left|\begin{matrix}
	-\lambda				& 0 						& 0 						& 0 						& \frac{1}{\mu} n^z 		& -\frac{1}{\mu} n^y \\
	0 						& -\lambda 					& 0 						& -\frac{1}{\mu} n^z 		& 0 						& \frac{1}{\mu} n^x \\
	0 						& 0 						& -\lambda 					& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		& 0 \\
	0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& -\lambda 					& 0 						& 0 \\
	\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& 0 						& -\lambda 					& 0 \\
	-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& 0 						& 0 						& -\lambda
\end{matrix}\right| = 0$<br>
<br>

$-\lambda \left|\begin{matrix}
	-\lambda 				& 0 						& -\frac{1}{\mu} n^z 		& 0 						& \frac{1}{\mu} n^x \\
	0 						& -\lambda 					& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		& 0 \\
	-\frac{1}{\epsilon} n^z & \frac{1}{\epsilon} n^y	& -\lambda 					& 0 						& 0 \\
	0 						& -\frac{1}{\epsilon} n^x 	& 0 						& -\lambda 					& 0 \\
	\frac{1}{\epsilon} n^x 	& 0 						& 0 						& 0 						& -\lambda
\end{matrix}\right| 
+ \frac{1}{\mu} n^z \left|\begin{matrix}
	0 						& -\lambda 					& 0 						& -\frac{1}{\mu} n^z 		& \frac{1}{\mu} n^x \\
	0 						& 0 						& -\lambda 					& \frac{1}{\mu} n^y			& 0 \\
	0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& -\lambda 					& 0 \\
	\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& 0 						& 0 \\
	-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& 0 						& -\lambda
\end{matrix}\right|
+ \frac{1}{\mu} n^y \left|\begin{matrix}
	0 						& -\lambda 					& 0 						& -\frac{1}{\mu} n^z 		& 0 						\\
	0 						& 0 						& -\lambda 					& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		\\
	0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& -\lambda 					& 0 						\\
	\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& 0 						& -\lambda 					\\
	-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& 0 						& 0 						
\end{matrix}\right|
= 0$<br>
<br>

$-\lambda \left(
	-\lambda \left|\begin{matrix}
		-\lambda 				& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		& 0 \\
		\frac{1}{\epsilon} n^y	& -\lambda 					& 0 						& 0 \\
		-\frac{1}{\epsilon} n^x & 0 						& -\lambda 					& 0 \\
		0 						& 0 						& 0 						& -\lambda
	\end{matrix}\right| 

	- \frac{1}{\mu} n^z
	\left|\begin{matrix}
		0 						& -\lambda 					& -\frac{1}{\mu} n^x 		& 0 \\
		-\frac{1}{\epsilon} n^z & \frac{1}{\epsilon} n^y	& 0 						& 0 \\
		0 						& -\frac{1}{\epsilon} n^x 	& -\lambda 					& 0 \\
		\frac{1}{\epsilon} n^x 	& 0 						& 0 						& -\lambda
	\end{matrix}\right| 

	+ \frac{1}{\mu} n^x
	\left|\begin{matrix}
		0 						& -\lambda 					& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		\\
		-\frac{1}{\epsilon} n^z & \frac{1}{\epsilon} n^y	& -\lambda 					& 0 						\\
		0 						& -\frac{1}{\epsilon} n^x 	& 0 						& -\lambda 					\\
		\frac{1}{\epsilon} n^x 	& 0 						& 0 						& 0 						
	\end{matrix}\right| 
\right)
+ \frac{1}{\mu} n^z \left(
	\lambda \left|\begin{matrix}
		0 						& -\lambda 					& \frac{1}{\mu} n^y			& 0 \\
		0 						& \frac{1}{\epsilon} n^y	& -\lambda 					& 0 \\
		\frac{1}{\epsilon} n^z 	& -\frac{1}{\epsilon} n^x 	& 0 						& 0 \\
		-\frac{1}{\epsilon} n^y	& 0 						& 0 						& -\lambda
	\end{matrix}\right|

	+ \frac{1}{\mu} n^z \left|\begin{matrix}
		0 						& 0 						& -\lambda 					& 0 \\
		0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& 0 \\
		\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& 0 \\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& -\lambda
	\end{matrix}\right|

	+ \frac{1}{\mu} n^x \left|\begin{matrix}
		0 						& 0 						& -\lambda 					& \frac{1}{\mu} n^y			\\
		0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& -\lambda 					\\
		\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& 0 						\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& 0 						
	\end{matrix}\right|
\right)
+ \frac{1}{\mu} n^y \left(
	\lambda \left|\begin{matrix}
		0 						& -\lambda 					& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		\\
		0 						& \frac{1}{\epsilon} n^y	& -\lambda 					& 0 						\\
		\frac{1}{\epsilon} n^z 	& -\frac{1}{\epsilon} n^x 	& 0 						& -\lambda 					\\
		-\frac{1}{\epsilon} n^y	& 0 						& 0 						& 0 						
	\end{matrix}\right|

	+ \frac{1}{\mu} n^z \left|\begin{matrix}
		0 						& 0 						& -\lambda 					& -\frac{1}{\mu} n^x 		\\
		0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& 0 						\\
		\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& -\lambda 					\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& 0 						
	\end{matrix}\right|
\right)
= 0$<br>
<br>

$-\lambda \left(
	\lambda^2 
	\left|\begin{matrix}
		-\lambda 				& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		\\
		\frac{1}{\epsilon} n^y	& -\lambda 					& 0 						\\
		-\frac{1}{\epsilon} n^x & 0 						& -\lambda 					
	\end{matrix}\right| 

	+ \frac{1}{\mu} n^z \lambda
	\left|\begin{matrix}
		0 						& -\lambda 					& -\frac{1}{\mu} n^x 		\\
		-\frac{1}{\epsilon} n^z & \frac{1}{\epsilon} n^y	& 0 						\\
		0 						& -\frac{1}{\epsilon} n^x 	& -\lambda 					\\
	\end{matrix}\right| 

	- \frac{1}{\mu \epsilon} (n^x)^2
	\left|\begin{matrix}
		-\lambda 				& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		\\
		\frac{1}{\epsilon} n^y	& -\lambda 					& 0 						\\
		-\frac{1}{\epsilon} n^x & 0 						& -\lambda 					
	\end{matrix}\right| 
\right)
+ \frac{1}{\mu} n^z \left(
	-\lambda^2 
	\left|\begin{matrix}
		0 						& \frac{1}{\epsilon} n^y	& -\lambda 					\\
		\frac{1}{\epsilon} n^z 	& -\frac{1}{\epsilon} n^x 	& 0 						\\
		-\frac{1}{\epsilon} n^y	& 0 						& 0 						
	\end{matrix}\right|

	- \frac{1}{\mu} n^z \lambda
	\left|\begin{matrix}
		0 						& 0 						& -\lambda 					\\
		0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	\\
		\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	
	\end{matrix}\right|

	+ -\lambda \frac{1}{\mu} n^x 
	\left|\begin{matrix}
		0 						& -\frac{1}{\epsilon} n^z 	& -\lambda 					\\
		\frac{1}{\epsilon} n^z 	& 0 						& 0 						\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						
	\end{matrix}\right|

	- \frac{1}{\mu^2} n^x n^y
	\left|\begin{matrix}
		0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	\\
		\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						
	\end{matrix}\right|

\right)
+ \frac{1}{\mu} n^y \left(
	\lambda \frac{1}{\epsilon} n^y \left|\begin{matrix}
		-\lambda 				& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		\\
		\frac{1}{\epsilon} n^y	& -\lambda 					& 0 						\\
		-\frac{1}{\epsilon} n^x & 0 						& -\lambda 					
	\end{matrix}\right|

	-\lambda \frac{1}{\mu} n^z 
	\left|\begin{matrix}
		0 						& -\frac{1}{\epsilon} n^z 	& 0 						\\
		\frac{1}{\epsilon} n^z 	& 0 						& -\lambda 					\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						
	\end{matrix}\right|

	+ \frac{1}{\mu^2} n^z n^x
	\left|\begin{matrix}
		0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	\\
		\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						
	\end{matrix}\right|
\right)
= 0$<br>
<br>

$-\lambda \left(
	-\frac{1}{\mu} n^x \lambda^2 
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^y	& -\lambda 					\\
		-\frac{1}{\epsilon} n^x & 0 						
	\end{matrix}\right| 

	- \lambda^3
	\left|\begin{matrix}
		-\lambda 				& \frac{1}{\mu} n^y			\\
		\frac{1}{\epsilon} n^y	& -\lambda 					
	\end{matrix}\right| 

	+ \frac{1}{\mu} n^z \lambda \frac{1}{\epsilon} n^z
	\left|\begin{matrix}
		-\lambda 					& -\frac{1}{\mu} n^x 		\\
		-\frac{1}{\epsilon} n^x 	& -\lambda 					
	\end{matrix}\right| 

	+ \frac{1}{\mu \epsilon} (n^x)^2 \frac{1}{\mu} n^x
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^y	& -\lambda 		\\
		-\frac{1}{\epsilon} n^x & 0 			
	\end{matrix}\right| 

	+ \frac{1}{\mu \epsilon} (n^x)^2 \lambda
	\left|\begin{matrix}
		-\lambda 				& \frac{1}{\mu} n^y		\\
		\frac{1}{\epsilon} n^y	& -\lambda 				
	\end{matrix}\right| 
\right)
+ \frac{1}{\mu} n^z \left(
	+ \lambda^3 
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^z 	& -\frac{1}{\epsilon} n^x 	\\
		-\frac{1}{\epsilon} n^y	& 0 						
	\end{matrix}\right|

	- \frac{1}{\mu} n^z \lambda \frac{1}{\epsilon} n^z
	\left|\begin{matrix}
		0 						& -\lambda 					\\
		-\frac{1}{\epsilon} n^z & \frac{1}{\epsilon} n^y	\\
	\end{matrix}\right|

	+ \lambda^2 \frac{1}{\mu} n^x 
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^z 	& 0 					 \\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 
	\end{matrix}\right|

	- \frac{1}{\mu^2} n^x n^y \frac{1}{\epsilon} n^z
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^z 	& -\frac{1}{\epsilon} n^x 	\\
		-\frac{1}{\epsilon} n^y	& 0 						
	\end{matrix}\right|
	
	- \frac{1}{\mu^2} n^x n^y \frac{1}{\epsilon} n^y
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^z 	& 0 						\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	
	\end{matrix}\right|

\right)
+ \frac{1}{\mu} n^y \left(
	-\lambda \frac{1}{\epsilon} n^y \frac{1}{\mu} n^x
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^y	& -\lambda 	\\
		-\frac{1}{\epsilon} n^x & 0 		
	\end{matrix}\right|

	- \lambda^2 \frac{1}{\epsilon} n^y
	\left|\begin{matrix}
		-\lambda 				& \frac{1}{\mu} n^y	\\
		\frac{1}{\epsilon} n^y	& -\lambda 			
	\end{matrix}\right|

	-\lambda^2 \frac{1}{\mu} n^z 
	\left|\begin{matrix}
		0 						& -\frac{1}{\epsilon} n^z 	\\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	
	\end{matrix}\right|

	+ \frac{1}{\mu^2} n^z n^x \frac{1}{\epsilon} n^z
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^z 	& -\frac{1}{\epsilon} n^x 	\\
		-\frac{1}{\epsilon} n^y	& 0 						
	\end{matrix}\right|

	+ \frac{1}{\mu^2} n^z n^x \frac{1}{\epsilon} n^y
	\left|\begin{matrix}
		\frac{1}{\epsilon} n^z 	& 0 					 \\
		-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 
	\end{matrix}\right|

\right)
= 0$<br>
<br>

$-\lambda \left(
	\frac{1}{\epsilon\mu} \lambda^3 (n^x)^2
	
	- \lambda^3 (\lambda^2 - \frac{1}{\epsilon\mu} (n^y)^2)

	+ \frac{1}{\epsilon\mu} (n^z)^2 \lambda (\lambda^2 - \frac{1}{\epsilon\mu} (n^x)^2 )

	- \frac{1}{\mu^2 \epsilon^2} (n^x)^4 \lambda 

	+ \frac{1}{\mu \epsilon} (n^x)^2 \lambda (\lambda^2 - \frac{1}{\epsilon\mu} (n^y)^2 )
\right)
+ \frac{1}{\mu} n^z \left(
	+ \lambda^3 \frac{1}{\epsilon^2} n^x n^y	

	+ \frac{1}{\mu} n^z \lambda \frac{1}{\epsilon} n^z \lambda \frac{1}{\epsilon} n^z 

	+ \lambda^2 \frac{1}{\mu} n^x \frac{1}{\epsilon} n^z \frac{1}{\epsilon} n^x 

	+ \frac{1}{\mu^2} n^x n^y \frac{1}{\epsilon} n^z \frac{1}{\epsilon} n^x \frac{1}{\epsilon} n^y	
	
	- \frac{1}{\mu^2} n^x n^y \frac{1}{\epsilon} n^y \frac{1}{\epsilon} n^z \frac{1}{\epsilon} n^x 	

\right)
+ \frac{1}{\mu} n^y \left(
	+\lambda^2 \frac{1}{\epsilon} n^y \frac{1}{\epsilon\mu} (n^x)^2

	- \lambda^2 \frac{1}{\epsilon} n^y (\lambda^2 - \frac{1}{\epsilon\mu} (n^y)^2 )

	+ \lambda^2 \frac{1}{\mu} n^z \frac{1}{\epsilon^2} n^z n^y	

	- \frac{1}{\mu^2} n^z n^x \frac{1}{\epsilon} n^z \frac{1}{\epsilon^2} n^x n^y

	+ \frac{1}{\epsilon^3 \mu^2} (n^x)^2 n^y (n^z)^2

\right)
= 0$<br>
<br>

$
	- \lambda^4 \frac{1}{\epsilon\mu} (n^x)^2
	
	+ \lambda^6
	- \lambda^4 \frac{1}{\epsilon\mu} (n^y)^2

	- \lambda^4 \frac{1}{\epsilon\mu} (n^z)^2
	+ \lambda^2 \frac{1}{\epsilon^2 \mu^2} (n^z)^2 (n^x)^2

	+ \lambda^2 \frac{1}{\mu^2 \epsilon^2} (n^x)^4

	- \lambda^4 \frac{1}{\epsilon\mu} (n^x)^2
	+ \lambda^2 \frac{1}{\epsilon^2 \mu^2} (n^x)^2 (n^y)^2 
	
	+ \lambda^3 \frac{1}{\epsilon^2} \frac{1}{\mu} n^x n^y n^z

	+ \lambda^2 \frac{1}{\epsilon^2 \mu^2} (n^z)^4

	+ \lambda^2 \frac{1}{\epsilon^2 \mu^2} (n^x)^2 (n^z)^2

	+ \lambda^2 \frac{1}{\epsilon^2 \mu^2} (n^x)^2 (n^y)^2

	- \lambda^4 \frac{1}{\epsilon \mu} (n^y)^2
	+ \lambda^2 \frac{1}{\epsilon^2 \mu^2} (n^y)^4

	+ \lambda^2 \frac{1}{\epsilon^2 \mu^2} n^z n^z n^y n^y

	+ \frac{1}{\epsilon^3 \mu^3} (n^x)^2 (n^y)^2 (n^z)^2
	
	- \frac{1}{\epsilon^3 \mu^3} (n^x)^2 (n^y)^2 (n^z)^2

	- \frac{1}{\epsilon^3 \mu^3} (n^x)^2 (n^y)^2 (n^z)^2

	+ \frac{1}{\epsilon^3 \mu^3} (n^x)^2 (n^y)^2 (n^z)^2

= 0$<br>
<br>

$ \lambda^2 (
	+ \lambda^4
	
	- \lambda^2 \frac{1}{\epsilon\mu} (2 (n^x)^2 + 2 (n^y)^2 + (n^z)^2)
	
	+ \lambda \frac{1}{\epsilon^2} \frac{1}{\mu} n^x n^y n^z
	
	+ \frac{1}{\epsilon^2 \mu^2} (
		+ (n^x)^4
		+ (n^y)^4
		+ (n^z)^4
		+ 2 (n^x)^2 (n^y)^2 
		+ 2 (n^x)^2 (n^z)^2
		+ (n^z)^2 (n^y)^2
	)
) = 0$<br>
<br>

TODO should be...<Br>
<br>

$ \lambda^2 (
	+ \lambda^4
	
	- \lambda^2 \frac{1}{\epsilon\mu} (2 (n^x)^2 + 2 (n^y)^2 + 2 (n^z)^2)
	
	+ \frac{1}{\epsilon^2 \mu^2} (
		+ (n^x)^4
		+ (n^y)^4
		+ (n^z)^4
		+ 2 (n^x)^2 (n^y)^2 
		+ 2 (n^x)^2 (n^z)^2
		+ 2 (n^z)^2 (n^y)^2
	)
) = 0$<br>
<br>

Let $|n|^2 = (n^x)^2 + (n^y)^2 + (n^z)^2$<br>
<br>

$ \lambda^2 (
	\lambda^4
	- 2 \lambda^2 \frac{1}{\epsilon\mu} |n|^2
	+ \frac{1}{\epsilon^2 \mu^2} |n|^4
) = 0$<br>
<br>

$ \lambda^2 (
	\lambda^2
	- \frac{1}{\epsilon\mu} |n|^2
)^2 = 0$<br>
<br>

$ \lambda^2 (\lambda + \frac{1}{\sqrt{\epsilon\mu}} |n|)^2  (\lambda - \frac{1}{\sqrt{\epsilon\mu}} |n|)^2 = 0$<br>
<br>


Eigenvalues:<br>
$\lambda = 0$ multiplicity 2<br>
$\lambda = -\frac{1}{\sqrt{\epsilon\mu}}$ multiplicity 2<br>
$\lambda = \frac{1}{\sqrt{\epsilon\mu}}$ multiplicity 2<br>
<br>

Eigenvectors of $\lambda = 0$:<br>
<br>

$\left[\begin{matrix}
	0						& 0 						& 0 						& 0 						& \frac{1}{\mu} n^z 		& -\frac{1}{\mu} n^y \\
	0 						& 0		 					& 0 						& -\frac{1}{\mu} n^z 		& 0 						& \frac{1}{\mu} n^x \\
	0 						& 0 						& 0		 					& \frac{1}{\mu} n^y			& -\frac{1}{\mu} n^x 		& 0 \\
	0 						& -\frac{1}{\epsilon} n^z 	& \frac{1}{\epsilon} n^y	& 0		 					& 0 						& 0 \\
	\frac{1}{\epsilon} n^z 	& 0 						& -\frac{1}{\epsilon} n^x 	& 0 						& 0		 					& 0 \\
	-\frac{1}{\epsilon} n^y	& \frac{1}{\epsilon} n^x 	& 0 						& 0 						& 0 						& 0
\end{matrix}\right] \left[\begin{matrix}
	X_{D_x} \\ X_{D_y} \\ X_{D_z} \\ X_{B_x} \\ X_{B_y} \\ X_{B_z}
\end{matrix}\right] = 0$<br>
<br>

$\left[\begin{matrix}
	n^y		& -n^x 	& 0 	& 0 	& 0 	& 0		\\
	n^z 	& 0 	& -n^x 	& 0 	& 0		& 0 	\\
	0 		& n^z 	& -n^y	& 0		& 0 	& 0 	\\
	0 		& 0 	& 0		& n^y	& -n^x 	& 0 	\\
	0 		& 0		& 0 	& n^z 	& 0 	& -n^x 	\\
	0		& 0 	& 0 	& 0 	& n^z 	& -n^y 	
\end{matrix}\right] \left[\begin{matrix}
	X_{D_x} \\ X_{D_y} \\ X_{D_z} \\ X_{B_x} \\ X_{B_y} \\ X_{B_z}
\end{matrix}\right] = 0$<br>
<br>

$\left[\begin{matrix}
	n^y	& -n^x 	& 0 	& 0 	& 0 	& 0		\\
	0 	& n^z 	& -n^y 	& 0 	& 0		& 0 	\\
	0 	& n^z 	& -n^y	& 0		& 0 	& 0 	\\
	0 	& 0 	& 0		& n^y	& -n^x 	& 0 	\\
	0 	& 0		& 0 	& n^z 	& 0 	& -n^x 	\\
	0	& 0 	& 0 	& 0 	& n^z 	& -n^y 	
\end{matrix}\right] \left[\begin{matrix}
	X_{D_x} \\ X_{D_y} \\ X_{D_z} \\ X_{B_x} \\ X_{B_y} \\ X_{B_z}
\end{matrix}\right] = 0$<br>
<br>

$\left[\begin{matrix}
	n^y	& -n^x 	& 0 	& 0 		& 0 		& 0		\\
	0 	& n^z 	& -n^y 	& 0 		& 0			& 0 	\\
	0 	& 0 	& 0		& 0			& 0 		& 0 	\\
	0 	& 0 	& 0		& n^y		& -n^x 		& 0 	\\
	0 	& 0		& 0 	& 0		 	& n^z 		& -n^y 	\\
	0	& 0 	& 0 	& 0 		& 0			& 0
\end{matrix}\right] \left[\begin{matrix}
	X_{D_x} \\ X_{D_y} \\ X_{D_z} \\ X_{B_x} \\ X_{B_y} \\ X_{B_z}
\end{matrix}\right] = 0$<br>
<br>

Let $u_1 = X_{D_z}, u_2 = X_{B_z}$<br>
<br>
$X_{D_y} n^z - X_{D_z} n^y = 0$<br>
$X_{D_y} n^z - u_1 n^y = 0$<br>
$X_{D_y} = u_1 \frac{n^y}{n^z}$<br>
<br>
$X_{D_x} n^y - X_{D_y} n^x = 0$<br>
$X_{D_x} n^y - u_1 \frac{n^y}{n^z} n^x = 0$<br>
$X_{D_x} = u_1 \frac{n^x}{n^z}$<br>

$\left[\begin{matrix}
	X_{D_x} \\ X_{D_y} \\ X_{D_z} \\ X_{B_x} \\ X_{B_y} \\ X_{B_z}
\end{matrix}\right] =
\left[\begin{matrix}
	\frac{n^x}{n^z} & 0 				\\
	\frac{n^y}{n^z} & 0 				\\
	1 				& 0 				\\
	0 				& \frac{n^x}{n^z} 	\\
	0 				& \frac{n^y}{n^z} 	\\
	0 				& 1
\end{matrix}\right] \left[\begin{matrix}
	u_1 \\ u_2
\end{matrix}\right]$<br>
<br>

Let $u_1 \rightarrow u_1 n^z, u_2 \rightarrow u_2 n^z$<br>
<br>

$\left[\begin{matrix}
	X_{D_x} \\ X_{D_y} \\ X_{D_z} \\ X_{B_x} \\ X_{B_y} \\ X_{B_z}
\end{matrix}\right] =
\left[\begin{matrix}
	n^x & 0 	\\
	n^y & 0 	\\
	n^z & 0 	\\
	0 	& n^x 	\\
	0 	& n^y 	\\
	0 	& n^z
\end{matrix}\right] \left[\begin{matrix}
	u_1 \\ u_2
\end{matrix}\right]$<br>
<br>

Eigenvectors of $\lambda = -\frac{1}{\sqrt{\epsilon\mu}}$:<br>
<br>

$\left[\begin{matrix}
	\frac{1}{\sqrt{\epsilon\mu}}	& 0 							& 0 							& 0 							& \frac{1}{\mu} n^z 			& -\frac{1}{\mu} n^y 			\\
	0 								& \frac{1}{\sqrt{\epsilon\mu}} 	& 0 							& -\frac{1}{\mu} n^z 			& 0 							& \frac{1}{\mu} n^x 			\\
	0 								& 0 							& \frac{1}{\sqrt{\epsilon\mu}} 	& \frac{1}{\mu} n^y				& -\frac{1}{\mu} n^x 			& 0 							\\
	0 								& -\frac{1}{\epsilon} n^z 		& \frac{1}{\epsilon} n^y		& \frac{1}{\sqrt{\epsilon\mu}} 	& 0 							& 0 							\\
	\frac{1}{\epsilon} n^z 			& 0 							& -\frac{1}{\epsilon} n^x 		& 0 							& \frac{1}{\sqrt{\epsilon\mu}} 	& 0 							\\
	-\frac{1}{\epsilon} n^y			& \frac{1}{\epsilon} n^x 		& 0 							& 0 							& 0 							& \frac{1}{\sqrt{\epsilon\mu}}
\end{matrix}\right] \left[\begin{matrix}
	X_{D_x} \\ X_{D_y} \\ X_{D_z} \\ X_{B_x} \\ X_{B_y} \\ X_{B_z}
\end{matrix}\right] = 0$<br>
<br>



<hr>
<br>

generalization of the explicitly stated terms below:<br>
<br>

$R = \left[\begin{matrix}
	\sqrt{\epsilon} n_2 & \sqrt{\epsilon} n_3 & \sqrt{\epsilon} n & 0 & \sqrt{\epsilon} n_2 & -\sqrt{\epsilon} n_3 \\
	-\sqrt{\mu} n_3 & \sqrt{\mu} n_2 & 0 & \sqrt{\mu} n & \sqrt{\mu} n_3 & -\sqrt{\mu} n_2
\end{matrix}\right]$<br>
<br>

$L = \left[\begin{matrix}
	n_2 & -n_3 \\
	n_3 & n_2 \\
	n & 0 \\
	0 & n \\
	n_2 & n_3 \\
	n_3 & -n_2
\end{matrix}\right]$<br>
<br>

<hr>
<br>

for the x-direction:<br>
$R = \left[\matrix{
	0 & 0 & \sqrt{\epsilon} & 0 & 0 & 0 \\
	\sqrt{\epsilon} & 0 & 0 & 0 & \sqrt{\epsilon} & 0 \\
	0 & \sqrt{\epsilon} & 0 & 0 & 0 & -\sqrt{\epsilon} \\
	
	0 & 0 & 0 & \sqrt{\mu} & 0 & 0 \\
	0 & \sqrt{\mu} & 0 & 0 & 0 & -\sqrt{\mu} \\
	-\sqrt{\mu} & 0 & 0 & 0 & \sqrt{\mu} & 0 
}\right]$<br>
...Trangenstein says...<br>
$R = \left[\matrix{
	 0 &  0 & -\sqrt{\epsilon} & \sqrt{\epsilon} & 0 & 0 \\
	 0 & -\sqrt{\epsilon} &  0 & 0 & \sqrt{\epsilon} & 0 \\
	-\sqrt{\epsilon} &  0 &  0 & 0 & 0 & -\sqrt{\epsilon} \\
	           
	 0 &  0 &  \sqrt{\mu} & \sqrt{\mu} & 0 & 0 \\
	 \sqrt{\mu} &  0 &  0 & 0 & 0 & \sqrt{\mu} \\
	 0 &  \sqrt{\mu} &  0 & 0 & \sqrt{\mu} & 0 
}\right]$<br>
<br>

$L = \left[\matrix{
	0 & 1 & 0 & 0 & 0 & -1 \\
	0 & 0 & 1 & 0 & 1 & 0 \\
	1 & 0 & 0 & 0 & 0 & 0 \\
	
	0 & 0 & 0 & 1 & 0 & 0 \\
	0 & 1 & 0 & 0 & 0 & 1 \\
	0 & 0 & 1 & 0 & -1 &0 
}\right]$<br>
<br>

$\Lambda = \left[\matrix{
	-v_p & 0 & 0 & 0 & 0 & 0 \\
	0 & -v_p & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & v_p & 0 \\
	0 & 0 & 0 & 0 & 0 & v_p
}\right]$<br>
<br>

<h3>curvilinear coordinates using vectors:</h3>
conserved quantities:<br>
$U^I = \left[\matrix{ 
	D^i \\ B^i 
}\right]$<br>
<br>

Flux:<br>
<br>
$F^{Ij} = \left[\matrix{ 
	-{\bar\epsilon^{ij}}_k H^k \\
	{\bar\epsilon^{ij}}_k E^k
}\right]$<br>
$= \left[\matrix{ 
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} H^l \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} E^l
}\right]$<br>
<br>

Flux partial derivative divergence:<br>
<br>
${F^{Ij}}_{,j} = \left[\matrix{ 
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} H^l \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} E^l
}\right]_{,j}$<br>
$= \left[\matrix{ 
	-\bar\epsilon^{ijk} ((\frac{1}{\sqrt{g}})_{,j} g_{kl} H^l + \frac{1}{\sqrt{g}} g_{kl,j} H^l + \frac{1}{\sqrt{g}} g_{kl} {H^l}_{,j}) \\
	\bar\epsilon^{ijk} ((\frac{1}{\sqrt{g}})_{,j} g_{kl} E^l + \frac{1}{\sqrt{g}} g_{kl,j} E^l + \frac{1}{\sqrt{g}} g_{kl} {E^l}_{,j})
}\right]$<br>
$= \left[\matrix{ 
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} ( -\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} H_k + g_{kl,j} H^l + g_{kl} {H^l}_{,j}) \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} ( -\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} E_k + g_{kl,j} E^l + g_{kl} {E^l}_{,j})
}\right]$<br>
$= \left[\matrix{ 
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} {H^l}_{,j} \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} {E^l}_{,j}
}\right] + \left[\matrix{
	 -\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} H_k + g_{kl,j} H^l) \\
	 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} E_k + g_{kl,j} E^l) 
}\right]$<br>
<br>
flux covariant derivative:<br>
${F^{Ij}}_{;j} = \left[\matrix{ 
	\bar\epsilon^{ijk} \frac{1}{\sqrt{g}} g_{kl} {H^l}_{;j} \\
	-\bar\epsilon^{ijk} \frac{1}{\sqrt{g}} g_{kl} {E^l}_{;j}	
}\right]$<br>
$= \left[\matrix{ 
	\bar\epsilon^{ijk} \frac{1}{\sqrt{g}} g_{kl} ({H^l}_{,j} + {\Gamma^l}_{mj} H^m) \\
	-\bar\epsilon^{ijk} \frac{1}{\sqrt{g}} g_{kl} ({E^l}_{,j}	+ {\Gamma^l}_{mj} E^m)
}\right]$<br>
$= \left[\matrix{ 
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} {H^l}_{,j} \\
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} {E^l}_{,j}
}\right] + \left[\matrix{
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} H^l \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} E^l
}\right]$<br>
<br>
Add and subtract the flux weighted by the volume gradient and the metric partial terms.<br>
This is what the code in my curvilinear solver does by default.  But maybe this should be enabled on a per-equation-system basis.  It seems to be unnecessary for the Maxwell equations.<br>
<br>
${F^{Ij}}_{;j} = \left[\matrix{ 
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} {H^l}_{,j} \\
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} {E^l}_{,j}
}\right]

 + \left[\matrix{
	 -\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} H_k + g_{kl,j} H^l) \\
	 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} E_k + g_{kl,j} E^l) 
}\right]

- \left[\matrix{
	 -\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} H_k + g_{kl,j} H^l) \\
	 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} E_k + g_{kl,j} E^l) 
}\right]
+ \frac{\sqrt{g}_{,j}}{\sqrt{g}} \left[\matrix{
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} H^l \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} E^l
}\right]

- \frac{\sqrt{g}_{,j}}{\sqrt{g}} \left[\matrix{
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} H^l \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} E^l
}\right]

+ \left[\matrix{
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} H^l \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} E^l
}\right]$<br>

$ = \frac{\sqrt{g}}{\sqrt{g}} {F^{Ij}}_{,j} 

+ \frac{\sqrt{g}_{,j}}{\sqrt{g}} F^{Ij}

+ \left[\matrix{
	-\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} H^l \\
	\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} E^l
}\right]

- \left[\matrix{
	 -\frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-{\Gamma^m}_{jm} H_k + (\Gamma_{klj} + \Gamma_{lkj}) H^l) \\
	 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} (-{\Gamma^m}_{jm} E_k + (\Gamma_{klj} + \Gamma_{lkj}) E^l) 
}\right]

- \left[\matrix{
	-{\Gamma^m}_{jm} \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} H^l \\
	{\Gamma^m}_{jm} \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} g_{kl} E^l
}\right]
$<br>

$ = \frac{1}{\sqrt{g}} \left( \sqrt{g} F^{Ij} \right)_{,j} 

+ \left[\matrix{
	-2 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} H^l \\
	2 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} E^l
}\right]
$<br>
<br>

<h3>hyperbolic conservation law system using vectors:</h3>
${U^i}_{,t} + {F^{ij}}_{;j} = S^i$<br>
${U^i}_{,t} + \frac{1}{\sqrt{g}} \left( \sqrt{g} F^{ij} \right)_{,j} = S^i + \left[\matrix{
	2 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} H^l \\
	-2 \frac{1}{\sqrt{g}} \bar\epsilon^{ijk} \Gamma_{jkl} E^l
}\right]$<br>
<br>

<h3>curvilinear coordinates using one-forms:</h3>
$\left[\matrix{ 
	D_i \\ B_i 
}\right] + \left[\matrix{ 
	-{\epsilon_i}^{jk} H_k \\
	{\epsilon_i}^{jk} E_k
}\right]_{;j} = \left[\matrix{
	-J_i \\
	0
}\right]$<br>
<br>

Raise all indexes of the Levi-Civita tensor.  Replace it with the associated Levi-Civita tensor of flat space times the inverse (square root optional) metric determinant.<br>
<br>

$\left[\matrix{ 
	D_i \\ B_i 
}\right] + \left[\matrix{ 
	-\frac{1}{\sqrt{g}} g_{il} \bar\epsilon^{ljk} H_k \\
	\frac{1}{\sqrt{g}} g_{il} \bar\epsilon^{ljk} E_k
}\right]_{;j} = \left[\matrix{
	-J_i \\
	0
}\right]$<br>
<br>

Factor out metric terms since their covariant derivative value is zero.<br>
<br>

$\left[\matrix{ 
	D_i \\ B_i 
}\right] + \frac{1}{\sqrt{g}} \left[\matrix{
	g_{il} & 0 \\
	0 & g_{il}
}\right] \left[\matrix{ 
	-\bar\epsilon^{ljk} H_k \\
	\bar\epsilon^{ljk} E_k
}\right]_{;j} = \left[\matrix{
	-J_i \\
	0
}\right]$<br>
<br>

Apply covariant derivative.  Replace one-forms with partial derivatives and connection products.<br>
<br>

$\left[\matrix{ 
	D_i \\ B_i 
}\right] + \frac{1}{\sqrt{g}} \left[\matrix{
	g_{il} & 0 \\
	0 & g_{il}
}\right] \left[\matrix{ 
	-\bar\epsilon^{ljk} (H_{k,j} - {\Gamma^m}_{kj} H_m) \\
	\bar\epsilon^{ljk} (E_{k,j} - {\Gamma^m}_{kj} E_m)
}\right] = \left[\matrix{
	-J_i \\
	0
}\right]$<br>
<br>

Multiply the antisymmetric Levi-Civita tensor with the symmetric (only in holonomic torsion-free case) connection coefficients to cancel them.<br>
Factor out the remaining partial derivative terms.<br>
<br>

$\left[\matrix{ 
	D_i \\ B_i 
}\right] + \frac{1}{\sqrt{g}} \left[\matrix{
	g_{il} & 0 \\
	0 & g_{il}
}\right] 

\underbrace{
\left[\matrix{ 
	0 & -\frac{1}{\mu} \bar\epsilon^{ljk} \\
	\frac{1}{\epsilon} \bar\epsilon^{ljk} & 0 
}\right] \left[\matrix{
	D_k \\
	B_k
}\right]_{,j} 
}{} = \left[\matrix{
	-J_i \\
	0
}\right]$<br>
<br>

Now the underbraced terms have an eigen-decomposition.  We can compute the flux using this, and transform it afterwards using the metric.<br>
<br>

<h3>with GLM variables</h3>

removing divergence as a PDE:<br>
$D_{i,t} = -D_{i,i} = -\phi_{,i}$ for $\phi_{,t} = -E_{i,i}$<br>
$B_{i,t} = -B_{i,i} = -\psi_{,i}$ for $\psi_{,t} = -B_{i,i}$<br>
<br>

combined with the original system:<br>
(from <a href="http://www.ammar-hakim.org/maxwell-eigensystem.html">http://www.ammar-hakim.org/maxwell-eigensystem.html</a>)<br>
Notice that I assume $\epsilon, \mu$ are constant, otherwise I would have to pick out their derivatives (as I am doing with the curvilinear coordinate system).<br>
$B_{i,t} + {\epsilon_i}^{jk} E_{k,j} + \chi_\psi \psi_{,i} = 0$<br>
$\mu \epsilon E_{i,t} - {\epsilon_i}^{jk} B_{k,j} + \chi_\phi \phi_{,i} = -\mu J_i$<br>
$\frac{1}{\chi_\phi} \phi_{,t} + E_{i,i} = \epsilon^{-1} \rho_{free}$<br>
$\epsilon \mu \frac{1}{\chi_\psi} \psi_{,t} + B_{i,i} = 0$<br>
<br>

Rewritten in terms of $E \rightarrow D = \epsilon E$<br>
$\mu D_{i,t} - {\epsilon_i}^{jk} B_{k,j} + \chi_\phi \phi_{,i} = -\mu J_i$<br>
$B_{i,t} + \epsilon^{-1} {\epsilon_i}^{jk} D_{k,j} + \chi_\psi \psi_{,i} = 0$<br>
$\frac{1}{\chi_\phi} \phi_{,t} + \epsilon^{-1} D_{i,i} = \epsilon^{-1} \rho_{free}$<br>
$\epsilon \mu \frac{1}{\chi_\psi} \psi_{,t} + B_{i,i} = 0$<br>
<br>

Scale line #1 by $\mu^{-1}$, line #3 by $\chi_\phi$, line #4 by $\epsilon^{-1} \mu^{-1}$<br>
$D_{i,t} - \mu^{-1} {\epsilon_i}^{jk} B_{k,j} + \mu^{-1} \chi_\phi \phi_{,i} = -J_i$<br>
$B_{i,t} + \epsilon^{-1} {\epsilon_i}^{jk} D_{k,j} + \chi_\psi \psi_{,i} = 0$<br>
$\phi_{,t} + \epsilon^{-1} \chi_\phi D_{i,i} = \epsilon^{-1} \chi_\phi \rho_{free}$<br>
$\psi_{,t} + \epsilon^{-1} \mu^{-1} \chi_\psi B_{i,i} = 0$<br>
<br>

change of variables $\phi \rightarrow \phi' = \mu \phi$<br>
$D_{i,t} - \mu^{-1} {\epsilon_i}^{jk} B_{k,j} + \chi_\phi \phi_{,i} = -J_i$<br>
$B_{i,t} + \epsilon^{-1} {\epsilon_i}^{jk} D_{k,j} + \chi_\psi \psi_{,i} = 0$<br>
$\mu \phi_{,t} + \epsilon^{-1} \chi_\phi D_{i,i} = \epsilon^{-1} \chi_\phi \rho_{free}$<br>
$\psi_{,t} + \epsilon^{-1} \mu^{-1} \chi_\psi B_{i,i} = 0$<br>
<br>

substitute $v_p^2 = \epsilon^{-1} \mu^{-1}$<br>
$D_{i,t} - \mu^{-1} {\epsilon_i}^{jk} B_{k,j} + \chi_\phi \phi_{,i} = -J_i$<br>
$B_{i,t} + \epsilon^{-1} {\epsilon_i}^{jk} D_{k,j} + \chi_\psi \psi_{,i} = 0$<br>
$\phi_{,t} + (v_p)^2 \chi_\phi D_{i,i} = (v_p)^2 \chi_\phi \rho_{free}$<br>
$\psi_{,t} + (v_p)^2 \chi_\psi B_{i,i} = 0$<br>
<br>

scale $\phi \rightarrow \phi' = v_p \phi, \psi \rightarrow \psi' = v_p \psi$, $\chi \rightarrow \chi' = \frac{1}{v_p} \chi$<br>
$D_{i,t} - \mu^{-1} {\epsilon_i}^{jk} B_{k,j} + \chi_\phi \phi_{,i} = -J_i$<br>
$B_{i,t} + \epsilon^{-1} {\epsilon_i}^{jk} D_{k,j} + \chi_\psi \psi_{,i} = 0$<br>
$v_p \phi_{,t} + v_p \chi_\phi D_{i,i} = v_p \chi_\phi \rho_{free}$<br>
$v_p \psi_{,t} + v_p \chi_\psi B_{i,i} = 0$<br>
<br>

Scale line #3 and line #4 by $(v_p)^{-1}$<br>
$D_{i,t} - \mu^{-1} {\epsilon_i}^{jk} B_{k,j} + \chi_\phi \phi_{,i} = -J_i$<br>
$B_{i,t} + \epsilon^{-1} {\epsilon_i}^{jk} D_{k,j} + \chi_\psi \psi_{,i} = 0$<br>
$\phi_{,t} + \chi_\phi D_{i,i} = \chi_\phi \rho_{free}$<br>
$\psi_{,t} + \chi_\psi B_{i,i} = 0$<br>
<br>

conserved quantities:<br>
$U^I = \left[\matrix{ 
	D^i \\ B^i \\ \phi \\ \psi
}\right]$<br>
<br>

Sources:<br>
<a href='https://en.wikipedia.org/wiki/Electric_displacement_field'>https://en.wikipedia.org/wiki/Electric_displacement_field</a><br>
Trangenstein, "Numeric Solutions of Hyperbolic Partial Differential Equations," 2009<br>
<br>
<br>

	</body>
</html>
