<!doctype html>
<html>
	<head>
		<meta charset='utf-8'/>
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
		<title>EMHD Hyperbolic Conservation Laws</title>
	</head>
	<body onload='tryToFindMathJax();'>

Following the paper:<br>
<br>
Alcubierre, Degollado, Salgado, "The Einstein-Maxwell System in 3+1 form and initial data for multiple charged black holes" 2009.<br>
<br>

variables:<br>
$\mu_0 =$ vacuum permeability<br>
$\epsilon_0 =$ vacuum permissivity<br>
$c = \frac{1}{\sqrt{\mu_0 \epsilon_0}} =$ vacuum speed-of-light<br>
$\rho =$ density<br>
$v^i = $ 3-velocity<br>
$u^a = \left[u^t, u^i\right] = \left[u^t, u^t v^i\right] = $ 4-velocity<br>
$u^t = (1 - v^2)^{-1/2} =$ Lorentz factor<br>
$p^a = \rho u^a =$ 4-momentum<br>
<br>

Special relativistic basis:<br>
$e_t = \frac{1}{c} \partial_t$<br>
$e^t = c dt$<br>
$e_i = \partial_i$<br>
$e^i = dx^i$<br>
<br>

Special relativistic metric:<br>
$\eta_{ab} = \left[\matrix{
	-1 & 0 & 0 & 0 \\
	0 & 1 & 0 & 0 \\
	0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 1
}\right]$<br>
$\eta^{ab} = \left[\matrix{
	-1 & 0 & 0 & 0 \\
	0 & 1 & 0 & 0 \\
	0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 1
}\right]$<br>
<br>

Faraday tensor:<br>
$\phi = $ electric potential<br>
$A^i = $ magnetic vector potential<br>
$A^u = \left[ -\frac{1}{c} \phi, A^i \right] $ electromagnetic 4-potential<br>
$A_u = \left[ \frac{1}{c} \phi, A_i \right] $ <br>
$F_{uv} = 2 \partial_{[u} A_{v]}$ in flat space<br>
$F_{uv} $$ = \downarrow u \overset{\rightarrow v}{
\left[\matrix{
	0 & e_t A_j - e_j A_t \\
	e_i A_t - e_t A_i & e_i A_j - e_j A_i
}\right]
}$$ = \downarrow u \overset{\rightarrow v}{
\left[\matrix{
	0 & \frac{1}{c} (\partial_t A_j - \partial_j \phi) \\
	\frac{1}{c} (\partial_i \phi - \partial_t A_i) & \partial_i A_j - \partial_j A_i
}\right]
}$$ = \downarrow u \overset{\rightarrow v}{
\left[\matrix{
	0 & -\frac{1}{c} E_j \\
	\frac{1}{c} E_i & \epsilon_{ijk} B^k
}\right]
}$<br>

${F^u}_v = \downarrow u \overset{\rightarrow v}{
\left[\matrix{
	0 & \frac{1}{c} E_j \\
	\frac{1}{c} E^i & {\epsilon^i}_{jk} B^k
}\right]
}$<br>
<br>

$F^{uv} = \downarrow u \overset{\rightarrow v}{
\left[\matrix{
	0 & \frac{1}{c} E^j \\
	-\frac{1}{c} E^i & \epsilon^{ijk} B_k
}\right]
}$<br>
$(\star F)_{uv} = \downarrow u \overset{\rightarrow v}{
\left[\matrix{
	0 & -B_j \\
	B_i & \frac{1}{c} \epsilon_{ijk} E^k
}\right]
}$<br>
$(\star F)^{uv} = \downarrow u \overset{\rightarrow v}{
\left[\matrix{
	0 & -B^j \\
	B^i & \frac{1}{c} \epsilon^{ijk} E_k
}\right]
}$<br>
<br>

Lorentz force law:<br>
$\dot{p}^a = e {F^a}_b u^b$<br>
$\frac{1}{c} \partial_t (\rho u^t v^i) = e u^t (\frac{1}{c} E^i + {\epsilon^i}_{jk} B^k v^j)$<br>
in flat space:<br>
$\frac{1}{c} \partial_t (\rho v^i) = e (\frac{1}{c} E^i + {\epsilon^i}_{jk} B^k v^j)$<br>
<br>

Maxwell in flat space:<br>
$\partial_b (\star F)^{ab} = \partial_b (\frac{1}{2} F^{uv} {\epsilon_{uv}}^{ab}) = 0$<br>
$\partial_i B^i = 0$<br>
$\frac{1}{c} \partial_t B^i + \frac{1}{c} {\epsilon_i}^{jk} \partial_j E_k = 0$<br>
$\partial_t B^i + {\epsilon_i}^{jk} \partial_j E_k = 0$<br>
<br>
$\sigma = $ electric conductivity<br>
$j^i = \sigma E^i = $ current density<br>
$J^a = \left[ c \rho_{charge}, j^i \right] =$ 4-current<br>
$\partial_b F^{ab} = \mu_0 J^a$<br>
$\frac{1}{c} \partial_i E^i = \mu_0 c \rho_{charge}$<br>
$\mu_0 \epsilon_0 \partial_i E^i = \mu_0 \rho_{charge}$<br>
$\partial_i E^i = \frac{1}{\epsilon_0} \rho_{charge}$<br>
<br>
$-\frac{1}{c^2} \partial_t E^i + \epsilon^{ijk} \partial_j B_k = \mu_0 j^i$<br>
$-\mu_0 \epsilon_0 \partial_t E^i + \epsilon^{ijk} \partial_j B_k = \mu_0 j^i$<br>
$\epsilon_0 \partial_t E^i - \epsilon^{ijk} \partial_j (\frac{1}{\mu_0} B)_k = -j^i$<br>
<br>

<h3>Curved space</h3>

$\alpha =$ lapse<br>
$\beta^i =$ shift<br>
$\gamma_{ij} =$ spatial metric<br>
$g_{uv} = \downarrow u \overset{\rightarrow v}{\left[\matrix{
	-\alpha^2 + \beta^2 & \beta_j \\
	\beta_i & \gamma_{ij}
}\right]}$<br>
$g^{uv} = \downarrow u \overset{\rightarrow v}{\left[\matrix{
	-\alpha^{-2} & \alpha^{-2} \beta^j \\
	\alpha^{-2} \beta^i & \gamma^{ij} - \alpha^{-2} \beta^i \beta^j
}\right]}$<br>
<br>

$n_a = (-\alpha, 0)$ and $n^a = (1 / \alpha, -\beta^i / \alpha)$.<br>
<br>

$K_{ab} = -{\gamma_a}^c {\gamma_b}^d \nabla_{[c} n_{d]}$<br>
$K_{ij} = -(\delta_i^a + n_i n^a) (\delta_j^b + n_j n^b) \nabla_{[a} n_{b]}$<br>
$K_{ij} = -(\delta_i^a \delta_j^b + n_i n^a \delta_j^b + \delta_i^a n_j n^b + n_i n_j n^a n^b) \nabla_{[a} n_{b]}$<br>
$K_{ij} = -(\delta_i^m \delta_j^n \nabla_{[m} n_{n]} + n_i n^a \delta_j^n \nabla_{[a} n_{n]} + \delta_i^m n_j n^b \nabla_{[m} n_{b]} + n_i n_j n^a n^b \nabla_{[a} n_{b]})$<br>
TODO where does $c$ fit into $K$...<br>
<br>

$\nabla_u F^{au} = 2 \nabla_u \nabla^{[a} A^{u]} + {R^a}_u A^u$ in curved space<br>
<br>

$^{(3)} \epsilon^{\perp afg} = n_b {\gamma^a}_e {\gamma^f}_c {\gamma^g}_d \epsilon^{bacd} = n_b \epsilon^{bafg}$<br>
$\epsilon^{0123} = \frac{-1}{\sqrt{-g}} = \frac{-1}{\alpha \sqrt\gamma}$<br>
$^{(3)} \epsilon^{\perp afg} = -\alpha {\gamma^a}_e {\gamma^f}_c {\gamma^g}_d \epsilon^{0ecd}$<br>
$^{(3)} \epsilon^{\perp 123} = -\alpha \epsilon^{0123} = \frac{1}{\sqrt\gamma}$<br>
$^{(3)} \epsilon^{abc} = ^{(3)} \epsilon^{\perp abc}$<br>
such that $^{(3)} \epsilon^{123} = \frac{1}{\sqrt\gamma}$<br>
also note $\epsilon^{abc}_F = \sqrt\gamma ^{(3)} \epsilon^{abc}$ and $\epsilon^F_{abc} = \frac{1}{\sqrt\gamma} ^{(3)} \epsilon_{abc}$<br>
for $\epsilon^{abc}_F$ and $\epsilon^F_{abc}$ the flat-space undensitized permutation tensor (typically denoted as $[abc]$ right?)<br>
<br>

Faraday tensor projection:<br>
$F^{ab} = ^{(3)} F^{ab} + n^a {}^{(3)} F^{\perp b} + {}^{(3)} F^{a \perp} n^b$<br>
<br>

Measure electric and magnetic fields by Eulerian observers:<br>
$E^a = -n_b F^{ba} = ^{(3)}F^{\perp a}$<br>
$B^a = -n_b (\star F)^{ba} = ^{(3)} (\star F)^{\perp a}$<br>
<br>

Note $n_a E^a = 0$ and $n_a B^a = 0$, therefore $E^a$ and $B^a$ are vectors in the spacelike hypersurface.<br>
<br>

Combine the definitions to find:<br>
$F^{ab} = ^{(3)} F^{ab} + n^a E^b - E^a n^b$<br>
<br>

Combine further to define $B^a$:<br>
$B^a = \frac{1}{2} n_b {\epsilon^{ba}}_{cd} F^{cd}$<br>
$= \frac{1}{2} n_b \epsilon^{bacd} (^{(3)} F_{cd} n_c E_d - E_c n_d)$<br>
$= \frac{1}{2} n_b \epsilon^{bacd} {}^{(3)} F_{cd}$<br>

Jumping to the end:<br>
$\frac{1}{c} D_a E^a = \frac{1}{c} \frac{1}{\sqrt\gamma} \partial_i (\sqrt\gamma E^i) = \mu_0 c \rho$ for $\rho = -n_a j^a$<br>
$D_a B^a = \frac{1}{\sqrt\gamma} \partial_i (\sqrt\gamma B^i) = 0$<br>
<br>
using $\frac{d}{dt} = \frac{1}{c} \partial_t - \mathcal{L}_\vec\beta$<br>
TODO should there be any units on the $\mathcal{L}_\vec\beta$?  Make an argument for this.<br>
$\frac{1}{c} \frac{d}{dt} E^i = ^{(3)} \epsilon^{ijk} \partial_j (\alpha B_k) + \frac{1}{c} \alpha K E^i - \mu_0 \alpha ^{(3)} j^i$<br>
$\frac{1}{c} \frac{d}{dt} B^i = -\frac{1}{c} ^{(3)} \epsilon^{ijk} \partial_j (\alpha E_k) + \alpha K B^i$<br> 
<br>
with flat-space permutation tensors, expanded partials, in hyperbolic conservation form:<br>
$\frac{1}{c^2} \partial_t E^i
		- \frac{1}{c} \beta^j \partial_j E^i
		- \frac{1}{\sqrt\gamma} \alpha \epsilon_F^{ijk} \gamma_{kl} \partial_j B^l
	= \frac{1}{\sqrt\gamma} \epsilon_F^{ijk} (\partial_j \alpha B_k + \alpha \partial_j \gamma_{kl} B^l) 
		+ \frac{1}{c} \alpha K E^i 
		- \frac{1}{c} E^j \partial_j \beta^i
		- \mu_0 \alpha (j^i + \beta^i j^t)
$<br>
$\frac{1}{c} \partial_t B^i
		+ \frac{1}{c} \frac{1}{\sqrt\gamma} \alpha \epsilon_F^{ijk} \gamma_{kl} \partial_j E^l
		- \frac{1}{c} \partial_j B^i \beta^j
	= -\frac{1}{c} \frac{1}{\sqrt\gamma} \epsilon_F^{ijk} (\partial_j \alpha E_k + \alpha \partial_j \gamma_{kl} E^l) 
		+ \alpha K B^i 
		- \frac{1}{c} B^j \partial_j \beta^i
$<br> 
<br>
as a matrix:<br>
$\frac{1}{c} \partial_t \left[\matrix{
	E^i \\
	B^i
}\right]
+ \partial_j \left[\matrix{
	- \beta^j \delta^i_l &
		\frac{\alpha}{\sqrt\gamma} \epsilon_F^{ijk} \gamma_{kl} \\
	- \frac{\alpha}{\sqrt\gamma} \epsilon_F^{ijk} \gamma_{kl} &
		- \beta^j \delta^i_l
}\right] \left[\matrix{
	E^l \\
	B^l
}\right]
= \left[\matrix{
	\frac{1}{\sqrt\gamma} \epsilon_F^{ijk} (\partial_j \alpha B_k + \alpha \partial_j \gamma_{kl} B^l) 
		+ \alpha K E^i 
		- E^j \partial_j \beta^i
		- 4 \pi \alpha (j^i + \beta^i j^t) \\
	-\frac{1}{\sqrt\gamma} \epsilon_F^{ijk} (\partial_j \alpha E_k + \alpha \partial_j \gamma_{kl} E^l) 
		+ \alpha K B^i 
		- B^j \partial_j \beta^i
}\right]$<br>
<br>

I'm leaving the $\partial \alpha$ and $\partial \gamma_{ij}$ terms on the source side because they are replaced with variables when converting the system to 1st order.<br>
<br>

charge conservation:<br>
$\nabla_c j^c = 0$<br>
in 3+1 form:<br>
$\frac{1}{c} \partial_t \rho - \mathcal{L}_\vec\beta \rho = -D_a (\alpha ^{(3)} j^a) + \alpha \rho K$<br>

<h3>Combining Maxwell and fluids</h3>

primitives:<br>
$U^I = \left[\matrix{
	\rho \\ \rho v^i \\ E^i \\ B^i \\ E_{hydro}
}\right]$<br>
<br>

conservatives:<br>
$U^I = \downarrow I(i) \left[\matrix{
	\rho \\ \rho v^i \\ E_{hydro} \\ \epsilon E^i \\ B^i
}\right]$<br>
$E_{hydro} = E_{kin} + E_{int}$<br>
$= \frac{1}{2} \rho v^2 + \frac{P}{\gamma - 1} =$ total hydrodynamic energy<br>
$E_{EM} = \frac{1}{2} ( \epsilon_0 E^2 + \frac{1}{\mu_0} B^2 ) = $ electomagnetic energy, but I'm not incorporating it into the conservative energy just yet...<br>
<br>

Conservative PDEs:<br>
$\rho_{,t} + (\rho v^i)_{,i} = 0$<br>
$(\rho v^i)_{,t} + (\rho v^i v^j + \delta^{ij} P)_{,j} = 0$<br>
$(E_{hydro})_{,t} + (v^j H_{hydro})_{,j} = 0$<br>
$(\epsilon_0 E^i)_{,t} - (\frac{1}{\mu_0} {\epsilon^{ij}}_k B^k)_{,j} = -J^i$<br>
${B^i}_{,t} + ({\epsilon^{ij}}_k E^k)_{,j} = 0$<br>
<br>

<h3>Election vs Ion</h3>
using Abgrall, Kumar "Robust Finite Volume Schemes for Two-Fluid Plasma Equations<br>
and some "Multi Fluid Plasma Model" preprint by ???<br>
<br>

variables:<br>
$q_\alpha = $ charge of species $\alpha$<br>
$m_\alpha = $ mass of species $\alpha$<br>
$r_\alpha = q_\alpha / m_\alpha$ = ratio of charge to mass<br>
$\rho_\alpha = n_\alpha m_\alpha$<br>
$P_\alpha = n_\alpha k_B T_\alpha$<br>
<br>

Flux derivative wrt conservative variables:<br>
$\left[\matrix{
	\rho_{ion} \\ \rho_{ion} v_{ion}^i \\ E_{hydro,ion} \\ 
	\rho_{elec} \\ \rho_{elec} v_{elec}^i \\ E_{hydro,elec} \\ 
	\epsilon_0 E^i \\ B^i
}\right]_{,t} + \left[\matrix{
	0 & \delta^{jk} & 0 & 0 & 0 & 0 & 0 & 0 \\
	-v_{ion}^i v_{ion}^j + \frac{1}{2} \delta^{ij} \tilde\gamma v_{ion}^2 &
		\delta^i_k v_{ion}^j + \delta^j_k v_{ion}^i - \delta^{ij} \tilde\gamma v_{ion,k} &
		\delta^{ij} \tilde\gamma &
		0 & 0 & 0 & 0 & 0 \\
	v_{ion}^j (\frac{1}{2} \tilde\gamma v_{ion}^2 - h_{hydro,ion}) &
		-\tilde\gamma v_{ion}^j v_{ion,k} + \delta^j_k h_{hydro,ion} &
		\gamma v_{ion}^j &
		0 & 0 & 0 & 0 & 0 \\

	0 & 0 & 0 &0 & \delta^{jk} & 0 & 0 & 0 \\
	0 & 0 & 0 & -v_{elec}^i v_{elec}^j + \frac{1}{2} \delta^{ij} \tilde\gamma v_{elec}^2 &
		\delta^i_k v_{elec}^j + \delta^j_k v_{elec}^i - \delta^{ij} \tilde\gamma v_{elec,k} &
		\delta^{ij} \tilde\gamma &
		0 & 0 \\
	0 & 0 & 0 & v_{elec}^j (\frac{1}{2} \tilde\gamma v_{elec}^2 - h_{hydro,elec}) &
		-\tilde\gamma v_{elec}^j v_{elec,k} + \delta^j_k h_{hydro,elec} &
		\gamma v_{elec}^j &
		0 & 0 \\
	
	0 & 0 & 0 & 0 & 0 & 0 & 0 & -\frac{1}{\mu_0} {\epsilon^{ij}}_k \\
	0 & 0 & 0 & 0 & 0 & 0 & \frac{1}{\epsilon_0} {\epsilon^{ij}}_k & 0 \\
}\right] \left[\matrix{
	\rho_{ion} \\ \rho_{ion} v_{ion}^k \\ E_{hydro,ion} \\ 
	\rho_{elec} \\ \rho_{elec} v_{elec}^k \\ E_{hydro,elec} \\ 
	\epsilon_0 E^k \\ B^k
}\right]_{,j} = \left[\matrix{
	0 \\
	r_{ion} \rho_{ion} (E^i + {\epsilon^i}_{jk} B^k v_{ion}^j) \\
	r_{ion} \rho_{ion} (E_j v_{ion}^j) \\ 
	
	0 \\
	r_{elec} \rho_{elec} (E^i + {\epsilon^i}_{jk} B^k v_{elec}^j) \\
	r_{elec} \rho_{elec} (E_j v_{elec}^j) \\ 
	
	- \Sigma_\alpha r_\alpha \rho_\alpha v^i_\alpha
	0 \\ 
}\right]$<br>
<br>

with constraints:<br>
${\epsilon_0 E^i}_{,i} = \Sigma_\alpha r_\alpha \rho_\alpha$<br>
${B^i}_{,i} = 0$<br>
	
	</body>
</html>
