<!doctype html>
<html>
	<head>
		<meta charset='utf-8'/>
		<title>Laplace-Beltrami numerical implementation</title>
		<script type="text/javascript" src='tryToFindMathJax.js'></script>
	</head>
    <body>

scalar fields in Cartesian coordinates:<br>
<br>

$\Delta f = \nabla \cdot \nabla f = \Sigma_i \frac{\partial^2 f}{\partial (x^i)^2}$<br>
<br>
finite-difference:<br>
$\Delta f \approx \Sigma_i \frac{ (\frac{f(x + e_i) - f(x)}{\Delta x_i}) - (\frac{f(x) - f(x - e_i)}{\Delta x_i}) }{\Delta x_i}$<br>
$\approx \Sigma_i \frac{ f(x + e_i) - 2 f(x) + f(x - e_i) }{(\Delta x_i)^2}$<br>
$\approx \Sigma_i \frac{ f(x + e_i) + f(x - e_i) }{(\Delta x_i)^2} - 2 f(x) \Sigma_i \frac{1}{(\Delta x_i)^2}$<br>
$\approx \Sigma_i \frac{ f_{I(x + e_i)} + f_{I(x - e_i)} }{(\Delta x_i)^2} - 2 f_{I(x)} \Sigma_i \frac{1}{(\Delta x_i)^2}$<br>
$\approx A_{jk} f_j$<br>
for $A_{jj} = -2 \Sigma_i \frac{1}{(\Delta x_i)^2}$<br>
for $A_{jk} = \frac{1}{(\Delta x_i)^2}$ for $j = I(x), k = I(x + e_i)$, so notice that no summation over $i$ is used.<br> 
<br>

scalar fields in curvilinear coordinates:<br>
<br>

$\Delta f = \nabla \cdot \nabla f = f_{;ab} g^{ab}$<br>
$= (f_{,ab} - {\Gamma^c}_{ab} f_{,c}) g^{ab}$<br>
$= f_{,ab} g^{ab} - \Gamma^c f_{,c}$<br>
<br>

another derivation:<br>
$\Delta \phi = {\phi_{;a}}^a$<br>
$= g^{ab} \phi_{;ab}$<br>
$= g^{ab} (\phi_{,a})_{;b}$<br>
$= g^{ab} (\phi_{,ab} - {\Gamma^c}_{ab} \phi_{,c})$<br>
$= {\Gamma_b}^{ba} \phi_{,a} 
	- {\Gamma_b}^{ba} \phi_{,a}
	- {\Gamma^{ab}}_b \phi_{,a}
	+ g^{ab} \phi_{,ab}
$<br>
$= {\Gamma^c}_{bc} g^{ab} \phi_{,a}
	- g^{ac} (\Gamma_{cbd} + \Gamma_{dbc}) g^{db} \phi_{,a}
	+ g^{ab} \phi_{,ab}
$<br>
$= \frac{1}{\sqrt{|g|}} (\sqrt{|g|})_{,b} g^{ab} \phi_{,a}
	- g^{ac} g_{cd,b} g^{db} \phi_{,a}
	+ g^{ab} \phi_{,ab}
$<br>
$= \frac{1}{\sqrt{|g|}} (
	(\sqrt{|g|})_{,b} g^{ab} \phi_{,a}
	+ \sqrt{|g|} {g^{ab}}_{,b} \phi_{,a}
	+ \sqrt{|g|} g^{ab} \phi_{,ab}
)$<br>
$= \frac{1}{\sqrt{|g|}} (\sqrt{|g|} g^{ab} \phi_{,a})_{,b}$<br>
<br>

	</body>
</html>
