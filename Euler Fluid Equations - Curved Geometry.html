<!doctype html>
<html>
	<head>
        <meta charset="UTF-8">
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
		<title>Euler Fluid Equation - Curved Geometry</title>
	</head>
	<body onload='tryToFindMathJax();'>

Riemannian geometry identity:<br>
${\Gamma^i}_{ki} = \frac{1}{2 g} g_{,k} = ln(\sqrt{g})_{,k}$<br>
$ = \frac{(\sqrt{g})_{,k}}{\sqrt{g}}$<br>
<br>

<h3>Euler Fluid Equations</h3>

variables:<br>
$\rho =$ density<br>
$v_i =$ velocity<br>
$m_i = \rho v_i = $ momentum<br>
$P =$ pressure<br>
$\gamma =$ heat capacity ratio<br>
$\tilde\gamma = \gamma - 1$<br>

$E_{kin} = \frac{1}{2} \rho v^k v_k$<br>
$E_{int} = \frac{P}{\tilde\gamma}$<br>
$E_{total} = E_{kin} + E_{int}$<br>
$H_{total} = E_{total} + P = \frac{1}{2} \rho v^2 + \frac{\gamma}{\tilde\gamma} P$<br>
<br>

Let $IJK...$ spanning $\{ \rho, v^i, E_{total} \}$<br>
<br>

Conservative and primitive variables:<br>
<br>

$W^I = \left[\matrix{ \rho \\ v^i \\ P }\right]$<br>
$U^I = \left[\matrix{ \rho \\ \rho v^i \\ E_{total} }\right]$<br>
<br>

$\frac{\partial U^I}{\partial W^J} = \downarrow I \overset{\rightarrow J}{\left[\matrix{
	1 & 0 & 0 \\
	v^i & \rho \delta^i_j & 0 \\
	\frac{1}{2} v^2 & \rho v_j & 1/\tilde\gamma
}\right]}$<br>
$\frac{\partial W^I}{\partial U^J} = \downarrow I \overset{\rightarrow J}{ \left[\matrix{
	1 & 0 & 0 \\
	-v^i / \rho & \delta^i_j / \rho & 0 \\
	\frac{1}{2} \tilde\gamma v^2 & -\tilde\gamma v_j & \tilde\gamma
}\right]}$<br>
<br>

Flux term:<br>
$F^{Ij} = \left[\matrix{ \rho v^j \\ \rho v^i v^j + g^{ij} P \\ v^j H_{total} }\right]$<br>
<br>

Flux derivative wrt primitives:<br>

$\frac{\partial F^{Ij}}{\partial W^M} = \downarrow I \overset{\rightarrow M}{ \left[\matrix{
	v^j & \rho \delta^j_m & 0 \\
	v^i v^j & \rho (v^j \delta^i_m + v^i \delta^j_m) & g^{ij} \\
	\frac{1}{2} v^j v^2 & \delta^j_m H_{total} + \rho v^j v_m & \frac{\gamma}{\tilde{\gamma}} v^j
}\right] }$<br>
<br>

Euler fluid equations, curved geometry:<br>
<br>

$U^I + {F^{Ij}}_{;j} = 0$<br>
<br>

$\rho_{,t} + (\rho v^j)_{;j} = 0$<br>
$(\rho v^i)_{,t} + (\rho v^i v^j + g^{ij} P)_{;j} = 0$<br>
$E_{total,t} + (v^j H_{total})_{;j} = 0$<br>
<br>

$\rho_{,t} + (\rho v^j)_{;j} = 0$<br>
$(\rho v^i)_{,t} + (\rho v^i v^j)_{;j} + g^{ij} P_{,j} = 0$<br>
$E_{total,t} + (v^j H_{total})_{;j} = 0$<br>
<br>

$\rho_{,t} + (\rho v^j)_{,j} + {\Gamma^j}_{kj} \rho v^k = 0$<br>
$(\rho v^i)_{,t} + (\rho v^i v^j)_{,j} + g^{ij} P_{,j} + {\Gamma^i}_{kj} \rho v^k v^j + {\Gamma^j}_{kj} \rho v^i v^k = 0$<br>
$E_{total,t} + (v^j H_{total})_{,j} + {\Gamma^j}_{kj} v^k H_{total} = 0$<br>
<br>

$\rho_{,t} + \rho_{,j} v^j + \rho {v^j}_{,j} = -{\Gamma^j}_{kj} \rho v^k$<br>
$(\rho v^i)_{,t} + \rho_{,j} v^i v^j + \rho {v^i}_{,j} v^j + \rho v^i {v^j}_{,j} + g^{ij} P_{,j} = -{\Gamma^i}_{kj} \rho v^k v^j - {\Gamma^j}_{kj} \rho v^i v^k$<br>
$E_{total,t} + {v^j}_{,j} H_{total} + v^j (\frac{1}{2} \rho_{,j} v^2 + \rho v_k {v^k}_{,j} + \frac{\gamma}{\tilde\gamma} P_{,j}) = -{\Gamma^j}_{kj} v^k H_{total}$<br>
<br>

$\left[\matrix{
	\rho \\ \rho v^i \\ E_{total} 
}\right]_{,t}
+ \left[\matrix{
	v^j &
		\rho \delta^j_m &
		0 \\
	v^i v^j &
		\rho ( v^j \delta^i_m + v^i \delta^j_m ) &
		g^{ij} \\
	\frac{1}{2} v^j v^2 &
		\delta^j_m H_{total} + \rho v^j v_m &
		\frac{\gamma}{\tilde\gamma} v^j
}\right]
\left[\matrix{
	\rho \\ v^m \\ P
}\right]_{,j} = \left[\matrix{
	-{\Gamma^j}_{kj} \rho v^k \\
	-{\Gamma^i}_{kj} \rho v^k v^j - {\Gamma^j}_{kj} \rho v^i v^k \\
	-{\Gamma^j}_{kj} v^k H_{total}
}\right]$<br>
<br>

$\left[\matrix{
	\rho \\ \rho v^i \\ E_{total} 
}\right]_{,t}
+ \left[\matrix{
	v^j &
		\rho \delta^j_m &
		0 \\
	v^i v^j &
		\rho ( v^j \delta^i_m + v^i \delta^j_m ) &
		g^{ij} \\
	\frac{1}{2} v^j v^2 &
		\delta^j_m H_{total} + \rho v^j v_m &
		\frac{\gamma}{\tilde\gamma} v^j
}\right]
\left[\matrix{
	1 & 0 & 0 \\
	-v^m / \rho & \delta^m_k / \rho & 0 \\
	\frac{1}{2} \tilde\gamma v^2 & -\tilde\gamma v_k & \tilde\gamma
}\right]
\left[\matrix{
	\rho \\ \rho v_k \\ E_{total}
}\right]_{,j} = \left[\matrix{
	-{\Gamma^j}_{kj} \rho v^k \\
	-{\Gamma^i}_{kj} \rho v^k v^j - {\Gamma^j}_{kj} \rho v^i v^k \\
	-{\Gamma^j}_{kj} v^k H_{total}
}\right]$<br>
<br>


$\left[\matrix{
	\rho \\ \rho v^i \\ E_{total} 
}\right]_{,t}
+ \left[\matrix{
	0 &
		\delta^j_k &
		0 \\
	-v^i v^j + \frac{1}{2} g^{ij} \tilde\gamma v^2 &
		\delta^i_k v^j + \delta^j_k v^i - g^{ij} \tilde\gamma v_k &
		g^{ij} \tilde\gamma \\
	v^j (\frac{1}{2} \tilde\gamma v^2 - h_{total}) &
		-\tilde\gamma v^j v_k + \delta^j_k h_{total} &
		\gamma v^j
}\right]
\left[\matrix{
	\rho \\ \rho v^k \\ E_{total} 
}\right]_{,j} = \left[\matrix{
	-{\Gamma^j}_{kj} \rho v^k \\
	-{\Gamma^i}_{kj} \rho v^k v^j - {\Gamma^j}_{kj} \rho v^i v^k \\
	-{\Gamma^j}_{kj} v^k H_{total}
}\right]$<br>
<br>

Now if you choose to reabsorb the metric volume gradient into the flux:<br>

$\left[\matrix{
	\rho \\ \rho v^i \\ E_{total} 
}\right]_{,t}
+ \frac{\sqrt{g}}{\sqrt{g}}
\left[\matrix{
	0 &
		\delta^j_k &
		0 \\
	-v^i v^j + \frac{1}{2} g^{ij} \tilde\gamma v^2 &
		\delta^i_k v^j + \delta^j_k v^i - g^{ij} \tilde\gamma v_k &
		g^{ij} \tilde\gamma \\
	v^j (\frac{1}{2} \tilde\gamma v^2 - h_{total}) &
		-\tilde\gamma v^j v_k + \delta^j_k h_{total} &
		\gamma v^j
}\right]
\left[\matrix{
	\rho \\ \rho v^k \\ E_{total} 
}\right]_{,j} = \left[\matrix{
	-\frac{1}{\sqrt{g}} (\sqrt{g})_{,k} \rho v^k \\
	-{\Gamma^i}_{kj} \rho v^k v^j - \frac{1}{\sqrt{g}} (\sqrt{g})_{,k} (\rho v^i v^k + P g^{ik}) + {\Gamma^j}_{kj} P g^{ik} \\
	-\frac{1}{\sqrt{g}} (\sqrt{g})_{,k} v^k H_{total}
}\right]$<br>
<br>

$\left[\matrix{
	\rho \\ \rho v^i \\ E_{total} 
}\right]_{,t}
+ \frac{\sqrt{g}}{\sqrt{g}}
\left[\matrix{
	0 &
		\delta^j_k &
		0 \\
	-v^i v^j + \frac{1}{2} g^{ij} \tilde\gamma v^2 &
		\delta^i_k v^j + \delta^j_k v^i - g^{ij} \tilde\gamma v_k &
		g^{ij} \tilde\gamma \\
	v^j (\frac{1}{2} \tilde\gamma v^2 - h_{total}) &
		-\tilde\gamma v^j v_k + \delta^j_k h_{total} &
		\gamma v^j
}\right]
\left[\matrix{
	\rho \\ \rho v^k \\ E_{total} 
}\right]_{,j} 

+ \frac{1}{\sqrt{g}} (\sqrt{g})_{,j} 
\left[\matrix{
	\rho v^j \\
	\rho v^i v^j + P g^{ij} \\
	v^j H_{total}
}\right]

= \left[\matrix{
	0 \\ 
	-{\Gamma^i}_{kj} (\rho v^k v^j - P g^{jk}) \\ 
	0
}\right]$<br>
<br>


$\left[\matrix{
	\rho \\ \rho v^i \\ E_{total} 
}\right]_{,t}
+ 
\frac{1}{\sqrt{g}} \left( \sqrt{g}
\left[\matrix{
	0 &
		\delta^j_k &
		0 \\
	-v^i v^j + \frac{1}{2} g^{ij} \tilde\gamma v^2 &
		\delta^i_k v^j + \delta^j_k v^i - g^{ij} \tilde\gamma v_k &
		g^{ij} \tilde\gamma \\
	v^j (\frac{1}{2} \tilde\gamma v^2 - h_{total}) &
		-\tilde\gamma v^j v_k + \delta^j_k h_{total} &
		\gamma v^j
}\right]
\left[\matrix{
	\rho \\ \rho v^k \\ E_{total} 
}\right] \right)_{,j} = \left[\matrix{
	0 \\
	-{\Gamma^i}_{jk} (\rho v^j v^k - P g^{jk}) \\
	0
}\right]$<br>
<br>



Maxima has a much harder time calculating the eigenvalues/vectors with those $\delta^{ij}$'s replaced with $g^{ij}$'s.<br>
But I can get around that by using acoustic tensor to find the eigen-decomposition of the flux in curved coordinates:<br>
<br>

$\frac{\partial W^N}{\partial U^I} \cdot \frac{\partial F^{Ij}}{\partial W^M}$
$= \downarrow N \overset{\rightarrow I}{\left[\matrix{
	1 & 0 & 0 \\
	-v^n / \rho & \delta^n_i / \rho & 0 \\
	\frac{1}{2} \tilde\gamma v^2 & -\tilde\gamma v_i & \tilde\gamma
}\right]} \cdot \downarrow I \overset{\rightarrow M}{\left[\matrix{
	v^j & \rho \delta^j_m & 0 \\
	v^i v^j & \rho (v^j \delta^i_m + v^i \delta^j_m) & g^{ij} \\
	\frac{1}{2} v^j v^2 & \delta^j_m H_{total} + \rho v^j v_m & \frac{\gamma}{\tilde{\gamma}} v^j
}\right]}$
$= \downarrow N \overset{\rightarrow M}{\left[\matrix{
	v^j & \rho \delta^j_m & 0 \\
	0 & v^j \delta^n_m & g^{jn} / \rho \\
	0 & \delta^j_m \gamma P & v^j
}\right]}$
$= {A^{jN}}_M + v^j \delta^N_M$<br>
<br>
...for acoustic tensor:<br>
${A^{jN}}_M = \downarrow N \overset{\rightarrow M}{\left[\matrix{
	0 & \rho \delta^j_m & 0 \\
	0 & 0 & g^{jn} / \rho \\
	0 & \delta^j_m \gamma P & 0
}\right]}$<br>
<br>

Acoustic tensor eigen-decomposition:<br> 

${(\Lambda_{A^j})^I}_K = \downarrow I \overset{\rightarrow K}{ \left[\matrix{
	-c_s \sqrt{g^{jj}} & 0 & 0 \\
	0 & 0 & 0 \\
	0 & 0 & c_s \sqrt{g^{jj}}
}\right]}$<br>
<br>

${(V^R_{A^j})^I}_K = \downarrow I \overset{\rightarrow K}{ \left[\matrix{
	1 & \delta^j_k & 1 \\
	-\frac{c_s g^{ij}}{\rho \sqrt{g^{jj}}} & \frac{1}{\rho} (\delta^i_k - \delta^{ij} \delta_{jk}) & \frac{c_s g^{ij}}{\rho \sqrt{g^{jj}}} \\
	(c_s)^2 & 0 & (c_s)^2
}\right]}$<br>

${(V^L_{A^j} )^I}_K = \downarrow I \overset{\rightarrow K}{ \left[\matrix{
	0 & - \frac{\rho \delta^j_k}{2 c_s \sqrt{g^{jj}}} & \frac{1}{2 (c_s)^2} \\
	\delta^{ij} & \rho (\delta^i_k - \delta^j_k \frac{g^{ij}}{g^{jj}}) & -\frac{\delta^{ij}}{(c_s)^2} \\
	0 & \frac{\rho \delta^j_k}{2 c_s \sqrt{g^{jj}}} & \frac{1}{2 (c_s)^2}
}\right]}$<br>
<br>


...with some index notation summation abuse present, especially surrounding the $j$ index, and projecting out the $j$'th index from the $\delta^i_k$ in the middle.
I'll just write them out completely:<br>
<br>
eigenvalues, right eigenvectors, left eigenvectors:<br>

$\Lambda_{A^x} = \left[\matrix{
	-c_s \sqrt{g^{xx}} & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & c_s \sqrt{g^{xx}} 
}\right]$, 
$V^R_{A^x} = \left[\matrix{
	1 & 1 & 0 & 0 & 1 \\
	-\frac{c_s \sqrt{g^{xx}}}{\rho} & 0 & 0 & 0 & \frac{c_s \sqrt{g^{xx}}}{\rho} \\
	-\frac{c_s g^{xy}}{\rho \sqrt{g^{xx}}} & 0 & \frac{1}{\rho} & 0 & \frac{c_s g^{xy}}{\rho \sqrt{g^{xx}}} \\
	-\frac{c_s g^{xz}}{\rho \sqrt{g^{xx}}} & 0 & 0 & \frac{1}{\rho} & \frac{c_s g^{xz}}{\rho \sqrt{g^{xx}}} \\
	(c_s)^2 & 0 & 0 & 0 & (c_s)^2 
}\right]$
$V^L_{A^x} = \left[\matrix{
	0 & -\frac{\rho}{2 c_s \sqrt{g^{xx}}} & 0 & 0 & \frac{1}{2 (c_s)^2} \\
	1 & 0 & 0 & 0 & -\frac{1}{(c_s)^2} \\
	0 & -\rho \frac{g^{xy}}{g^{xx}} & \rho & 0 & 0 \\
	0 & -\rho \frac{g^{xz}}{g^{xx}} & 0 & \rho & 0 \\
	0 & \frac{\rho}{2 c_s \sqrt{g^{xx}}} & 0 & 0 & \frac{1}{2 (c_s)^2}
}\right]$
<br>

$\Lambda_{A^y} = \left[\matrix{
	-c_s \sqrt{g^{yy}} & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & c_s \sqrt{g^{yy}} 
}\right]$
$V^R_{A^y} = \left[\matrix{
	1 & 0 & 1 & 0 & 1 \\
	-\frac{c_s g^{yx}}{\rho \sqrt{g^{yy}}} & \frac{1}{\rho} & 0 & 0 & \frac{c_s g^{yx}}{\rho \sqrt{g^{yy}}} \\
	-\frac{c_s \sqrt{g^{yy}}}{\rho} & 0 & 0 & 0 & \frac{c_s \sqrt{g^{yy}}}{\rho} \\
	-\frac{c_s g^{yz}}{\rho \sqrt{g^{yy}}} & 0 & 0 & \frac{1}{\rho} & \frac{c_s g^{yz}}{\rho \sqrt{g^{yy}}} \\
	(c_s)^2 & 0 & 0 & 0 & (c_s)^2 
}\right]$
$V^L_{A^y} = \left[\matrix{
	0 & 0 & -\frac{\rho}{2 c_s \sqrt{g^{yy}}} & 0 & \frac{1}{2 (c_s)^2} \\
	0 & \rho & -\rho \frac{g^{yx}}{g^{yy}}  & 0 & 0 \\ 
	1 & 0 & 0 & 0 & -\frac{1}{(c_s)^2} \\
	0 & 0 & -\rho \frac{g^{yz}}{g^{yy}} & \rho & 0 \\
	0 & 0 & \frac{\rho}{2 c_s \sqrt{g^{yy}}} & 0 & \frac{1}{2 (c_s)^2}
}\right]$
<br>

$\Lambda_{A^z} = \left[\matrix{
	-c_s \sqrt{g^{zz}} & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & c_s \sqrt{g^{zz}} 
}\right]$
$V^R_{A^z} = \left[\matrix{
	1 & 0 & 0 & 1 & 1 \\
	-\frac{c_s g^{xz}}{\rho \sqrt{g^{zz}}} & \frac{1}{\rho} & 0 & 0 & \frac{c_s g^{xz}}{\rho \sqrt{g^{zz}}} \\
	-\frac{c_s g^{yz}}{\rho \sqrt{g^{zz}}} & 0 & \frac{1}{\rho} & 0 & \frac{c_s g^{yz}}{\rho \sqrt{g^{zz}}} \\
	-\frac{c_s \sqrt{g^{zz}}}{\rho} & 0 & 0 & 0 & \frac{c_s \sqrt{g^{zz}}}{\rho} \\
	(c_s)^2 & 0 & 0 & 0 & (c_s)^2 
}\right]$
$V^L_{A^z} = \left[\matrix{
	0 & 0 & 0 & -\frac{\rho}{2 c_s \sqrt{g^{zz}}} & \frac{1}{2 (c_s)^2} \\
	0 & \rho & 0 & -\rho \frac{g^{zx}}{g^{zz}} & 0 \\ 
	0 & 0 & \rho & -\rho \frac{g^{zy}}{g^{zz}} & 0 \\
	1 & 0 & 0 & 0 & -\frac{1}{(c_s)^2} \\
	0 & 0 & 0 & \frac{\rho}{2 c_s \sqrt{g^{zz}}} & \frac{1}{2 (c_s)^2}
}\right]$
<br>

Now $\frac{\partial F^{jI}}{\partial U^J}$
$ = \frac{\partial F^{jI}}{\partial W^K} \cdot \frac{\partial W^K}{\partial U^J}$
$ = \frac{\partial U}{\partial W} \frac{\partial W}{\partial U} \frac{\partial F}{\partial W} \frac{\partial W}{\partial U}$
$ = \frac{\partial U}{\partial W} (A + v^j I) \frac{\partial W}{\partial U}$<br>
<br>

The eigenvalues of $F$ are $A + v^j I = \left[\matrix{
	v^j - c_s \sqrt{g^{jj}} & 0 & 0 & 0 & 0 \\
	0 & v^j & 0 & 0 & 0 \\
	0 & 0 & v^j & 0 & 0 \\
	0 & 0 & 0 & v^j & 0 \\
	0 & 0 & 0 & 0 & v^j + c_s \sqrt{g^{jj}}
}\right]$<br>
<br>

The right eigenvectors of $F^j$ are ${(V^R_{F^j})^I}_M = \frac{\partial U^I}{\partial W^K} \cdot {(V^R_{A^j})^K}_M$<br>
<br>

$= \downarrow I \overset{\rightarrow K}{\left[\matrix{
	1 & 0 & 0 \\
	v^i & \rho \delta^i_k & 0 \\
	\frac{1}{2} v^2 & \rho v_k & 1/\tilde\gamma
}\right]} \cdot \downarrow K \overset{\rightarrow M}{ \left[\matrix{
	1 & \delta^j_m & 1 \\
	-\frac{c_s g^{kj}}{\rho \sqrt{g^{jj}}} & \frac{1}{\rho} (\delta^k_m - \delta^{kj} \delta_{jm}) & \frac{c_s g^{kj}}{\rho \sqrt{g^{jj}}} \\
	(c_s)^2 & 0 & (c_s)^2
}\right]}$
$ = \downarrow I \overset{\rightarrow M}{\left[\matrix{
	1 & \delta^j_m & 1 \\
	v^i - c_s g^{ij} / \sqrt{g^{jj}} &
		\delta^i_m + \delta^j_m (v^i  - \delta^{ij}) &
			v^i + c_s g^{ij} / \sqrt{g^{jj}} \\
	h_{total} - v^j c_s / \sqrt{g^{jj}} &
		\frac{1}{2} v^2 \delta^j_m + v_m (1 - \delta^j_m) &
			h_{total} + v^j c_s / \sqrt{g^{jj}}
}\right]}$<br>
<br>

The left eigenvectors of $F^j$ are ${(V^L_{F^j})^I}_M = V^L_{A^j} \cdot \frac{\partial W}{\partial U}$<br>
<br>

$= \downarrow I \overset{\rightarrow K}{ \left[\matrix{
	0 & - \frac{\rho \delta^j_k}{2 c_s \sqrt{g^{jj}}} & \frac{1}{2 (c_s)^2} \\
	\delta^{ij} & \rho (\delta^i_k - \delta^j_k \frac{g^{ij}}{g^{jj}}) & -\frac{\delta^{ij}}{(c_s)^2} \\
	0 & \frac{\rho \delta^j_k}{2 c_s \sqrt{g^{jj}}} & \frac{1}{2 (c_s)^2}
}\right]}
\cdot \downarrow K \overset{\rightarrow M}{ \left[\matrix{
	1 & 0 & 0 \\
	-v^k / \rho & \delta^k_m / \rho & 0 \\
	\frac{1}{2} \tilde\gamma v^2 & -\tilde\gamma v_m & \tilde\gamma
}\right]}$<br>

$= \frac{1}{2 (c_s)^2} \cdot \downarrow I \overset{\rightarrow M}{ \left[\matrix{
	\frac{1}{2} \tilde{\gamma} v^2 + c_s v^j / \sqrt{g^{jj}} &
		-\delta^j_m c_s / \sqrt{g^{jj}} -\tilde{\gamma} v_m &
			\tilde{\gamma} \\
	\delta^{ij} (2 (c_s)^2 - \tilde{\gamma} v^2) + 2 (c_s)^2 (v^j \frac{g^{ij}}{g^{jj}} - v^i) &
		2 (c_s)^2 (\delta^i_m - \delta^j_m \frac{g^{ij}}{g^{jj}}) + 2 \delta^{ij} \tilde{\gamma} v_m &
			-2 \delta^{ij} \tilde{\gamma} \\
	 \frac{1}{2} \tilde{\gamma} v^2 - c_s v^j / \sqrt{g^{jj}} &
		\delta^j_m c_s / \sqrt{g^{jj}} - \tilde{\gamma} v_m &
			\tilde{\gamma}
}\right]}$<br>

<br>

That's really ugly so I will write it out completely as well<br>
<br>
eigenvalues, right eigenvectors, left eigenvectors:<br>
<br>

$\Lambda_{F^x} = \left[\matrix{
	v^x - c_s \sqrt{g^{xx}} & 0 & 0 & 0 & 0 \\
	0 & v^x & 0 & 0 & 0 \\
	0 & 0 & v^x & 0 & 0 \\
	0 & 0 & 0 & v^x & 0 \\
	0 & 0 & 0 & 0 & v^x + c_s \sqrt{g^{xx}}
}\right]$

$V^R_{F^x} = \left[\matrix{
	1 & 1 & 0 & 0 & 1\\
	v^x- c_s \sqrt{g^{xx}} & v^x & 0 & 0 & v^x+ c_s \sqrt{g^{xx}}\\
	v^y-\frac{ c_s g^{xy}}{\sqrt{g^{xx}}} & v^y & 1 & 0 & v^y+\frac{ c_s g^{xy}}{\sqrt{g^{xx}}}\\
	v^z-\frac{ c_s g^{xz}}{\sqrt{g^{xx}}} & v^z & 0 & 1 & v^z+\frac{ c_s g^{xz}}{\sqrt{g^{xx}}}\\
	h_{total}-\frac{ c_s v^x}{\sqrt{g^{xx}}} & \frac{v^2}{2} & v_y & v_z & \frac{ c_s v^x}{\sqrt{g^{xx}}}+h_{total}
}\right]$	

$V^L_{F^x} = \left[\matrix{
	\frac{v^x}{2 c_s \sqrt{g^{xx}}}+\frac{\tilde{\gamma} v^2}{4{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_x}{2{{ c_s }^{2}}}-\frac{1}{2 c_s \sqrt{g^{xx}}} & -\frac{\tilde{\gamma} v_y}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_z}{2{{ c_s }^{2}}} & \frac{\tilde{\gamma}}{2{{ c_s }^{2}}}\\
	1-\frac{\tilde{\gamma} v^2}{2{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_x}{{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_y}{{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_z}{{{ c_s }^{2}}} & -\frac{\tilde{\gamma}}{{{ c_s }^{2}}}\\
	\frac{g^{xy} v^x}{g^{xx}}-v^y & -\frac{g^{xy}}{g^{xx}} & 1 & 0 & 0\\
	\frac{g^{xz} v^x}{g^{xx}}-v^z & -\frac{g^{xz}}{g^{xx}} & 0 & 1 & 0\\
	\frac{\tilde{\gamma} v^2}{4{{ c_s }^{2}}}-\frac{v^x}{2 c_s \sqrt{g^{xx}}} & -\frac{\tilde{\gamma} v_x}{2{{ c_s }^{2}}}+\frac{1}{2 c_s \sqrt{g^{xx}}} & -\frac{\tilde{\gamma} v_y}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_z}{2{{ c_s }^{2}}} & \frac{\tilde{\gamma}}{2{{ c_s }^{2}}}
}\right]$

<br>

$\Lambda_{F^y} = \left[\matrix{
	v^y - c_s \sqrt{g^{yy}} & 0 & 0 & 0 & 0 \\
	0 & v^y & 0 & 0 & 0 \\
	0 & 0 & v^y & 0 & 0 \\
	0 & 0 & 0 & v^y & 0 \\
	0 & 0 & 0 & 0 & v^y + c_s \sqrt{g^{yy}}
}\right]$

$V^R_{F^y} = \left[\matrix{
	1 & 0 & 1 & 0 & 1\\
	v^x-\frac{ c_s g^{xy}}{\sqrt{g^{yy}}} & 1 & v^x & 0 & v^x+\frac{ c_s g^{xy}}{\sqrt{g^{yy}}}\\
	v^y- c_s \sqrt{g^{yy}} & 0 & v^y & 0 & v^y+ c_s \sqrt{g^{yy}}\\
	v^z-\frac{ c_s g^{yz}}{\sqrt{g^{yy}}} & 0 & v^z & 1 & v^z+\frac{ c_s g^{yz}}{\sqrt{g^{yy}}}\\
	h_{total}-\frac{ c_s v^y}{\sqrt{g^{yy}}} & v_x & \frac{v^2}{2} & v_z & \frac{ c_s v^y}{\sqrt{g^{yy}}}+h_{total}
}\right]$

$V^L_{F^y} = \left[\matrix{
	\frac{v^y}{2 c_s \sqrt{g^{yy}}}+\frac{\tilde{\gamma} v^2}{4{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_x}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_y}{2{{ c_s }^{2}}}-\frac{1}{2 c_s \sqrt{g^{yy}}} & -\frac{\tilde{\gamma} v_z}{2{{ c_s }^{2}}} & \frac{\tilde{\gamma}}{2{{ c_s }^{2}}}\\
	\frac{g^{xy} v^y}{g^{yy}}-v^x & 1 & -\frac{g^{xy}}{g^{yy}} & 0 & 0\\
	1-\frac{\tilde{\gamma} v^2}{2{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_x}{{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_y}{{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_z}{{{ c_s }^{2}}} & -\frac{\tilde{\gamma}}{{{ c_s }^{2}}}\\
	\frac{g^{yz} v^y}{g^{yy}}-v^z & 0 & -\frac{g^{yz}}{g^{yy}} & 1 & 0\\
	\frac{\tilde{\gamma} v^2}{4{{ c_s }^{2}}}-\frac{v^y}{2 c_s \sqrt{g^{yy}}} & -\frac{\tilde{\gamma} v_x}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_y}{2{{ c_s }^{2}}}+\frac{1}{2 c_s \sqrt{g^{yy}}} & -\frac{\tilde{\gamma} v_z}{2{{ c_s }^{2}}} & \frac{\tilde{\gamma}}{2{{ c_s }^{2}}}
}\right]$

<br>

$\Lambda_{F^z} = \left[\matrix{
	v^z - c_s \sqrt{g^{zz}} & 0 & 0 & 0 & 0 \\
	0 & v^z & 0 & 0 & 0 \\
	0 & 0 & v^z & 0 & 0 \\
	0 & 0 & 0 & v^z & 0 \\
	0 & 0 & 0 & 0 & v^z + c_s \sqrt{g^{zz}}
}\right]$

$V^R_{F^z} = \left[\matrix{
	1 & 0 & 0 & 1 & 1\\
	v^x-\frac{ c_s g^{xz}}{\sqrt{g^{zz}}} & 1 & 0 & v^x & v^x+\frac{ c_s g^{xz}}{\sqrt{g^{zz}}}\\
	v^y-\frac{ c_s g^{yz}}{\sqrt{g^{zz}}} & 0 & 1 & v^y & v^y+\frac{ c_s g^{yz}}{\sqrt{g^{zz}}}\\
	v^z- c_s \sqrt{g^{zz}} & 0 & 0 & v^z & v^z+ c_s \sqrt{g^{zz}}\\
	h_{total}-\frac{ c_s v^z}{\sqrt{g^{zz}}} & v_x & v_y & \frac{v^2}{2} & \frac{ c_s v^z}{\sqrt{g^{zz}}}+h_{total}
}\right]$

$V^L_{F^z} = \left[\matrix{
	\frac{v^z}{2 c_s \sqrt{g^{zz}}}+\frac{\tilde{\gamma} v^2}{4{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_x}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_y}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_z}{2{{ c_s }^{2}}}-\frac{1}{2 c_s \sqrt{g^{zz}}} & \frac{\tilde{\gamma}}{2{{ c_s }^{2}}}\\
	\frac{g^{xz} v^z}{g^{zz}}-v^x & 1 & 0 & -\frac{g^{xz}}{g^{zz}} & 0\\
	\frac{g^{yz} v^z}{g^{zz}}-v^y & 0 & 1 & -\frac{g^{yz}}{g^{zz}} & 0\\
	1-\frac{\tilde{\gamma} v^2}{2{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_x}{{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_y}{{{ c_s }^{2}}} & \frac{\tilde{\gamma} v_z}{{{ c_s }^{2}}} & -\frac{\tilde{\gamma}}{{{ c_s }^{2}}}\\
	\frac{\tilde{\gamma} v^2}{4{{ c_s }^{2}}}-\frac{v^z}{2 c_s \sqrt{g^{zz}}} & -\frac{\tilde{\gamma} v_x}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_y}{2{{ c_s }^{2}}} & -\frac{\tilde{\gamma} v_z}{2{{ c_s }^{2}}}+\frac{1}{2 c_s \sqrt{g^{zz}}} & \frac{\tilde{\gamma}}{2{{ c_s }^{2}}}
}\right]$

<br>

<hr>


This source: <a href='https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19870019781.pdf'>https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19870019781.pdf</a>
gets around that by using the covariant form of the momentum in the state vector:<br>
What's the advantage of this?  By putting $v_i$ on the same variance as $P_{,i}$, we remove the extra $g^{ij}$ from the flux matrix.<br> 
However we replace it with a $g_{ij,k}$ source term (which the paper calls a "coriolis force").<br> 
<br>

$\rho_{,t} + (\rho v^j)_{;j} = 0$<br>
$(\rho v_i)_{,t} + (\rho v_i v^j + \delta_i^j P)_{;j} = 0$<br>
$E_{total,t} + (v^j H_{total})_{;j} = 0$<br>
<br>

$\rho_{,t} + (\rho v^j)_{;j} = 0$<br>
$(\rho v_i)_{,t} + (\rho v_i v^j)_{;j} + \delta_i^j P_{,j} = 0$<br>
$E_{total,t} + (v^j H_{total})_{;j} = 0$<br>
<br>

$\rho_{,t} + (\rho v^j)_{,j} + {\Gamma^j}_{kj} \rho v^k = 0$<br>
$(\rho v_i)_{,t} + (\rho v_i v^j)_{,j} + \delta_i^j P_{,j} - {\Gamma^k}_{ij} \rho v_k v^j + {\Gamma^j}_{kj} \rho v_i v^k = 0$<br>
$E_{total,t} + (v^j H_{total})_{,j} + {\Gamma^j}_{kj} v^k H_{total} = 0$<br>
<br>

$\rho_{,t} + \frac{\sqrt{g}}{\sqrt{g}} (\rho v^j)_{,j} + \frac{1}{\sqrt{g}} (\sqrt{g})_{,k} \rho v^k = 0$<br>
$(\rho v_i)_{,t} 
	+ \frac{\sqrt{g}}{\sqrt{g}} (\rho v_i v^j)_{,j} 
	+ \frac{\sqrt{g}}{\sqrt{g}} \delta_i^j P_{,j} 
	- {\Gamma^k}_{ij} \rho v_k v^j 
	+ \frac{1}{\sqrt{g}} (\sqrt{g})_{,k} \rho v_i v^k 
	= 0$<br>
$E_{total,t} + \frac{\sqrt{g}}{\sqrt{g}} (v^j H_{total})_{,j} + \frac{1}{\sqrt{g}} (\sqrt{g})_{,k} v^k H_{total} = 0$<br>
<br>

$\rho_{,t} + \frac{1}{\sqrt{g}} (\sqrt{g} \rho v^j)_{,j} = 0$<br>
$(\rho v_i)_{,t} 
	+ \frac{1}{\sqrt{g}} (\sqrt{g} \rho v_i v^j)_{,j} 
	+ \frac{1}{\sqrt{g}} (\sqrt{g} \delta_i^j P)_{,j}
	- \frac{1}{\sqrt{g}} (\sqrt{g})_{,j} \delta^j_i P
	- {\Gamma^k}_{ij} \rho v_k v^j 
	= 0$<br>
$E_{total,t} + \frac{1}{\sqrt{g}} (\sqrt{g} v^j H_{total})_{,j} = 0$<br>
<br>

$\rho_{,t} + \frac{1}{\sqrt{g}} (\sqrt{g} \rho v^j)_{,j} = 0$<br>
$(\rho v_i)_{,t} 
	+ \frac{1}{\sqrt{g}} (\sqrt{g} (\rho v_i v^j + \delta_i^j P))_{,j} 
	= \Gamma_{kji} \rho v^j v^k
	+ \frac{1}{\sqrt{g}} (\sqrt{g})_{,j} \delta^j_i P
	$<br>
$E_{total,t} + \frac{1}{\sqrt{g}} (\sqrt{g} v^j H_{total})_{,j} = 0$<br>
<br>

$\rho v^j v^k \Gamma_{kj,i} = \frac{1}{2} \rho v^j v^k (g_{kj,i} + g_{ki,j} - g_{ji,k}) = \frac{1}{2} \rho v^j v^k g_{jk,i}$<br>
and $(\sqrt{g})_{,j} = \frac{1}{2 \sqrt{g}} g_{,j} = \frac{1}{2\sqrt{g}} g g^{jk} g_{jk,i} = \frac{1}{2} \sqrt{g} g^{jk} g_{jk,i}$ using the Jacobi's formula.<br>
so $\frac{1}{\sqrt{g}} (\sqrt{g})_{,j} P = \frac{1}{2} g^{jk} g_{jk,i} P$<br>
<br>

$\rho_{,t} + \frac{1}{\sqrt{g}} (\sqrt{g} \rho v^j)_{,j} = 0$<br>
$(\rho v_i)_{,t} 
	+ \frac{1}{\sqrt{g}} (\sqrt{g} (\rho v_i v^j + \delta_i^j P))_{,j} 
	= \frac{1}{2} g_{jk,i} (\rho v^j v^k + g^{jk} P)$<br>
$E_{total,t} + \frac{1}{\sqrt{g}} (\sqrt{g} v^j H_{total})_{,j} = 0$<br>
<br>

So now that there is a $\sqrt{g}$ inside the flux term, where does it go in the eigen decomposition?<br>
I'm also tempted to not use this because Font' descriptions of relativistic Euler equations keeps the velocity in contravariant form.<br>
And to boot, it doesn't provide eigen-decomposition...<br>

	</body>
</html>
