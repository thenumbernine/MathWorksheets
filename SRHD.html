<!doctype html>
<html>
	<head>
        <meta charset="UTF-8">
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
		<title>SRHD</title>
	</head>
	<body onload='tryToFindMathJax();'>
<h3>SRHD</h3>

<b>Derivation:</b><br>
for physical derivation:<br>
2008 Font "Numerical Hydrodynamics and Magnetohydrodynamics in General Relativity"<br>
<br>

<b>relativisitc metric</b><br>
$g_{\mu\nu}$ = metric tensor.<br>
ADM metric:<br>
lapse: $ \alpha $<br>
shift spatial components: $ \beta^i $<br>
spatial metric spatial components: $ \gamma_{ij} $<br>
$||g_{\mu\nu}|| = \overset{\mu(i)\downarrow\nu(j)\rightarrow}{\left[ \matrix{-\alpha^2 + \beta_k \beta^k & \beta_j \\ \beta_i & \gamma_{ij}} \right]}$<br>
$||g^{\mu\nu}|| = \overset{\mu(i)\downarrow\nu(j)\rightarrow}{\left[ \matrix{-1/\alpha^2 & \beta^j / \alpha^2 \\ \beta^i / \alpha^2 & \gamma^{ij} - \beta^i \beta^j / \alpha^2} \right]}$<br>
where $\beta_j = \gamma_{ij} \beta^i = \gamma_{\mu j} \beta^\mu = g_{\mu j} \beta^j $ courtesy of the fact that $ g_{ij} = \gamma_{ij} $ and $ \beta^t = 0 $.<br>
ADM metric determinant: $ g = \alpha \sqrt{\gamma} $<br>
ADM spatial metric determinant: $ \gamma = det||\gamma_{ij}||$<br>
normal in the ADM metric:<br>
$n_\mu = \overset{\mu(j)\rightarrow}{\left[ \matrix{ -\alpha & 0 } \right]} $<br>
$n^\mu = \overset{\mu(i)\downarrow}{\left[ \matrix{ 1/\alpha \\ -\beta^i/\alpha } \right]} $<br>
For SR the metric is set to $g_{\mu\nu} = \eta_{\mu\nu} = diag(-1,1,1,1)$<br>
so $\alpha = 1$ and $\beta^i = 0$ and $\gamma_{ij} = \delta_{ij} = diag(1,1,1)$<br>
<br>

<b>some more variables</b><br>
$\rho$ = rest-mass density<br>
$u^\mu$ = 4-velocity<br>
$v^i$ = Newtonian velocity<br>
$\epsilon$ = specific internal energy<br>
<br>

<b>current of rest-mass</b><br>
$J^\mu = \rho u^\mu$ = current of rest-mass<br>
$\nabla_\mu J^\mu = 0$ shows current of rest-mass is conserved<br>
<br>

<b>pressure</b><br>
$p$ = rest-mass pressure<br>
equation of state:<br>
$p = p(\rho, \epsilon)$<br>
pressure for ideal gas:<br>
$\gamma$ = heat capacity ratio<br>
$p = (\gamma - 1) \rho \epsilon$<br>
<br>

<b>enthalpy</b><br>
In non-relativistic case:<br>
$h = \epsilon + p / \rho$<br>
<a href='https://en.wikipedia.org/wiki/Relativistic_Euler_equations'>this page</a> (which doesn't cite its sources) says:<br>
$\epsilon$ = the rest-mass specific internal energy<br>
$\rho \epsilon_R = \rho c^2 + \rho \epsilon$, for $\epsilon_R$ = the relativistic specific internal energy<br>
In the relativistic case:<br>
$h = \epsilon_R + p / \rho = c^2 + \epsilon + p / \rho$<br>
Note that this source says the speed of sound $c_s = \frac{\partial p}{\partial e_R}$ while my SRHD sources say $c_s = \frac{\partial p}{\partial e}$<br>
rest-mass internal specific enthalpy:<br>
$h = 1 + \epsilon + p / \rho$<br>
<br>

<b>stress-energy tensor</b><br>
$T^{\mu\nu}$ = stress-energy / energy-momentum tensor<br>
$\nabla_\mu T^{\mu\nu} = 0$ shows stress-energy is conserved<br>
$T^{\mu\nu} = \rho h u^\mu u^\nu + p g^{\mu\nu}$ = definition of stress-energy tensor for perfect fluids<br>
(This is also given in plenty of other sources, M.T.W., Alcubierre, Baumgarte &amp; Shapiro, etc.)<br>
<br>

<b>speed of sound</b><br>
$\chi = \partial p / \partial \rho |_\epsilon$<br>
$\kappa = \partial p / \partial \epsilon |_\rho$<br>
$h c_s^2 = \chi + p/\rho^2 \kappa$<br>
<br>

<!--
<b>3-velocity</b><br>
Lorentz factor:<br>
$W = -u^\mu n_\mu = u^0$ for SR<br>
$W = 1/\sqrt{1 - v^2}$ by the definition of Lorentz-boosted 4-velocity<br>
$v^i = -u^i / u^\mu n_\mu = u^i / u^0$ for SR<br>
<br>
-->
<b>relativistic Lorentz factor</b><br>
Let $v^i$ be our spatial velocity, related to $u^i$ by $v^i = \frac{u^i}{\alpha u^t} + \frac{\beta^i}{\alpha}$<br>
Let $W = \alpha u^t = 1/\sqrt{1 - v^i v^j \gamma_{ij}}$<br>
<br>

<b>primitive variables</b><br>
$W_I = \downarrow I \left[\matrix{\rho \\ v_i \\ \epsilon}\right]$ = primitive variables<br>
<br>

<b>conservative variables</b><br>
These variables appear just as they do in the non-relativistic Euler fluid equations, however $\rho$ is now densitized by $W$, and $S^i$ and $\tau$ are now densitized by an additional $h W$<br>
$D = -J^\mu n_\mu = \alpha J^0 = \alpha \rho u^0 = \rho W$ = relativistic density<br>
$S^i = -T^{\mu i} n_\mu = \alpha T^{0i} = \alpha (\rho h u^0 u^i + p g^{0i}) = \rho h W^2 v^i $ = relativistic momentum<br>
$E = T^{\mu\nu} n_\mu n_\nu = \alpha^2 T^{00} = \alpha^2 (\rho h (u^0)^2 + p g^{00}) = \rho h W^2 - p$ = relativistic total energy density<br>
$\tau = E - D = \rho h W^2 - p - D$ = relativistic total energy density minus rest-mass density<br>
<br>

$U_I = \downarrow I \left[\matrix{D \\ S_i \\ \tau }\right]$ = conservative variables<br>
<br>

$F_{Ij} = \downarrow I \left[\matrix{D v_j \\ S_i v_j - \delta_{ij} p \\ S_j - D v_j}\right]$ = flux vector<br>
<br>

$\partial_\rho$:<br>
$P_{,\rho} = (\gamma - 1) \epsilon$<br>
$h_{,\rho} = P_{,\rho} / \rho - p / \rho^2 = ((\gamma - 1) \rho \epsilon - p) / \rho^2 = 0$<br> 
$D_{,\rho} = W$<br>
$S_{i,\rho} = h W^2 v_i$<br>
$\tau_{,\rho} = h W^2 - P_{,\rho} - D_{,\rho} = h W^2 - (\gamma - 1) \epsilon - W = W (h W - 1) - (\gamma - 1)$<br>
<br>

$\partial_{v_k}$:<br>
$W_{,v_k} = \partial_{v_k} (\sqrt{1-v^2})^{-1} = -\frac{1}{2} (\sqrt{1-v^2})^{-3} \cdot -2 v_k = \frac{v_k}{(\sqrt{1-v^2})^3} = v_k W^3$<br>
$D_{,v_k} = \rho W_{,v_k} = \rho W^3 v_k = W S_k / h$<br>
$S_{i,v_k} = \rho h (2 W W_{,v_k} v_i + W^2 \delta_{ik}) = \rho h W^4 (v_i v_k + \delta_{ik})$<br>
$\tau_{,v_k} = \rho h 2 W W_{,v_k} - D_{,v_k} = 2 \rho h W^4 v_k - \rho W^3 v_k = \rho W^3 v_k (2 h W - 1)$<br>
<br>

$\partial_{,\epsilon}$:<br>
$P_{,\epsilon} = (\gamma - 1) \rho$<br>
$h_{,\epsilon} = 1 + P_{,\epsilon} / \rho = 1 + \gamma - 1 = \gamma$<br>
$S_{i,\epsilon} = \rho W^2 v_i h_{,\epsilon} = \gamma \rho W^2 v_i = \gamma S_i / h$<br>
$\tau_{,\epsilon} = \rho h_{,\epsilon} W^2 - P_{,\epsilon} = \gamma \rho W^2 - (\gamma - 1) \rho = \rho (\gamma (W^2 - 1) + 1)$<br>
<br>

<b>change in conserved variables wrt primitive variables:</b><br>

$\frac{\partial U_I}{\partial W_J} = \downarrow I \overset{ \rightarrow J }{ \left[\matrix{
	D_{,\rho}		& D_{,v_j}		& D_{,\epsilon}		\\
	S_{i,\rho}		& S_{i,v_j}	& 	S_{i,\epsilon}	\\
	\tau_{,\rho}	& \tau_{,v_j}	& \tau_{,\epsilon}
}\right] }$<br>
<br>

$\frac{\partial U_I}{\partial W_J} = \downarrow I \overset{ \rightarrow J }{ \left[\matrix{
	W &
	 \rho W^3 v_j &
	 0 \\
	h W^2 v_i &
	 \rho h W^2 (2 W^2 v_i v_j + \delta_{ij}) &
	 \gamma \rho W^2 v_i \\
	W (h W - 1) - (\gamma - 1) &
	 \rho W^3 v_j (2 h W - 1) &
	 \rho (\gamma W^2 - (\gamma - 1))
}\right] }$<br>
<br>

<b>change in primitive variables wrt conserved variables:</b><br>

$\frac{\partial W_J}{\partial U_I} = [\frac{\partial U_I}{\partial W_J}]^{-1}$<br>
<br>

<b>change in flux wrt primitive variables:</b><br>

$\frac{\partial F_{Ij}}{\partial W_K} = \downarrow I \overset{ \rightarrow K }{ \left[\matrix{
	D_{,\rho} v_j &
	 D_{,v_k} v_j + D \delta_{jk} &
	 0 \\
	S_{i,\rho} v_j - \delta_{ij} P_{,\rho} &
	 S_{i,v_k} v_j + S_i \delta_{jk} &
	 S_{i,\epsilon} v_j - \delta_{ij} P_{,\epsilon} \\
	S_{j,\rho} - D_{,\rho} v_j &
	 S_{j,v_k} - D_{,v_k} v_j - D \delta_{jk} &
	 S_{j,\epsilon}
}\right] }$<br>
<br>

$\frac{\partial F_{Ij}}{\partial W_K} = \downarrow I \overset{ \rightarrow K }{ \left[\matrix{
	W v_j &
	 \rho W^3 v_k v_j + D \delta_{jk} &
	 0 \\
	h W^2 v_i v_j - \delta_{ij} (\gamma - 1) \epsilon &
	 \rho h W^2 (2 W^2 v_i v_k + \delta_{ik}) v_j + S_i \delta_{jk} &
	 \gamma \rho W^2 v_i v_j - \delta_{ij} (\gamma - 1) \rho \\
	h W^2 v_j - W v_j &
	 \rho h W^2 (2 W^2 v_j v_k + \delta_{jk}) - \rho W^3 v_k v_j - D \delta_{jk} &
	 \gamma \rho W^2 v_j
}\right] }$<br>
<br>

$\frac{\partial F_{Ij}}{\partial W_K} = \downarrow I \overset{ \rightarrow K }{ \left[\matrix{
	W v_j &
	 D (W^2 v_j v_k + \delta_{jk}) &
	 0 \\
	h W^2 v_i v_j - \delta_{ij} (\gamma - 1) \epsilon &
	 \rho h W^2 (2 W^2 v_i v_k + \delta_{ik}) v_j + S_i \delta_{jk} &
	 \gamma \rho W^2 v_i v_j - \delta_{ij} (\gamma - 1) \rho \\
	(h W - 1) W v_j &
	 \rho h W^2 (2 W^2 v_j v_k + \delta_{jk}) - D (W^2 v_j v_k + \delta_{jk}) &
	 \gamma \rho W^2 v_j
}\right] }$<br>
<br>

<b>acoustic matrix</b><br>
<br>

$\frac{\partial W_I}{\partial U_L} \frac{\partial F_{Lj}}{\partial U_M} \frac{\partial U_M}{\partial W_K}$<br>
...<br>
$= A_{IjK} + \delta_{IK} v_j$<br>
<br>

<b>change in flux wrt conservative variables:</b><br>

$\frac{\partial F_{Ij}}{\partial U_L} = \downarrow I \overset{ \rightarrow K }{ \left[\matrix{
	W v_j &
	 D (W^2 v_j v_k + \delta_{jk}) &
	 0 \\
	h W^2 v_i v_j - \delta_{ij} (\gamma - 1) \epsilon &
	 \rho h W^2 (2 W^2 v_i v_k + \delta_{ik}) v_j + S_i \delta_{jk} &
	 \gamma \rho W^2 v_i v_j - \delta_{ij} (\gamma - 1) \rho \\
	(h W - 1) W v_j &
	 \rho h W^2 (2 W^2 v_j v_k + \delta_{jk}) - D (W^2 v_j v_k + \delta_{jk}) &
	 \gamma \rho W^2 v_j
}\right] }
\cdot
\downarrow K \overset{ \rightarrow L }{ \left[\matrix{
	W &
	 \rho W^3 v_l &
	 0 \\
	h W^2 v_k &
	 \rho h W^2 (2 W^2 v_k v_l + \delta_{kl}) &
	 \gamma \rho W^2 v_k \\
	W (h W - 1) - (\gamma - 1) &
	 \rho W^3 v_l (2 h W - 1) &
	 \rho (\gamma W^2 - (\gamma - 1))
}\right]^{-1} }$<br>

<h3>Recovering Primitives</h3>
Every source, Alcubierre 2008, Marti &amp; Muller 2008, etc, all say the same exact thing.<br>
Except the Mara code uses a paper by Anton &amp; Zanotti <a href='http://arxiv.org/pdf/astro-ph/0506063v1.pdf'>http://arxiv.org/pdf/astro-ph/0506063v1.pdf</a>.<br>

	</body>
</html>
