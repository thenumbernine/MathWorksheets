<!doctype html>
<html>
	<head>
        <meta charset="utf-8">
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
		<title>Finite Volume Methods</title>
	</head>
	<body>

<h3>Finite Volume Methods</h3>

let $\mu$ span across all coordinates $t,x,y,z$<br>
let $i$ span all states of $U$<br>
$\partial_\mu F^{i\mu} = 0$<br>
separate space and time:<br>
$\partial_t F^{it} + \partial_{x^j} F^{ij} = 0$<br>
let $F^{it} = U^i$<br>
$\partial_t U^i + \partial_{x^j} F^{ij} = 0$<br>
integrate over a volume of spacetime $\Omega$<br>
$\int_\Omega \partial_\mu F^{i\mu} dx^4 = 0$<br>
apply the divergence theorem<br>
$\int_{\partial\Omega} F^{i\mu} n_\mu d\Sigma = 0$<br>
for $n_\mu$ being the spacetime normal<br>
assume the timelike top and bottom are flat (i.e. only vary in spatial dimensions)<br>
such that the lower timelike boundary $\partial\Omega_\tau^-$ (which is spatial) has constant time coordinate $t_1$ and constant normal $n_t = -1$ and $n_i = 0$<br>
and the upper timelike boundary $\partial\Omega_\tau^+$ (which is also spatial) has constant time coordinate $t_2$ and constant normal $n_t = 1$ and $n_i = 0$<br>
$\int_{\partial\Omega_\Sigma} F^{ij} n_j d\sigma + \int_{\partial\Omega_\tau^+} F^{it} (t_2) dx^3 - \int_{\partial\Omega_\tau^-} F^{it} (t_1) dx^3 = 0$<br>
substitute the definition of the timelike flux component $F^{it} = U^i$<br>
$\int_{\partial\Omega_\Sigma} F^{ij} n_j d\sigma + \int_{\partial\Omega_\tau^+} U^i(t_2) dx^3 - \int_{\partial\Omega_\tau^-} U^i(t_1) dx^3 = 0$<br>
assume that the cells never shrink or grow in size, so the timelike top and bottom are equal, i.e. $\partial\Omega_\tau^+ = \partial\Omega_\tau^- = \partial\Omega_\tau$<br>
$\int_{\partial\Omega_\Sigma} F^{ij} n_j d\sigma + \int_{\partial\Omega_\tau} U^i(t_2) dx^3 - \int_{\partial\Omega_\tau} U^i(t_1) dx^3 = 0$<br>
also assume $U^i$ does not vary spatially along the timelike top and bottom surfaces $\partial\Omega_\tau^+$ or $\partial\Omega_\tau^-$<br>
$\int_{\partial\Omega_\Sigma} F^{ij} n_j d\sigma + (U^i(t_2) - U^i(t_1)) \int_{\partial\Omega_\tau}  dx^3 = 0$<br>
$\int_{\partial\Omega_\Sigma} F^{ij} n_j d\sigma + (U^i(t_2) - U^i(t_1)) |\partial\Omega_\tau| = 0$<br>
Let $V$ be the spatial volume of the cell, such that $V = |\partial\Omega_\tau|$<br>
$\int_{\partial\Omega_\Sigma} F^{ij} n_j d\sigma + (U^i(t_2) - U^i(t_1)) V = 0$<br>
$(U^i(t_2) - U^i(t_1)) V = -\int_{\partial\Omega_\Sigma} F^{ij} n_j d\sigma$<br>
Represent the boundary $\Omega_\Sigma$ as the product of the spacelike component $\Omega_\sigma$ and timelike components $\Omega_\Sigma^t$<br>
Note that $\Omega_\Sigma^t$ is just the subset along the reals $[t_1, t_2]$<br>
$(U^i(t_2) - U^i(t_1)) V = -\int_{\partial\Omega_\Sigma^t} \int_{\partial\Omega_\sigma} F^{ij} n_j d\sigma dt$<br>
Assume that the flux $F^{ij}$ is constant with respect to time<br>
$(U^i(t_2) - U^i(t_1)) V = -\int_{\partial\Omega_\Sigma^t} dt \int_{\partial\Omega_\sigma} F^{ij} n_j d\sigma$<br>
Let $\Delta t = t_2 - t_1$<br>
$(U^i(t_2) - U^i(t_1)) V = -\Delta t \int_{\partial\Omega_\sigma} F^{ij} n_j d\sigma$<br>
${{U^i(t_2) - U^i(t_1)}\over{\Delta t}} = -{{\int_{\partial\Omega_\sigma} F^{ij} n_j d\sigma}\over{V}}$<br>
Let $\partial\Omega_\sigma$ be the sum of individual surfaces $\partial\Omega_\sigma^k$ each with normal $n^\sigma_{jk}$ the $k$th surface normal in the direction $x^j$<br> 
Let $F^{ij}$ remain constant along each surface<br>
${{U^i(t_2) - U^i(t_1)}\over{\Delta t}} = -{{ |\partial\Omega_\sigma^k| F^{ij} n^\sigma_{jk} }\over{V}}$<br>
Let $S_k = |\partial\Omega_\sigma^k|$ be the surface area of each spatial boundary portion<br>
${{U^i(t_2) - U^i(t_1)}\over{\Delta t}} = -{{ S_k F^{ij} n^\sigma_{jk} }\over{V}}$<br>
Assume we're using axis-aligned boundaries, and the span along the $i$th dimension is $\Delta x^i$<br>
The spacelike volume of the surface is given by $V = \Pi_{i=1}^n \Delta x^i$<br>
Each $k$th dimension has two surfaces, $S_k^+$ and $S_k^-$, both with area $\Pi_{i=1,i\ne k}^n \Delta x^i$<br>
$S_k^-$ has surface normal $n^{\sigma-}_{jk} = -\delta_{jk}$<br>
$S_k^+$ has surface normal $n^{\sigma+}_{jk} = \delta_{jk}$<br>
Let $x^{\sigma^\pm}$ represent any point on surface $S_k^\pm$, and let the flux $F^{ij}(x^{\sigma^\pm})$ be constant along the surface $S_k^\pm$<br>
${{U^i(t_2) - U^i(t_1)}\over{\Delta t}} = -{{\Pi_{m=1,m\ne k}^n \Delta x^m (F^{ij}(x^{\sigma^+}) \delta_{jk} + F^{ij}(x^{\sigma^-}) (-\delta_{jk})) }\over{\Pi_{m=1}^n \Delta x^m}}$<br>
${{U^i(t_2) - U^i(t_1)}\over{\Delta t}} = -{{\Pi_{m=1,m\ne k}^n \Delta x^m (F^{ik}(x^{\sigma^+}) - F^{ik}(x^{\sigma^-})) }\over{\Pi_{m=1}^n \Delta x^m}}$<br>
${{U^i(t_2) - U^i(t_1)}\over{\Delta t}} = -{{F^{ik}(x^{\sigma^+}) - F^{ik}(x^{\sigma^-}) }\over{\Delta x^k}}$<br>
Solve for $U^i(t_2)$<br>
$U^i(t_2) = U^i(t_1) - {{\Delta t}\over{\Delta x^j}}  (F^{ij}(x^{\sigma^+}) - F^{ij}(x^{\sigma^-}))$<br>
<br>
<br>
<br>

<b>same thing but curved space</b><br>
I'm going to put the $\mu$ as the first index for ease later.<bR>
$\nabla_\mu F^{\mu I} = 0$<br>
assume timelike hypersurfaces are flat for now:<br>
$\partial_t F^{It} + \nabla_j F^{Ij} = 0$<br>
Let $U^I = F^{It}$<br>
$\partial_t U^I + \nabla_j F^{j I} = 0$<br>
Substitute covariant derivative for connection coefficients...<br>
Now we have to consider the tensoral elements of $U^I$<br>
For a $\pmatrix{p \\ q}$ tensor, we get the following:<br>
$\partial_t {U^{i_1 ... i_p}}_{k_1 ... k_q} + \nabla_j {F^{j i_1 ... i_p}}_{k_1 ... k_q} = 0$<br>
Expand the $\nabla_j$, don't assume a coordinate basis, however if you are using a coordinate basis then $e_j = \partial_j$.<br>
$\partial_t {U^{i_1 ... i_p}}_{k_1 ... k_q} 
	+ e_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	+ {\Gamma^j}_{jl} {F^{l i_1 ... i_p}}_{k_1 ... k_q} 
	+ {\Gamma^{i_m}}_{j l} {F^{j i_1 ... i_{m-1} l i_{m+1} ... i_p}}_{k_1 ... k_q} 
	- {\Gamma^l}_{j k_m} {F^{j i_1  ... i_p}}_{k_1 ... k_{m-1} l k_{m+1}... k_q} 
	= 0$<br>
Swap the ${\Gamma^i}_{jk} = {\Gamma^i}_{kj} + {c_{jk}}^i$.  Notice that I'm not assuming a holonomic connection.<br>
$\partial_t {U^{i_1 ... i_p}}_{k_1 ... k_q} 
	+ e_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	+ ({\Gamma^j}_{lj} + {c_{lj}}^j) {F^{l i_1 ... i_p}}_{k_1 ... k_q} 
	+ {\Gamma^{i_m}}_{j l} {F^{j i_1 ... i_{m-1} l i_{m+1} ... i_p}}_{k_1 ... k_q} 
	- {\Gamma^l}_{j k_m} {F^{j i_1  ... i_p}}_{k_1 ... k_{m-1} l k_{m+1}... k_q} 
	= 0$<br>
Substitute ${\Gamma^j}_{ij} = e_i (ln \sqrt{g})$:<br>
Notice that, if you are using a non-coordinate basis with identity metric then this reduces to zero.<br>
$\partial_t {U^{i_1 ... i_p}}_{k_1 ... k_q} 
	+ \frac{\sqrt{g}}{\sqrt{g}} e_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	+ \frac{1}{\sqrt{g}} e_j (\sqrt{g}) {F^{j i_1 ... i_p}}_{k_1 ... k_q} 
	+ {c_{lj}}^j {F^{l i_1 ... i_p}}_{k_1 ... k_q} 
	+ {\Gamma^{i_m}}_{j l} {F^{j i_1 ... i_{m-1} l i_{m+1} ... i_p}}_{k_1 ... k_q} 
	- {\Gamma^l}_{j k_m} {F^{j i_1  ... i_p}}_{k_1 ... k_{m-1} l k_{m+1}... k_q} 
	= 0$<br>
Move the rest of the terms to the source side:<br>
$\partial_t {U^{i_1 ... i_p}}_{k_1 ... k_q} 
	+ \frac{1}{\sqrt{g}} e_j (\sqrt{g} {F^{j i_1 ... i_p}}_{k_1 ... k_q})
	= 
	- {c_{lj}}^j {F^{l i_1 ... i_p}}_{k_1 ... k_q} 
	- {\Gamma^{i_m}}_{j l} {F^{j i_1 ... i_{m-1} l i_{m+1} ... i_p}}_{k_1 ... k_q} 
	+ {\Gamma^l}_{j k_m} {F^{j i_1  ... i_p}}_{k_1 ... k_{m-1} l k_{m+1}... k_q} 
$<br>
Notice that, in order to take advantage of the volume weighting in a non-coordinate basis, you must apply the non-coordinate basis operator and not merely the partial derivative.<br>
Expanding the $e_j$ operator in terms of its linear combination of coordinate basis, denoted $e_\bar{a}$:<br>
$\partial_t {U^{i_1 ... i_p}}_{k_1 ... k_q} 
	+ \frac{1}{\sqrt{g}} {e_j}^\bar{j} e_\bar{j} (\sqrt{g} {F^{j i_1 ... i_p}}_{k_1 ... k_q})
	= 
	- {c_{lj}}^j {F^{l i_1 ... i_p}}_{k_1 ... k_q} 
	- {\Gamma^{i_m}}_{j l} {F^{j i_1 ... i_{m-1} l i_{m+1} ... i_p}}_{k_1 ... k_q} 
	+ {\Gamma^l}_{j k_m} {F^{j i_1  ... i_p}}_{k_1 ... k_{m-1} l k_{m+1}... k_q} 
$<br>
So implementing this as difference operations, what this means is...<br>
(1) For holonomic only: Weight your flux by the coordinate volume at that interface.  Notice that anholonomic, normalized will have a $g = I$ and therefore involve no weight.<br>
(2) Compute your partial derivatives.<br>
(3) For anholonomic only: transform your derivative by the coordinate-to-non-coordinate linear transformation.<br>
(4) For holonomic only: Divide out the weight of the coordinate volume at the center.<br>
...<br>
<br>

<b>try again, keep things in integral form...</b><br>
Following 2009 Trangenstein "Numeric Simulations of Hyperbolic Conservation Laws", section 7.4:<br>
Notice that his book coincides with anholonomic orthonormal basis.<br>
So that's what I'm using here.  $u_1 ... u_n$ are my coordinate chart parameters.  Indexes are in anholonomic non-coordinates.<br>
$\bar{j} =$ the coordinate basis index, ${e^\bar{j}}_j =$ change of basis from non-coordinate to coordinate (non-Cartesian) basis.<br>
<br>

Mind you, the connections of ${U^I}_J$ will have subsets that are tensors.<br>
Now to formally define them...<br>
Let ${U^I}_J$ be a collection of all tensors, where $I$ span all contravariant indexes and $J$ span all covariant indexes.<br>
Where should the scalars go, in I or J?  It shouldn't matter.<br>
$U^{i_{0,1} ... i_{0,p_0}}$<br>
Next come the vectors and one-forms...<br>
${U^{i_{0,1} ... i_{0,p_0} i_{1,1} ... i_{1,p_1}}}_{j_{1,1} ... j_{1,q_1}}$<br>
Next come the rest of the s-forms...<br>
${U^{i_{0,1} ... i_{0,p_0} i_{1,1} ... i_{1,p_1} ... i_{s,1} ... i_{s,p_s} }}_{j_{1,1} ... j_{1,q_1} ... j_{s,1} ... j_{s,q_s}}$<br>
<br>
But from now on we will only consider $U$ to be a single $\left( \begin{matrix} p \\ q \end{matrix} \right)$-form.  You can repeat for collections of tensors.<br>

$0 = \int_{t_1}^{t_2} 
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}

	\left(
		\frac{\partial}{\partial t}({U^{i_1 ... i_p}}_{k_1 ... k_q})

		+ \frac{1}{V} (
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
		)
	
	\right)

	V

	du_n ... du_1
	dt
$<br>
$0 = \int_{t_1}^{t_2} 
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}

	\left(
		\frac{\partial}{\partial t}({U^{i_1 ... i_p}}_{k_1 ... k_q})

		+ \frac{1}{V} (
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
		)
	
	\right)

	V

	du_n ... du_1
	dt
$<br>
...for $V = det({e_i}^a)$, the determinant of the derivative of the coordinate basis with the Cartesian basis (assuming the non-coordinate basis is normalized).<br>
<br>
assuming the grid is not dependent on time ($\frac{dV}{dt} = 0$)<br>
$0 =
	\int_{t_1}^{t_2} 
	\frac{\partial}{\partial t}
	\left(	
		\int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
			{U^{i_1 ... i_p}}_{k_1 ... k_q}
			V
		\right)
		du_n ... du_1
	\right)
	dt

	+

	\int_{t_1}^{t_2} 
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
	\right)
	du_n ... du_1
	dt
$<br>
$0 =
	\left(	
		\int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
			{U^{i_1 ... i_p}}_{k_1 ... k_q}
			V
		\right)
		du_n ... du_1
	\right)|^{t_2}_{t_1}

	+

	\int_{t_1}^{t_2} 
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
	\right)
	du_n ... du_1
	dt
$<br>
assuming the flux is not dependent on time:<br>
$0 =
	\left(	
		\int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
			{U^{i_1 ... i_p}}_{k_1 ... k_q}
			V
		\right)
		du_n ... du_1
	\right)|^{t_2}_{t_1}

	+

	\int_{t_1}^{t_2} 
	dt
	\cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
	\right)
	du_n ... du_1
$<br>
$0 =
	\left(	
		\int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
			{U^{i_1 ... i_p}}_{k_1 ... k_q}
			V
		\right)
		du_n ... du_1
	\right)|^{t_2}_{t_1}

	+

	(t_2 - t_1) \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
	\right)
	du_n ... du_1
$<br>
assuming the state is not dependent on space -- that it is constant throughout the integral region<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}|^{t_2}_{t_1}
	\cdot
	\left(	
		\int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
			V
		du_n ... du_1
	\right)

	=

	-

	(t_2 - t_1) \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
	\right)
	du_n ... du_1
$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}|^{t_2}_{t_1}

	=

	- \frac{
		(t_2 - t_1)
	}{
		\left(	
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
				V
			du_n ... du_1
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
	\right)
	du_n ... du_1
$<br>

(But why would you integrate the volume over the volume?  Shouldn't you omit the $V$?)<br>
For coordinate basis, ${e_i}^a = \delta_i^a$ and V = 1...<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\left(	
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
			du_n ... du_1
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	\right)
	du_n ... du_1
$<br>
For a Cartesian basis, where $\nabla = \partial$ and $g_{ab} =\delta_{ab}$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\left(	
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
			du_n ... du_1
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\partial_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	\right)
	du_n ... du_1
$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\left(	
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
			du_n ... du_1
		\right)
	} \cdot
	
	\Sigma_{j=1}^n
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{j-1,L}}^{u_{j-1,R}}
	\int_{u_{j+1,L}}^{u_{j+1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\int_{u_{j,L}}^{u_{j,R}}
	\left(
			\partial_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	\right)
	du_j du_n ... du_{j+1} du_{j-1} .. du_1
$<br>
...using the FTC ...<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\Pi_{j=1}^n
		\left(	
			u_{j,R} - u_{j,L}
		\right)
	} \cdot
	
	\Sigma_{j=1}^n
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{j-1,L}}^{u_{j-1,R}}
	\int_{u_{j+1,L}}^{u_{j+1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			{F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,R})
			- {F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,L})
	\right)
	du_n ... du_{j+1} du_{j-1} .. du_1
$<br>
Assuming the flux is not dependent on space:<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\Pi_{j=1}^n
		\left(	
			u_{j,R} - u_{j,L}
		\right)
	} \cdot
	
	\Sigma_{j=1}^n
	\left(
			{F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,R})
			- {F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,L})
	\right)
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{j-1,L}}^{u_{j-1,R}}
	\int_{u_{j+1,L}}^{u_{j+1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	du_n ... du_{j+1} du_{j-1} .. du_1
$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\Pi_{j=1}^n
		\left(	
			u_{j,R} - u_{j,L}
		\right)
	} \cdot
	
	\Sigma_{j=1}^n
	\left(
		\left(
			{F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,R})
			- {F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,L})
		\right)
		\cdot
		\Pi_{k=1,k\ne j}^{k=n}
		\left(
			u_{k,R} - u_{k,L}
		\right)
	\right)
$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- (t_2 - t_1)
	\cdot
	\Sigma_{j=1}^n
	\left(
		\frac{
			1
		}{
			u_{j,R} - u_{j,L}
		} 
		\cdot
		
		\left(
				{F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,R})
				- {F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,L})
		\right)
	\right)
$<br>

<br>
Go back before the assumption of $\nabla = \partial$<br>...
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\left(	
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
			du_n ... du_1
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	\right)
	du_n ... du_1
$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\Pi_{j=1}^n
		\left(
			u_{j,R} - u_{j,L}
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q})
	\right)
	du_n ... du_1
$<br>
...expand covariant derivative into connections...<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\Pi_{j=1}^n
		\left(
			u_{j,R} - u_{j,L}
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\partial_j \left( {F^{j i_1 ... i_p}}_{k_1 ... k_q} \right)
			+ \Sigma_l \left( {F^{j i_1 ... i_{l-1} m i_{l+1} ... i_p}}_{k_1 ... k_q} {\Gamma^{i_l}}_{mj} \right)
			- \Sigma_l \left( {F^{j i_1 ... i_p}}_{k_1 ... k_{l-1} m k_{l+1} ... k_q} {\Gamma^m}_{k_l j} \right)
	\right)
	du_n ... du_1
$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\Pi_{j=1}^n
		\left(
			u_{j,R} - u_{j,L}
		\right)
	} \cdot
	\left(	
		\int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
				\partial_j \left( {F^{j i_1 ... i_p}}_{k_1 ... k_q} \right)
		\right)
		du_n ... du_1
				
		+ \int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
				\Sigma_l \left( {F^{j i_1 ... i_{l-1} m i_{l+1} ... i_p}}_{k_1 ... k_q} {\Gamma^{i_l}}_{mj} \right)
		\right)
		du_n ... du_1
				
		- \int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
				\Sigma_l \left( {F^{j i_1 ... i_p}}_{k_1 ... k_{l-1} m k_{l+1} ... k_q} {\Gamma^m}_{k_l j} \right)
		\right)
		du_n ... du_1
	\right)
$<br>
...using the FTC and assuming flux is not dependent on space...<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\Pi_{j=1}^n
		\left(
			u_{j,R} - u_{j,L}
		\right)
	} \cdot
	\left(	
		\Sigma_{j=1}^n
		\left(
			\left(
				{F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,R})
				- {F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,L})
			\right)
			\cdot
			\Pi_{k=1,k\ne j}^{k=n}
			\left(
				u_{k,R} - u_{k,L}
			\right)
		\right)
		
		+ \int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
				\Sigma_l \left( {F^{j i_1 ... i_{l-1} m i_{l+1} ... i_p}}_{k_1 ... k_q} {\Gamma^{i_l}}_{mj} \right)
		\right)
		du_n ... du_1
				
		- \int_{u_{1,L}}^{u_{1,R}}
		...
		\int_{u_{n,L}}^{u_{n,R}}
		\left(
				\Sigma_l \left( {F^{j i_1 ... i_p}}_{k_1 ... k_{l-1} m k_{l+1} ... k_q} {\Gamma^m}_{k_l j} \right)
		\right)
		du_n ... du_1
	\right)
$<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- (t_2 - t_1)
	\Sigma_{j=1}^n
	\left(	
		\frac{
			1
		}{
			u_{j,R} - u_{j,L}
		} \cdot
	
		\left(
			{F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,R})
			- {F^{j i_1 ... i_p}}_{k_1 ... k_q}(u_j = u_{j,L})
		\right)

		+ 
		\frac{
			1
		}{
			\Pi_{j=1}^n
			\left(
				u_{j,R} - u_{j,L}
			\right)
		} \cdot
		\left(
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
			\left(
					\Sigma_l \left( {F^{j i_1 ... i_{l-1} m i_{l+1} ... i_p}}_{k_1 ... k_q} {\Gamma^{i_l}}_{mj} \right)
			\right)
			du_n ... du_1
					
			- \int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
			\left(
					\Sigma_l \left( {F^{j i_1 ... i_p}}_{k_1 ... k_{l-1} m k_{l+1} ... k_q} {\Gamma^m}_{k_l j} \right)
			\right)
			du_n ... du_1
		\right)
	\right)
$<br>
<br>

Now go back to when we are using a non-coordinate system...<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}|^{t_2}_{t_1}

	=

	- (t_2 - t_1)
	\frac{
		1
	}{
		\left(	
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
				V
			du_n ... du_1
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
			\nabla_j ({F^{j i_1 ... i_p}}_{k_1 ... k_q} V)
	\right)
	du_n ... du_1
$<br>
...expand covariant derivative into connections...<br>
$
	{U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_2)
	- {U^{i_1 ... i_p}}_{k_1 ... k_q}(t=t_1)

	=

	- \frac{
		(t_2 - t_1)
	}{
		\left(	
			\int_{u_{1,L}}^{u_{1,R}}
			...
			\int_{u_{n,L}}^{u_{n,R}}
				V
			du_n ... du_1
		\right)
	} \cdot
	\int_{u_{1,L}}^{u_{1,R}}
	...
	\int_{u_{n,L}}^{u_{n,R}}
	\left(
		{e^\bar{j}}_j \partial_\bar{j} \left( {F^{j i_1 ... i_p}}_{k_1 ... k_q} V \right)
		+ \Sigma_l \left( {F^{j i_1 ... i_{l-1} m i_{l+1} ... i_p}}_{k_1 ... k_q} {\Gamma^{i_l}}_{mj} V \right)
		- \Sigma_l \left( {F^{j i_1 ... i_p}}_{k_1 ... k_{l-1} m k_{l+1} ... k_q} {\Gamma^m}_{k_l j} V \right)
	\right)
	du_n ... du_1
$<br>

<br>
Specific examples:<br>
<br>

<b>Cylindrical holonomic (grid metric)</b><br>
connections of the holonomic basis:<br>
connection coefficients / 2nd kind Christoffel:
	${{{{ \Gamma}^{\phi}}_{\phi}}_r} = {\frac{1}{r}}$
;	${{{{ \Gamma}^{\phi}}_r}_{\phi}} = {\frac{1}{r}}$
;	${{{{ \Gamma}^r}_{\phi}}_{\phi}} = {-{r}}$<br>
<br>

<b>Cylindrical, anholonomic, normalized basis</b><br>
${e_\bar{j}}^j = \left[ \begin{matrix}
	1 & 0 & 0 \\
	0 & r & 0 \\
	0 & 0 & 1
\end{matrix} \right]$<br>
${e^\bar{j}}_j = \left[ \begin{matrix}
	1 & 0 & 0 \\
	0 & \frac{1}{r} & 0 \\
	0 & 0 & 1
\end{matrix} \right]$<br>
$V = det({e_\bar{j}}^j) = r$<br>
connections of the anholonomic normalized basis:<br>
commutation coefficients:
	${{{{ c}_{\hat{\theta}}}_r}^{\hat{\theta}}} = {\frac{1}{r}}$
;	${{{{ c}_r}_{\hat{\theta}}}^{\hat{\theta}}} = {-{\frac{1.0}{r}}}$<br>
connection coefficients / 2nd kind Christoffel:
	${{{{ \Gamma}^{\hat{\theta}}}_{\hat{\theta}}}_r} = {\frac{1}{r}}$
;	${{{{ \Gamma}^r}_{\hat{\theta}}}_{\hat{\theta}}} = {-{\frac{1.0}{r}}}$<br>
<br>
<br>


<b>Spherical, anholonomic, normalized</b><br>
${e_\bar{j}}^j = \left[ \begin{matrix}
	1 & 0 & 0 \\
	0 & r & 0 \\
	0 & 0 & r sin (\theta)
\end{matrix} \right]$<br>
${e^\bar{j}}_j = \left[ \begin{matrix}
	1 & 0 & 0 \\
	0 & \frac{1}{r} & 0 \\
	0 & 0 & \frac{1}{r sin(\theta)}
\end{matrix} \right]$<br>
$V = det({e_\bar{j}}^j) = r^2 sin(\theta)$<br>
connections of the anholonomic normalized basis:<br>
${\Gamma^r}_{\phi \phi} = -\frac{1}{r}$<br>
${\Gamma^r}_{\theta \theta} = -\frac{1}{r}$<br>
${\Gamma^\theta}_{\theta r} = \frac{1}{r}$<br>
${\Gamma^\theta}_{\phi \phi} = -\frac{1}{r} \frac{cos(\theta)}{sin(\theta)}$<br>
${\Gamma^\phi}_{\phi r} = \frac{1}{r}$<br>
${\Gamma^\phi}_{\phi \theta} = \frac{1}{r} \frac{cos(\theta)}{sin(\theta)}$<br>


commutation coefficients:
	${{{{ c}_{\hat{\theta}}}_r}^{\hat{\theta}}} = {\frac{1}{r}}$
;	${{{{ c}_r}_{\hat{\theta}}}^{\hat{\theta}}} = {-{\frac{1}{r}}}$
;	${{{{ c}_{\hat{\phi}}}_r}^{\hat{\phi}}} = {\frac{1}{r}}$
;	${{{{ c}_{\hat{\phi}}}_{\hat{\theta}}}^{\hat{\phi}}} = {\frac{cos\left(  \theta\right)}{{{r}} {{sin\left(  \theta\right)}}}}$
;	${{{{ c}_r}_{\hat{\phi}}}^{\hat{\phi}}} = {-{\frac{1.0}{r}}}$
;	${{{{ c}_{\hat{\theta}}}_{\hat{\phi}}}^{\hat{\phi}}} = {\frac{-{cos\left(  \theta\right)}}{{{r}} {{sin\left(  \theta\right)}}}}$<br>

connection coefficients / 2nd kind Christoffel:
	${{{{ \Gamma}^{\hat{\theta}}}_{\hat{\theta}}}_r} = {\frac{1}{r}}$
;	${{{{ \Gamma}^{\hat{\phi}}}_{\hat{\phi}}}_r} = {\frac{1}{r}}$
;	${{{{ \Gamma}^r}_{\hat{\theta}}}_{\hat{\theta}}} = {-{\frac{1.0}{r}}}$
;	${{{{ \Gamma}^{\hat{\phi}}}_{\hat{\phi}}}_{\hat{\theta}}} = {\frac{cos\left(  \theta\right)}{{{r}} {{sin\left(  \theta\right)}}}}$
;	${{{{ \Gamma}^r}_{\hat{\phi}}}_{\hat{\phi}}} = {-{\frac{1.0}{r}}}$
;	${{{{ \Gamma}^{\hat{\theta}}}_{\hat{\phi}}}_{\hat{\phi}}} = {\frac{-{cos\left(  \theta\right)}}{{{r}} {{sin\left(  \theta\right)}}}}$<br>

<br>

for the scalar case...<br>
$0 = \int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}

	\left(
		\frac{\partial}{\partial t}(U)

		+ 
		\frac{1}{
			r^2 sin(\theta)
		} (
			\nabla_j (
				r^2 sin(\theta)
				F^j
			)
		)
	
	\right)

	r^2 sin(\theta)

	d\phi
	d\theta
	dr
	dt
$<br>
$0 = \int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}

	\left(
		r^2 sin(\theta)
		\frac{\partial}{\partial t}(U)

		+ \nabla_r (
			r^2 sin(\theta)
			F^r
		)
		+ \nabla_\theta (
			r^2 sin(\theta)
			F^\theta
		)
		+ \nabla_\phi (
			r^2 sin(\theta)
			F^\phi
		)
	\right)

	d\phi
	d\theta
	dr
	dt
$<br>
$0 = \int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}

	\left(
		r^2 sin(\theta)
		\frac{\partial}{\partial t}(U)

		+ sin(\theta) \partial_r (
			r^2
			F^r
		)
		
		+ r^2 \partial_\theta (
			sin(\theta)
			F^\theta
		)
		
		+ r^2 sin(\theta) \partial_\phi (
			F^\phi
		)
	\right)

	d\phi
	d\theta
	dr
	dt
$<br>
$0 = \int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}
	\left(
		r^2 sin(\theta)
		\frac{\partial}{\partial t}(U)
	\right)
	d\phi
	d\theta
	dr
	dt

		+ 
	
	\int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}
	\left(
		sin(\theta) \partial_r (
			r^2
			F^r
		)
	\right)
	d\phi
	d\theta
	dr
	dt
		
		+ 
		
	\int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}
	\left(
		r^2 \partial_\theta (
			sin(\theta)
			F^\theta
		)
	\right)
	d\phi
	d\theta
	dr
	dt
		
		+ 
		
	\int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}
	\left(
		r^2 sin(\theta) \partial_\phi (
			F^\phi
		)
	\right)
	d\phi
	d\theta
	dr
	dt
$<br>
$0 = 
	\int_{\phi_L}^{\phi_R} d\phi
	\cdot
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{t_1}^{t_2} 
		\frac{\partial}{\partial t}(U)
	dt
	r^2 sin(\theta)
	d\theta
	dr

		+ 
	
	\int_{t_1}^{t_2} dt
	\cdot
	\int_{\phi_L}^{\phi_R} d\phi
	\cdot
	\int_{\theta_L}^{\theta_R}
	\int_{r_L}^{r_R}
		\partial_r (
			r^2
			F^r
		)
	dr
	sin(\theta) 
	d\theta
		
		+ 
		
	\int_{t_1}^{t_2} dt
	\cdot
	\int_{\phi_L}^{\phi_R} d\phi
	\cdot
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
		\partial_\theta (
			sin(\theta)
			F^\theta
		)
	d\theta
	r^2 
	dr
		
		+ 
		
	\int_{t_1}^{t_2} dt
	\cdot
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}
		\partial_\phi (
			F^\phi
		)
	d\phi
	sin(\theta)
	d\theta
	r^2
	dr
$<br>
$0 = 
	(U|_{t=t_2} - U|_{t=t_1})
	\cdot \frac{1}{3} ( (r_R)^3 - (r_L)^3 )
	\cdot (-cos(\theta_R) + cos(\theta_L))
	\cdot (\phi_R - \phi_L)

		+ 
	
	(t_2 - t_1)
	\cdot ( (r_R)^2 F^r|_{r=r_R} - (r_L)^2 F^r|_{r=r_L} )
	\cdot (-cos(\theta_R) + cos(\theta_L))
	\cdot (\phi_R - \phi_L)
		
		+ 
		
	(t_2 - t_1)
	\cdot \frac{1}{3} ( (r_R)^3 - (r_L)^3 )
	\cdot (
		sin(\theta_R) F^\theta|_{\theta=\theta_R}
		- sin(\theta_L) F^\theta|_{\theta=\theta_L}
	)
	\cdot (\phi_R - \phi_L)
		
		+ 
		
	(t_2 - t_1)
	\cdot \frac{1}{3} ( (r_R)^3 - (r_L)^3 )
	\cdot (-cos(\theta_R) + cos(\theta_L))
	\cdot (
		F^\phi|_{\phi=\phi_R}
		- F^\phi|_{\phi=\phi_L}
	)
$<br>
$U|_{t=t_2} = 
	U|_{t=t_1}

	- 
	
	(t_2 - t_1)
	\left(
		\frac{
			(r_R)^2 F^r|_{r=r_R} - (r_L)^2 F^r|_{r=r_L}
		}{
			\frac{1}{3} ( (r_R)^3 - (r_L)^3 )
		}
		
		+ 
		
		\frac{
			sin(\theta_R) F^\theta|_{\theta=\theta_R}
			- sin(\theta_L) F^\theta|_{\theta=\theta_L}
		}{
			 cos(\theta_L) - cos(\theta_R)
		}
		
		+ 
		
		\frac{
			F^\phi|_{\phi=\phi_R}
			- F^\phi|_{\phi=\phi_L}
		}{
			\phi_R - \phi_L
		}
	\right)
$<br>
<br>

now for the vector case...<br>
$0 = \int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}

	\left(
		r^2 sin(\theta)
		\frac{\partial}{\partial t}(U^i)

		+ \nabla_r (
			r^2 sin(\theta)
			F^{r i}
		)
		+ \nabla_\theta (
			r^2 sin(\theta)
			F^{\theta i}
		)
		+ \nabla_\phi (
			r^2 sin(\theta)
			F^{\phi i}
		)
	\right)

	d\phi
	d\theta
	dr
	dt
$<br>
$0 = \int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}

	\left(
		r^2 sin(\theta) \frac{\partial}{\partial t}(U^i)

		+ \partial_r ( r^2 sin(\theta) F^{r i} )

		+ r^2 sin(\theta) F^{r k} {\Gamma^i}_{r k}	
		
		+ \partial_\theta ( r^2 sin(\theta) F^{\theta i} )
		
		+ r^2 sin(\theta) F^{\theta k} {\Gamma^i}_{\theta k}
		
		+ \partial_\phi ( r^2 sin(\theta) F^{\phi i} )
	
		+ r^2 sin(\theta) F^{\phi k} {\Gamma^i}_{\phi k}

	\right)

	d\phi
	d\theta
	dr
	dt
$<br>
$0 = \int_{t_1}^{t_2} 
	\int_{r_L}^{r_R}
	\int_{\theta_L}^{\theta_R}
	\int_{\phi_L}^{\phi_R}

	\left(
		r^2 sin(\theta) \frac{\partial}{\partial t}(U^i)

		+ \partial_r ( r^2 sin(\theta) F^{r i} )

		+ r^2 sin(\theta) (F^{r r} {\Gamma^i}_{r r} + F^{r \theta} {\Gamma^i}_{r \theta} + F^{r \phi} {\Gamma^i}_{r \phi} )
		
		+ \partial_\theta ( r^2 sin(\theta) F^{\theta i} )
		
		+ r^2 sin(\theta) (F^{\theta r} {\Gamma^i}_{\theta r} + F^{\theta \theta} {\Gamma^i}_{\theta \theta} + F^{\theta \phi} {\Gamma^i}_{\theta \phi})
		
		+ \partial_\phi ( r^2 sin(\theta) F^{\phi i} )
	
		+ r^2 sin(\theta) (F^{\phi r} {\Gamma^i}_{\phi r} + F^{\phi \theta} {\Gamma^i}_{\phi \theta} + F^{\phi \phi} {\Gamma^i}_{\phi \phi})

	\right)

	d\phi
	d\theta
	dr
	dt
$<br>
$\left\{ \begin{matrix}
	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^r)

			+ \partial_r ( r^2 sin(\theta) F^{r r} )

			+ r^2 sin(\theta) (F^{r r} {\Gamma^r}_{r r} + F^{r \theta} {\Gamma^r}_{r \theta} + F^{r \phi} {\Gamma^r}_{r \phi} )
			
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta r} )
			
			+ r^2 sin(\theta) (F^{\theta r} {\Gamma^r}_{\theta r} + F^{\theta \theta} {\Gamma^r}_{\theta \theta} + F^{\theta \phi} {\Gamma^r}_{\theta \phi})
			
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi r} )
		
			+ r^2 sin(\theta) (F^{\phi r} {\Gamma^r}_{\phi r} + F^{\phi \theta} {\Gamma^r}_{\phi \theta} + F^{\phi \phi} {\Gamma^r}_{\phi \phi})

		\right)

		d\phi
		d\theta
		dr
		dt
	\\

	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^\theta)

			+ \partial_r ( r^2 sin(\theta) F^{r \theta} )

			+ r^2 sin(\theta) (F^{r r} {\Gamma^\theta}_{r r} + F^{r \theta} {\Gamma^\theta}_{r \theta} + F^{r \phi} {\Gamma^\theta}_{r \phi} )
			
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta \theta} )
			
			+ r^2 sin(\theta) (F^{\theta r} {\Gamma^\theta}_{\theta r} + F^{\theta \theta} {\Gamma^\theta}_{\theta \theta} + F^{\theta \phi} {\Gamma^\theta}_{\theta \phi})
			
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi \theta} )
		
			+ r^2 sin(\theta) (F^{\phi r} {\Gamma^\theta}_{\phi r} + F^{\phi \theta} {\Gamma^\theta}_{\phi \theta} + F^{\phi \phi} {\Gamma^\theta}_{\phi \phi})

		\right)

		d\phi
		d\theta
		dr
		dt
	\\
	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^\phi)

			+ \partial_r ( r^2 sin(\theta) F^{r \phi} )

			+ r^2 sin(\theta) (F^{r r} {\Gamma^\phi}_{r r} + F^{r \theta} {\Gamma^\phi}_{r \theta} + F^{r \phi} {\Gamma^\phi}_{r \phi} )
			
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta \phi} )
			
			+ r^2 sin(\theta) (F^{\theta r} {\Gamma^\phi}_{\theta r} + F^{\theta \theta} {\Gamma^\phi}_{\theta \theta} + F^{\theta \phi} {\Gamma^\phi}_{\theta \phi})
			
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi \phi} )
		
			+ r^2 sin(\theta) (F^{\phi r} {\Gamma^\phi}_{\phi r} + F^{\phi \theta} {\Gamma^\phi}_{\phi \theta} + F^{\phi \phi} {\Gamma^\phi}_{\phi \phi})

		\right)

		d\phi
		d\theta
		dr
		dt
	\\
\end{matrix} \right\}$<br>
$\left\{ \begin{matrix}
	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^r)
			+ \partial_r ( r^2 sin(\theta) F^{r r} )
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta r} )
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi r} )
			+ r^2 sin(\theta) (-F^{\theta \theta} \frac{1}{r})
			+ r^2 sin(\theta) (-F^{\phi \phi} \frac{1}{r})
		\right)

		d\phi
		d\theta
		dr
		dt
	\\

	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^\theta)
			+ \partial_r ( r^2 sin(\theta) F^{r \theta} )
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta \theta} )
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi \theta} )
			+ r^2 sin(\theta) (F^{\theta r} \frac{1}{r})
			+ r^2 sin(\theta) (-F^{\phi \phi} \frac{cos(\theta)}{r sin(\theta)})
		\right)

		d\phi
		d\theta
		dr
		dt
	\\
	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^\phi)
			+ \partial_r ( r^2 sin(\theta) F^{r \phi} )
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta \phi} )
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi \phi} )
			+ r^2 sin(\theta) (F^{\phi r} \frac{1}{r} + F^{\phi \theta} \frac{cos(\theta)}{r sin(\theta)})
		\right)

		d\phi
		d\theta
		dr
		dt
	\\
\end{matrix} \right\}$<br>
$\left\{ \begin{matrix}
	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^r)
			+ \partial_r ( r^2 sin(\theta) F^{r r} )
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta r} )
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi r} )
			- r sin(\theta) F^{\theta \theta}
			- r sin(\theta) F^{\phi \phi}
		\right)

		d\phi
		d\theta
		dr
		dt
	\\

	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^\theta)
			+ \partial_r ( r^2 sin(\theta) F^{r \theta} )
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta \theta} )
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi \theta} )
			+ r sin(\theta) F^{\theta r}
			- r cos(\theta) F^{\phi \phi}
		\right)

		d\phi
		d\theta
		dr
		dt
	\\
	0 = \int_{t_1}^{t_2} 
		\int_{r_L}^{r_R}
		\int_{\theta_L}^{\theta_R}
		\int_{\phi_L}^{\phi_R}

		\left(
			r^2 sin(\theta) \frac{\partial}{\partial t}(U^\phi)
			+ \partial_r ( r^2 sin(\theta) F^{r \phi} )
			+ \partial_\theta ( r^2 sin(\theta) F^{\theta \phi} )
			+ \partial_\phi ( r^2 sin(\theta) F^{\phi \phi} )
			+ r sin(\theta) F^{\phi r}
			+ r cos(\theta) F^{\phi \theta} 
		\right)

		d\phi
		d\theta
		dr
		dt
	\\
\end{matrix} \right\}$<br>
$\left\{ \begin{matrix}
	0 = 
		(U^r|_{t=t_2} - U^r|_{t=t_1}) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L) 
		+ (t_2 - t_1) \cdot ( (r_R)^2 F^{rr}|_{r=r_R} - (r_L)^2 F^{rr}|_{r=r_L} ) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L)
		+ (t_2 - t_1) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (sin(\theta_R) F^{\theta r}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta r}|_{\theta=\theta_L}) \cdot (\phi_R - \phi_L)
		+ (t_2 - t_1) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (F^{\phi r}|_{\phi=\phi_R} - F^{\phi r}|_{\phi=\phi_L})
		- (t_2 - t_1) \cdot (\frac{1}{2} ( (r_R)^2 - (r_L)^2 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L) \cdot F^{\theta \theta}
		- (t_2 - t_1) \cdot (\frac{1}{2} ( (r_R)^2 - (r_L)^2 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L) \cdot F^{\phi \phi}

	\\

	0 = 
		(U^\theta|_{t=t_2} - U^\theta|_{t=t_1}) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L) 
		+ (t_2 - t_1) \cdot ( (r_R)^2 F^{r \theta}|_{r=r_R} - (r_L)^2 F^{r \theta}|_{r=r_L} ) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L)
		+ (t_2 - t_1) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (sin(\theta_R) F^{\theta \theta}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta \theta}|_{\theta=\theta_L}) \cdot (\phi_R - \phi_L)
		+ (t_2 - t_1) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (F^{\phi \theta}|_{\phi=\phi_R} - F^{\phi \theta}|_{\phi=\phi_L})
		+ (t_2 - t_1) \cdot (\frac{1}{2} ( (r_R)^2 - (r_L)^2 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L) \cdot F^{\theta r}
		- (t_2 - t_1) \cdot (\frac{1}{2} ( (r_R)^2 - (r_L)^2 )) \cdot (sin(\theta_R) - sin(\theta_L)) \cdot (\phi_R - \phi_L) \cdot F^{\phi \phi}
		
	\\
	0 = 
		(U^\phi|_{t=t_2} - U^\phi|_{t=t_1}) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L) 
		+ (t_2 - t_1) \cdot ( (r_R)^2 F^{r \phi}|_{r=r_R} - (r_L)^2 F^{r \phi}|_{r=r_L} ) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L)
		+ (t_2 - t_1) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (sin(\theta_R) F^{\theta \phi}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta \phi}|_{\theta=\theta_L}) \cdot (\phi_R - \phi_L)
		+ (t_2 - t_1) \cdot (\frac{1}{3} ( (r_R)^3 - (r_L)^3 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (F^{\phi \phi}|_{\phi=\phi_R} - F^{\phi \phi}|_{\phi=\phi_L})
		+ (t_2 - t_1) \cdot (\frac{1}{2} ( (r_R)^2 - (r_L)^2 )) \cdot (-cos(\theta_R) + cos(\theta_L)) \cdot (\phi_R - \phi_L) \cdot F^{\phi r}
		+ (t_2 - t_1) \cdot (\frac{1}{2} ( (r_R)^2 - (r_L)^2 )) \cdot (sin(\theta_R) - sin(\theta_L)) \cdot (\phi_R - \phi_L) \cdot F^{\phi \theta}

\end{matrix} \right\}$<br>
$\left\{ \begin{matrix}
		
	U^r|_{t=t_2} 
	= U^r|_{t=t_1}
	- (t_2 - t_1) \cdot 
	\left( 
		\frac{ (r_R)^2 F^{rr}|_{r=r_R} - (r_L)^2 F^{rr}|_{r=r_L} }{ \frac{1}{3} ( (r_R)^3 - (r_L)^3 ) }
		+ \frac{ sin(\theta_R) F^{\theta r}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta r}|_{\theta=\theta_L} }{ -cos(\theta_R) + cos(\theta_L) }
		+ \frac{ F^{\phi r}|_{\phi=\phi_R} - F^{\phi r}|_{\phi=\phi_L} }{ \phi_R - \phi_L }
		- F^{\theta \theta}
		- F^{\phi \phi}
	\right)

	\\

	U^\theta|_{t=t_2} 
	= U^\theta|_{t=t_1}
	- (t_2 - t_1) \cdot 
	\left( 
		\frac{ (r_R)^2 F^{r \theta}|_{r=r_R} - (r_L)^2 F^{r \theta}|_{r=r_L} }{ \frac{1}{3} ( (r_R)^3 - (r_L)^3 ) }
		+ \frac{ sin(\theta_R) F^{\theta \theta}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta \theta}|_{\theta=\theta_L} }{ -cos(\theta_R) + cos(\theta_L) }
		+ \frac{ F^{\phi \theta}|_{\phi=\phi_R} - F^{\phi \theta}|_{\phi=\phi_L} }{ \phi_R - \phi_L }
		+ F^{\theta r}
		- \frac{ sin(\theta_R) - sin(\theta_L) }{ -cos(\theta_R) + cos(\theta_L) } \cdot F^{\phi \phi}
	\right)	
	
	\\
	
	U^\phi|_{t=t_2} 
	= U^\phi|_{t=t_1}
	- (t_2 - t_1) \cdot 
	\left(
		\frac{ (r_R)^2 F^{r \phi}|_{r=r_R} - (r_L)^2 F^{r \phi}|_{r=r_L} }{ \frac{1}{3} ( (r_R)^3 - (r_L)^3 ) }
		+ \frac{ (sin(\theta_R) F^{\theta \phi}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta \phi}|_{\theta=\theta_L}) }{ (-cos(\theta_R) + cos(\theta_L)) }
		+ \frac{ (F^{\phi \phi}|_{\phi=\phi_R} - F^{\phi \phi}|_{\phi=\phi_L}) }{ \phi_R - \phi_L }
		+ F^{\phi r}
		+ \frac{ (sin(\theta_R) - sin(\theta_L)) }{ (-cos(\theta_R) + cos(\theta_L)) } \cdot F^{\phi \theta}
	\right)

\end{matrix} \right\}$<br>

$\left[ \begin{matrix}
	U^r \\
	U^\theta \\
	U^\phi
\end{matrix} \right]_{t=t_2} 
= 
\left[ \begin{matrix}
	U^r \\
	U^\theta \\
	U^\phi
\end{matrix} \right]_{t=t_1} 
- (t_2 - t_1) \cdot 
\left(

	\frac{1}{
		\frac{1}{3} ( (r_R)^3 - (r_L)^3 )
	} \cdot
	\left[ \begin{matrix}
		(r_R)^2 F^{rr}|_{r=r_R} - (r_L)^2 F^{rr}|_{r=r_L}
		\\
		(r_R)^2 F^{r \theta}|_{r=r_R} - (r_L)^2 F^{r \theta}|_{r=r_L}
		\\
		(r_R)^2 F^{r \phi}|_{r=r_R} - (r_L)^2 F^{r \phi}|_{r=r_L}
	\end{matrix} \right]

	+

	\frac{1}{
		-cos(\theta_R) + cos(\theta_L)
	} \cdot
	\left[ \begin{matrix}
		sin(\theta_R) F^{\theta r}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta r}|_{\theta=\theta_L}
		\\	
		sin(\theta_R) F^{\theta \theta}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta \theta}|_{\theta=\theta_L}
		\\	
		sin(\theta_R) F^{\theta \phi}|_{\theta=\theta_R} - sin(\theta_L) F^{\theta \phi}|_{\theta=\theta_L}
	\end{matrix} \right]
	
	+

	\frac{1}{
		\phi_R - \phi_L
	} \cdot
	\left[ \begin{matrix}
		F^{\phi r}|_{\phi=\phi_R} - F^{\phi r}|_{\phi=\phi_L}
		\\
		F^{\phi \theta}|_{\phi=\phi_R} - F^{\phi \theta}|_{\phi=\phi_L}
		\\
		F^{\phi \phi}|_{\phi=\phi_R} - F^{\phi \phi}|_{\phi=\phi_L}
	\end{matrix} \right]
	
	+

	\left[ \begin{matrix}

		- F^{\theta \theta}
		- F^{\phi \phi}

		\\

		F^{\theta r}
		- \frac{ sin(\theta_R) - sin(\theta_L) }{ -cos(\theta_R) + cos(\theta_L) } \cdot F^{\phi \phi}
		
		\\
		
		F^{\phi r}
		+ \frac{ (sin(\theta_R) - sin(\theta_L)) }{ (-cos(\theta_R) + cos(\theta_L)) } \cdot F^{\phi \theta}

	\end{matrix} \right]
\right)
$<br>
<br>

TODO check this out too:<br>
<a href="https://www.groundai.com/project/fifth-order-finite-volume-weno-in-general-orthogonally-curvilinear-coordinates4982/1">https://www.groundai.com/project/fifth-order-finite-volume-weno-in-general-orthogonally-curvilinear-coordinates4982/1</a><br>
<br>

	</body>
</html>
