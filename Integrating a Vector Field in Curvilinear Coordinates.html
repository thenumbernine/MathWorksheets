<!doctype html>
<html>
	<head>
        <meta charset='utf-8'>
		<script type='text/javascript' src='tryToFindMathJax.js'></script>
		<title>Integrating a Vector Field in Curvilinear Coordinates</title>
	</head>
	<body>

<br>

<h3>Correct Finite Volume Integration of a Tensor Field on a Manifold</h3>
<br>

by Christopher Moore<br>
<br>

A lot of my sources are coming from my differential geometry notes at <a href='https://thenumbernine.github.io/'>https://thenumbernine.github.io/</a>, especially the one on 'parallel propagators'<br>
<br>

Integrating a vector field in Cartesian components, vs integrating a vector field wrt a fixed frame:<br>
<br>
TODO move everything else to a 'parallel projector' worksheet, probably in the 'Differential Geometry' folder, and then move this section (and the associated examples) to a 'integrating vector field in curvilinear coordinates' worksheet.<br>
<br>

I hope you can already see that integrating a vector with curvilinear components will not produce the same as integrating a vector field with Cartesian components.
Just do any of many quick examples to prove this.  Integrate the $e_r$ vector through a curve in polar coordinates and compare it with some Cartesian integral results.<br>
<br>

What do we do when we integrate a vector field?  We start with $\int v(x) dV$.  
Then we break it down into Cartesian components $\int e_I(x) v^I(x) dV$.  
Then we tell ourselves that the Cartesian basis is constant throughout the integral - and not dependent on any integrated variables - and therefore we can factor it out: 
$\int e_I(x) v^I(x) dV = \int e_I v^I(x) dV = e_I \int v^I(x) dV$.
And that is your typical vector field integral recipe.<br>
<br>

But what if we're dealing with a non-Cartesian coordinate basis?  We break down our vector field: $\int e_\mu(x) v^\mu(x) dV$.  
But here the typical error performed is that the basis is factored out, as it is done in the Cartesian basis case.  
But the basis is dependent on the coordinate, so you can't do that: $\int e_\mu(x) v^\mu(x) dV \ne e_\mu(x) \int v^\mu(x) dV$.
This statement doesn't even make sense.  
You just factored out one of your integrating variables in the parameter of the basis.  
You can only do this if the basis doesn't depend on the integrating parameter, and while this is true for Cartesian, it isn't for polar or just about any other choice.<br>
<br>

So what's the remedy?
For some reason everyone thinks the remedy is to multiply by the Jacobian.  Go ahead and try to do that and see how far it gets you.  No, what's the real remedy?
Pick a fixed tangent space to evalute the integral in, and transport each vector inside the integral onto that tangent space.  Then the basis isn't dependent on the integral.
(Will the integral result be skewed if the fixed basis is not an orthonormal basis, such as in polar picking a basis where $r \ne 1$?)
<br>

So using our equation above on transporting vector components we get:<br>
<br>

$\int e_\mu(x) v^\mu(x) dV$<br>
$= \int e_\mu(x) {P^{-1}(x,x_0)^\mu}_\alpha {P(x,x_0)^\alpha}_\nu v^\nu(x) dV$<br>
$= \int e_\alpha(x_0) {P(x,x_0)^\alpha}_\mu v^\mu(x) dV$<br>
...and now the basis is independent of the integral, so we can factor it out.<br>
$= e_\alpha(x_0) \int {P(x,x_0)^\alpha}_\mu v^\mu(x) dV$<br>
<br>
Tada! Now we have an equation for our integral whose components are with respect to a fixed tangent space $e_\alpha(x_0)$, and the equation doesn't use any background Cartesian basis components whatsoever.<br>
<br>
So from there if we want we can convert the equation into our Cartesian basis:<br>
$= e_I \cdot {e_\alpha}^I(x_0) \int {P(x,x_0)^\alpha}_\mu v^\mu(x) dV$<br>
Hopefully the example cases below agree with this, especially in the event that our basis isn't normalized, where the integrated fixed-basis vector components might be some factor of the integrated Cartesian-basis vector components.
I guess in that case the ratio would still be constant (since it is dependent on $x_0$, which is independent of the integral), and since integration is linear then we should be fine.<br>
<br>
<br>

<hr>
<br>

Now for a vector field integral in polar coordinates:<br>
First in Cartesian:<br>
$\int v(x) dV$<br>
$= \int e_I v^I(x) dV$<br>
$= \left[\begin{matrix} e_x & e_y \end{matrix}\right] 
	\int \left[\begin{matrix} v^x(x) \\ v^y(x) \end{matrix}\right] dV$<br>
$= \left[\begin{matrix} e_x & e_y \end{matrix}\right] 
	\left[\begin{matrix} \int v^x(x) dV \\ \int v^y(x) dV \end{matrix}\right]$<br>
<br>

Next in a fixed reference basis:<br>
$\int v(x) dV$<br>
$= e_I {e_\alpha}^I(x_0) \int {P^{-1}(x_0, x)^\alpha}_\mu v^\mu(x) dV$<br>
$= \left[\begin{matrix}
	e_x & e_y
\end{matrix}\right]
\left[\begin{matrix}
	cos(\phi_0) & -r_0 sin(\phi_0) \\
	sin(\phi_0) & r_0 cos(\phi_0)
\end{matrix}\right]
\int 
\left[\begin{matrix}
	cos(\phi - \phi_0) & -r sin(\phi - \phi_0) \\
	\frac{1}{r_0} sin(\phi - \phi_0) & \frac{r}{r_0} cos(\phi - \phi_0)
\end{matrix}\right]
\left[\begin{matrix}
	v^r(x) \\
	v^\phi(x)
\end{matrix}\right]
dV$<br>
$= \left[\begin{matrix}
	e_x & e_y
\end{matrix}\right]
\left[\begin{matrix}
	cos(\phi_0) & -r_0 sin(\phi_0) \\
	sin(\phi_0) & r_0 cos(\phi_0)
\end{matrix}\right]
\int 
\left[\begin{matrix}
	v^r(x) cos(\phi - \phi_0) - v^\phi(x) r sin(\phi - \phi_0) \\
	v^r(x) \frac{1}{r_0} sin(\phi - \phi_0) + v^\phi(x) \frac{r}{r_0} cos(\phi - \phi_0)
\end{matrix}\right]
r dr d\phi$<br>
$= \left[\begin{matrix}
	e_r & e_\phi
\end{matrix}\right]|_{(x_0)}
\int 
\left[\begin{matrix}
	v^r(x) cos(\phi - \phi_0)
	- r v^\phi(x) sin(\phi - \phi_0) \\
	
	\frac{1}{r_0} (
		v^r(x) sin(\phi - \phi_0) 
		+ r v^\phi(x) cos(\phi - \phi_0)
	)
\end{matrix}\right]
r dr d\phi$<br>
At this point I'm going to cite once again that $|e_\phi| = r$ and therefore $|v^\phi| \propto r$.  If we convert this to an orthonormal basis: $e_\phi \rightarrow e_{\hat\phi} = \frac{1}{r} e_\phi$, then we can do the same with our components: $v^{\hat\phi} = r v^\phi$.<br>
Now substitute:<br>
$= \left[\begin{matrix}
	e_r & e_\phi
\end{matrix}\right]|_{(x_0)}
\int 
\left[\begin{matrix}
	v^r(x) cos(\phi - \phi_0)
	- v^{\hat\phi}(x) sin(\phi - \phi_0) \\
	
	\frac{1}{r_0} (
		v^r(x) sin(\phi - \phi_0) 
		+ v^{\hat\phi}(x) cos(\phi - \phi_0)
	)
\end{matrix}\right]
r dr d\phi$<br>
Looks good enough, right?<br>
<br>
<br>




	</body>
</html>
